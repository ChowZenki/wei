<!DOCTYPE html>
<html lang="en">
  <head>
    <script type="text/javascript">
      var _speedMark = new Date();
    </script>
    <!-- Meta, title, CSS, favicons, etc. -->
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="">
<meta name="author" content="">

<title>

    Widget Documentation

</title>

<!-- Bootstrap core CSS -->
<link href="./assets/css/bootstrap.css" rel="stylesheet">


<!-- Documentation extras -->
<link href="./assets/css/docs.css" rel="stylesheet">
<link href="./assets/css/pygments-manni.css" rel="stylesheet">

<!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!--[if lt IE 9]>
  <script src="./assets/js/html5shiv.js"></script>
  <script src="./assets/js/respond/respond.min.js"></script>
<![endif]-->

    <!-- Place anything custom after this. -->
  </head>
  <body class="bs-docs-docs" data-spy="scroll" data-target=".bs-docs-sidebar">

    <!-- Docs nav -->
    <div class="bs-docs-sidebar">
  <ul class="nav bs-docs-sidenav">
    <h3 class="bs-docs-sidenav-heading"><a href="/">Widget·微框架</a></h3>

    <li><a href="#welcome">欢迎</a></li>
    <li><a href="#getting-started">入门</a></li>
    <li><a href="#download">下载</a></li>
    <li><a href="#news">随时关注最新消息</a></li>

    <li>
      <a class="nav-header" href="#apis">对象列表</a>
    </li>
    <li>
      <a href="#widget">对象管理器</a>
    </li>
    <li>
      <a href="#cache">缓存</a>
      <ul class="nav">
        <li><a href="#cache">Cache</a></li>
        <li><a href="#apc">Apc</a></li>
        <li><a href="#arrayCache">ArrayCache</a></li>
        <li><a href="#bicache">Bicache</a></li>
        <li><a href="#couchbase">Couchbase</a></li>
        <li><a href="#dbCache">DbCache</a></li>
        <li><a href="#fileCache">FileCache</a></li>
        <li><a href="#memcache">Memcache</a></li>
        <li><a href="#memcached">Memcached</a></li>
        <li><a href="#mongoCache">MongoCache</a></li>
        <li><a href="#redis">Redis</a></li>
      </ul>
    </li>
    <li>
      <a href="#db">数据库</a>
      <ul class="nav">
        <li><a href="#db">db</a></li>
        <li><a href="#queryBuilder">Query Builder</a></li>
        <li><a href="#activeRecord">Active Record</a></li>
      </ul>
    </li>
    <li>
      <a href="#call">接口调用</a>
    </li>
    <li>
      <a href="#validate">验证器</a>
      <ul class="nav">
        <li><a href="#validate">validate</a></li>

        <li><a href="#isAlnum" class="nav-header">数据类型及组成</a><li>
        <li><a href="#isAlnum">isAlnum</a></li>
        <li><a href="#isAlpha">isAlpha</a></li>
        <li><a href="#isBlank">isBlank</a></li>
        <li><a href="#isDecimal">isDecimal</a></li>
        <li><a href="#isDigit">isDigit</a></li>
        <li><a href="#isDivisibleby">isDivisibleBy</a></li>
        <li><a href="#isDoubleByte">isDoubleByte</a></li>
        <li><a href="#isEndsWith">isEndsWith</a></li>
        <li><a href="#isIn">isIn</a></li>
        <li><a href="#isLowercase">isLowercase</a></li>
        <li><a href="#isNull">isNull</a></li>
        <li><a href="#isNumber">isNumber</a></li>
        <li><a href="#isPresent">isPresent</a></li>
        <li><a href="#isRegex">isRegex</a></li>
        <li><a href="#isRequired">isRequired</a></li>
        <li><a href="#isStartsWith">isStartsWith</a></li>
        <li><a href="#isType">isType</a></li>
        <li><a href="#isUppercase">isUppercase</a></li>

        <li><a href="#isLength" class="nav-header">长度</a></li>
        <li><a href="#isLength">isLength</a></li>
        <li><a href="#isCharLength">isCharLength</a></li>
        <li><a href="#isMaxLength">isMaxLength</a></li>
        <li><a href="#isMinLength">isMinLength</a></li>

        <li><a href="#isEqualTo" class="nav-header">大小</a></li>
        <li><a href="#isEqualTo">isEqualTo</a></li>
        <li><a href="#isIdenticalTo">isIdenticalTo</a></li>
        <li><a href="#isGreaterThan">isGreaterThan</a></li>
        <li><a href="#isGreaterThanOrEqual">isGreaterThanOrEqual</a></li>
        <li><a href="#isLessThan">isLessThan</a></li>
        <li><a href="#isLessThanOrEqual ">isLessThanOrEqual </a></li>
        <li><a href="#isBetween">isBetween</a></li>

        <li><a href="#isDate" class="nav-header">日期和时间</a>
        <li><a href="#isDate">isDate</a></li>
        <li><a href="#isDateTime">isDateTime</a></li>
        <li><a href="#isTime">isTime</a></li>

        <li><a href="#isDir" class="nav-header">文件目录</a></li>
        <li><a href="#isDir">isDir</a></li>
        <li><a href="#isExists">isExists</a></li>
        <li><a href="#isFile">isFile</a></li>
        <li><a href="#isImage">isImage</a></li>

        <li><a href="#isEmail" class="nav-header">网络</a></li>
        <li><a href="#isEmail">isEmail</a></li>
        <li><a href="#isIp">isIp</a></li>
        <li><a href="#isTld">isTld</a></li>
        <li><a href="#isUrl">isUrl</a></li>
        <li><a href="#isUuid">isUuid</a></li>

        <li><a href="#isCreditCard" class="nav-header">区域:所有</a></li>
        <li><a href="#isCreditCard">isCreditCard</a></li>

        <li><a href="#isChinese" class="nav-header">区域:中国</a></li>
        <li><a href="#isChinese">isChinese</a></li>
        <li><a href="#isIdCardCn">isIdCardCn</a></li>
        <li><a href="#isIdCardHk">isIdCardHk</a></li>
        <li><a href="#isIdCardMo">isIdCardMo</a></li>
        <li><a href="#isIdCardTw">isIdCardTw</a></li>
        <li><a href="#isPhoneCn">isPhoneCn</a></li>
        <li><a href="#isPostcodeCn">isPostcodeCn</a></li>
        <li><a href="#isQQ">isQQ</a></li>
        <li><a href="#isMobileCn">isMobileCn</a></li>

        <li><a href="#isAllof" class="nav-header">分组</a></li>
        <li><a href="#isAllof">isAllOf</a></li>
        <li><a href="#isNoneof">isNoneOf</a></li>
        <li><a href="#isOneof">isOneOf</a></li>
        <li><a href="#isSomeof">isSomeOf</a></li>

        <li><a href="#isEntityExists" class="nav-header">数据库</a></li>
        <li><a href="#isRecordExists">isRecordExists</a></li>

        <li><a href="#isAll" class="nav-header">其他</a></li>
        <li><a href="#isAll">isAll</a></li>
        <li><a href="#isCallback">isCallback</a></li>
        <li><a href="#isColor">isColor</a></li>
        <li><a href="#isPassword">isPassword</a></li>
      </ul>
    </li>
    <li>
      <a href="#request">HTTP请求</a>
      <ul class="nav">
        <li><a href="#request">Request</a></li>
        <li><a href="#cookie">Cookie</a></li>
        <li><a href="#session">Session</a></li>
        <li><a href="#ua">Ua</a></li>
        <li><a href="#upload">Upload</a></li>
      </ul>
    </li>
    <li>
      <a href="#response">HTTP响应</a>
      <ul class="nav">
        <li><a href="#response">Response</a></li>
        <li><a href="#json">Json</a></li>
        <li><a href="#redirect">Redirect</a></li>
      </ul>
    </li>
    <li>
      <a href="#escape">视图</a>
      <ul class="nav">
        <li><a href="#escape">escape</a></li>
        <li><a href="#view">view</a></li>
      </ul>
    </li>
    <li>
      <a href="#arr">其他</a>
      <ul class="nav">
        <li><a href="#arr">arr</a></li>
        <li><a href="#config">config</a></li>
        <li><a href="#env">env</a></li>
        <li><a href="#error">error</a></li>
        <li><a href="#gravatar">gravatar</a></li>
        <li><a href="#logger">logger</a></li>
        <li><a href="#password">password</a></li>
        <li><a href="#pinyin">pinyin</a></li>
        <li><a href="#uuid">uuid</a></li>
      </ul>
    </li>
    <li>
      <a href="#monolog">第三方</a>
      <ul class="nav">
        <li><a href="#monolog">monolog</a></li>
        <li><a href="#phpError">phpError</a></li>
      </ul>
    </li>
  </ul>
</div>

<!-- Page content of course! -->
    <div class="bs-docs-container">

<!-- Welcome
  ================================================== -->
  <div id="welcome" class="bs-docs-section-header">
    <h1>欢迎</h1>
    <p class="lead">欢迎来到PHP微框架Widget的文档.这里将为您展示丰富全面的代码指导和案例.</p>
  </div>

<!-- Getting started
  ================================================== -->
  <div class="bs-docs-section" id="getting-started">
    <div class="page-header">
      <h1>入门</h1>
    </div>
    <p class="lead">Widget是一个PHP微框架,提供了强大又简洁的接口,让PHP开发更快速,更简单.<p>
    <p>Widget的使用比任何框架都要简单,只需3步,<code>加载</code>=><code>创建</code>=><code>调用</code>!</p>
    <div class="highlight"><pre><code class="php"><span class="c1">// 1. 加载核心类文件</span>
<span class="k">require</span> <span class="s1">'path/to/widget/lib/Widget/Widget.php'</span><span class="p">;</span>

<span class="c1">// 2. 创建对象管理器对象</span>
<span class="nv">$widget</span> <span class="o">=</span> <span class="nx">widget</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
    <span class="c1">// 对象管理器选项</span>
    <span class="s1">'widget'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">'debug'</span> <span class="o">=&gt;</span> <span class="k">true</span><span class="p">,</span>
        <span class="c1">// 其他选项...</span>
    <span class="p">),</span>
    <span class="c1">// 数据库选项</span>
    <span class="s1">'db'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">'driver'</span>    <span class="o">=&gt;</span> <span class="s1">'mysql'</span><span class="p">,</span>
        <span class="s1">'host'</span>      <span class="o">=&gt;</span> <span class="s1">'localhost'</span><span class="p">,</span>
        <span class="s1">'dbname'</span>    <span class="o">=&gt;</span> <span class="s1">'widget'</span><span class="p">,</span>
        <span class="s1">'charset'</span>   <span class="o">=&gt;</span> <span class="s1">'utf8'</span><span class="p">,</span>
        <span class="s1">'user'</span>      <span class="o">=&gt;</span> <span class="s1">'root'</span><span class="p">,</span>
        <span class="s1">'password'</span>  <span class="o">=&gt;</span> <span class="s1">'xxxxxx'</span><span class="p">,</span>
    <span class="p">),</span>
    <span class="c1">// 更多选项...</span>
<span class="p">));</span>

<span class="c1">// 3. 调用"db"对象执行SQL查询</span>
<span class="nv">$result</span> <span class="o">=</span> <span class="nv">$widget</span><span class="o">-&gt;</span><span class="na">db</span><span class="o">-&gt;</span><span class="na">fetch</span><span class="p">(</span><span class="s2">"SELECT 1 + 2"</span><span class="p">);</span>
</code></pre></div>
  </div>

<!-- Download
  ================================================== -->
  <div class="bs-docs-section" id="download">
    <div class="page-header">
      <h1>下载</h1>
    </div>
    <div class="row">
      <div class="col-span-6">
        <h3>1. 通过<a href="http://getcomposer.org/" target="_blank">Composer</a>下载</h3>
        <p><div class="highlight"><pre><code class="json"><span class="p">{</span>
    <span class="nt">"require"</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">"widget/widget"</span><span class="p">:</span> <span class="s2">"0.9.6"</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
      </div>
      <div class="col-span-6">
        <h3>2. 直接下载</h3>
        <p><a class="btn btn-large btn-primary btn-block" href="https://github.com/twinh/widget/archive/v0.9.6.zip">稳定版 v0.9.6</a></p>
        <p><a class="btn btn-large btn-block" href="https://github.com/twinh/widget/archive/master.zip">开发版</a></p>
      </div>
    </div>
  </div>

<!-- News
  ================================================== -->
  <div class="bs-docs-section" id="news">
    <div class="page-header">
      <h1>随时关注最新消息</h1>
    </div>
    <p class="lead">微框架每天都有新的提交,欢迎关注,了解最新趋势!</p>
    <p>
      <iframe src="http://ghbtns.com/github-btn.html?user=twinh&repo=widget&type=watch"
        allowtransparency="true" frameborder="0" scrolling="0" width="53" height="20"></iframe>
      <iframe src="http://ghbtns.com/github-btn.html?user=twinh&type=follow"
        allowtransparency="true" frameborder="0" scrolling="0" width="132" height="20"></iframe>
    </p>
  </div>

  <!-- Widget
  ================================================== -->
  <div id="apis" class="bs-docs-section-header">
    <h1>对象列表</h1>
    <p class="lead">提供了上百个各具特色的对象,包括缓存,数据库操作,验证器,HTTP请求,HTTP响应等</p>
  </div>

<!-- api/widget
  ================================================== -->
  <section id="widget">
  <div class="page-header"><h1>Widget</h1></div>

<p>对象管理器,所有对象的入口.</p>

<p>用于获取对象,设置自动加载,设置别名,设置配置等.</p>

<h2>案例</h2>

<h3>获取对象管理器对象</h3>

<div class="highlight"><pre><code class="php"><span class="cm">/* @var $widget \Widget\Widget */</span>
<span class="nv">$widget</span> <span class="o">=</span> <span class="nx">widget</span><span class="p">();</span>
</code></pre></div>

<h3>设置对象配置</h3>

<p>对象配置可以通过widget函数的第一个参数来设置,</p>

<p>完整配置请查看<a href="https://github.com/twinh/widget/tree/master/docs/zh-CN/api/../book/configuration.md" target="_blank">配置</a>章节.</p>

<div class="highlight"><pre><code class="php"><span class="nv">$widget</span> <span class="o">=</span> <span class="nx">widget</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
    <span class="c1">// 类`Widget\Widget`的属性值</span>
    <span class="s1">'widget'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">'debug'</span> <span class="o">=&gt;</span> <span class="k">true</span><span class="p">,</span>
    <span class="p">),</span>
    <span class="c1">// 类`Widget\Db`的属性值</span>
    <span class="s1">'db'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">'driver'</span>    <span class="o">=&gt;</span> <span class="s1">'mysql'</span><span class="p">,</span>
        <span class="s1">'host'</span>      <span class="o">=&gt;</span> <span class="s1">'localhost'</span><span class="p">,</span>
        <span class="s1">'dbname'</span>    <span class="o">=&gt;</span> <span class="s1">'widget'</span><span class="p">,</span>
        <span class="s1">'charset'</span>   <span class="o">=&gt;</span> <span class="s1">'utf8'</span><span class="p">,</span>
        <span class="s1">'user'</span>      <span class="o">=&gt;</span> <span class="s1">'root'</span><span class="p">,</span>
        <span class="s1">'password'</span>  <span class="o">=&gt;</span> <span class="s1">'123456'</span><span class="p">,</span>
    <span class="p">)</span>
<span class="p">));</span>
</code></pre></div>

<h3>设置类自动加载</h3>

<p>Widget支持<a href="https://github.com/php-fig/fig-standards/blob/master/accepted/PSR-0.md" target="_blank">PRS-0</a>风格的类自动加载器.</p>

<div class="highlight"><pre><code class="php"><span class="nx">widget</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
    <span class="s1">'widget'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="c1">// 启用自动加载</span>
        <span class="s1">'autoload'</span> <span class="o">=&gt;</span> <span class="k">true</span><span class="p">,</span>
        <span class="c1">// 设置自动加载的类的命名空间和类所在的目录</span>
        <span class="s1">'autoloadMap'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
            <span class="s1">'命名空间'</span> <span class="o">=&gt;</span> <span class="s1">'类所在路径'</span><span class="p">,</span>
            <span class="s1">'MyLib'</span> <span class="o">=&gt;</span> <span class="s1">'path/to/lib'</span><span class="p">,</span>
            <span class="s1">'MyProject'</span> <span class="o">=&gt;</span> <span class="s1">'path/to/project'</span><span class="p">,</span>
            <span class="s1">'MyClass\Module'</span> <span class="o">=&gt;</span> <span class="s1">'path/to/class'</span><span class="p">,</span>
            <span class="c1">// 将未在上面指定命名空间的类,都引导到library目录下</span>
            <span class="s1">''</span> <span class="o">=&gt;</span> <span class="s1">'path/to/library'</span>
        <span class="p">)</span>
    <span class="p">)</span>
<span class="p">));</span>

<span class="c1">// 检查类是否正确加载</span>

<span class="c1">// =&gt; 检查文件 path/to/library/MyNamesapce/MyClass.php 是否存在</span>
<span class="nb">var_dump</span><span class="p">(</span><span class="nb">class_exists</span><span class="p">(</span><span class="s1">'MyNamesapce\MyClass'</span><span class="p">));</span>

<span class="c1">// =&gt; 检查文件 path/to/library/MyClass/MyClass.php 是否存在</span>
<span class="nb">var_dump</span><span class="p">(</span><span class="nb">class_exists</span><span class="p">(</span><span class="s1">'MyClass\MyClass'</span><span class="p">));</span>
</code></pre></div>

<h3>开启错误调试</h3>

<p>Widget的错误调试可通过<code>debug</code>选项开启,PHP的调试可通过<code>inis</code>选项配置</p>

<p><strong>注意:</strong> 两者的配置相互独立,不互相影响</p>

<div class="highlight"><pre><code class="php"><span class="nx">widget</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
    <span class="s1">'widget'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="c1">// 通过PHP ini配置,开启PHP错误信息提示</span>
        <span class="s1">'inis'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
            <span class="c1">// 在屏幕上输出错误信息</span>
            <span class="s1">'display_errors'</span> <span class="o">=&gt;</span> <span class="k">true</span><span class="p">,</span>
            <span class="c1">// 设置错误报告的级别</span>
            <span class="s1">'error_reporting'</span> <span class="o">=&gt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="c1">// 开启Widget的调试模式</span>
        <span class="s1">'debug'</span> <span class="o">=&gt;</span> <span class="k">true</span><span class="p">,</span>
    <span class="p">)</span>
<span class="p">));</span>
</code></pre></div>

<h3>设置PHP ini配置</h3>

<p><a href="http://www.php.net/manual/zh/ini.php" target="_blank">PHP的配置</a>可以通过<code>inis</code>选项来设置.</p>

<div class="highlight"><pre><code class="php"><span class="nx">widget</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
    <span class="s1">'widget'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">'inis'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
            <span class="s1">'date.timezone'</span> <span class="o">=&gt;</span> <span class="s1">'Asia/Shanghai'</span><span class="p">,</span> <span class="c1">// 设置时区为上海</span>
            <span class="s1">'memory_limit'</span>  <span class="o">=&gt;</span> <span class="s1">'128M'</span><span class="p">,</span>          <span class="c1">// 设置最大限制为128M</span>
            <span class="s1">'post_max_size'</span> <span class="o">=&gt;</span> <span class="s1">'8M'</span><span class="p">,</span>            <span class="c1">// 设置POST请求的最大数据限制</span>
            <span class="s1">'session.name'</span>  <span class="o">=&gt;</span> <span class="s1">'PHPSESSID'</span><span class="p">,</span>     <span class="c1">// 设置Session的cookie名称</span>
            <span class="s1">'ini配置名称'</span>   <span class="o">=&gt;</span> <span class="s1">'ini配置的值'</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="p">)</span>
<span class="p">));</span>
</code></pre></div>

<h3>通过<code>aliases</code>选项加载自定义对象</h3>

<p>除了系统自带的对象之外,你也可以自定义对象类.</p>

<ol>
<li>
<p>定义您的类,继承于<code>\Widget\Base</code></p>

<div class="highlight"><pre><code class="php"><span class="k">namespace</span> <span class="nx">MyProject</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">Application</span> <span class="k">extends</span> <span class="nx">\Widget\Base</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">run</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="c1">// do something</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</li>
<li>
<p>设置<code>aliases</code>选项,指定您定义的类的对象名称</p>

<div class="highlight"><pre><code class="php"><span class="nx">widget</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
    <span class="s1">'widget'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">'aliases'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
            <span class="s1">'对象名称'</span> <span class="o">=&gt;</span> <span class="s1">'类名称'</span><span class="p">,</span>
            <span class="s1">'app'</span> <span class="o">=&gt;</span> <span class="s1">'MyProject\Application'</span>
        <span class="p">)</span>
    <span class="p">)</span>
<span class="p">));</span>
</code></pre></div>
</li>
<li>
<p>调用您的对象</p>

<div class="highlight"><pre><code class="php"><span class="c1">// 获取自定义对象</span>
<span class="cm">/* @var $app \MyProject\Application */</span>
<span class="nv">$app</span> <span class="o">=</span> <span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">app</span><span class="p">;</span>

<span class="c1">// 和平常一样调用类的方法</span>
<span class="nv">$app</span><span class="o">-&gt;</span><span class="na">run</span><span class="p">();</span>
</code></pre></div>
</li>
</ol><h3>通过<code>import</code>选项导入目录下的自定义对象</h3>

<div class="highlight"><pre><code class="php"><span class="c1">// TODO more detail message</span>
<span class="nx">widget</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
    <span class="s1">'widget'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">'import'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
            <span class="k">array</span><span class="p">(</span>
                <span class="s1">'dir'</span> <span class="o">=&gt;</span> <span class="s1">'要导入的类文件所在的目录'</span><span class="p">,</span>
                <span class="s1">'namespace'</span> <span class="o">=&gt;</span> <span class="s1">'要导入的类文件所在的命名空间'</span><span class="p">,</span>
                <span class="s1">'format'</span> <span class="o">=&gt;</span> <span class="s1">'导入的类名格式'</span>
            <span class="p">),</span>
            <span class="k">array</span><span class="p">(</span>
                <span class="s1">'dir'</span> <span class="o">=&gt;</span> <span class="s1">'path/to/MyProject'</span><span class="p">,</span>
                <span class="s1">'namespace'</span> <span class="o">=&gt;</span> <span class="s1">'MyProject'</span><span class="p">,</span>
                <span class="s1">'format'</span> <span class="o">=&gt;</span> <span class="s1">'my%s'</span>
            <span class="p">)</span>
        <span class="p">),</span>
    <span class="p">)</span>
<span class="p">));</span>
</code></pre></div>

<h3>区分<code>aliases</code>和<code>deps</code>
</h3>

<ol>
<li>
<code>aliases</code>选项数组的key是对象名称,value是类名称</li>
<li>
<code>deps</code>选项数组的key是对象名称,value也是对象名称</li>
</ol><div class="highlight"><pre><code class="php"><span class="nx">widget</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
    <span class="s1">'widget'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">'aliases'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
            <span class="s1">'对象名称'</span> <span class="o">=&gt;</span> <span class="s1">'类名称'</span>
        <span class="p">),</span>
        <span class="s1">'deps'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
            <span class="s1">'对象名称'</span> <span class="o">=&gt;</span> <span class="s1">'对象名称'</span>
        <span class="p">)</span>
    <span class="p">)</span>
<span class="p">));</span>
</code></pre></div>

<h2>调用方式</h2>

<h3>选项</h3>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>debug</td>
<td>bool</td>
<td>true</td>
<td>是否启用调试模式</td>
</tr>
<tr>
<td>inis</td>
<td>array</td>
<td>无</td>
<td>PHP的ini配置选项</td>
</tr>
<tr>
<td>autoload</td>
<td>bool</td>
<td>true</td>
<td>是否启用自动加载</td>
</tr>
<tr>
<td>autoloadMap</td>
<td>array</td>
<td>无</td>
<td>自动加载的命名空间和路径地址</td>
</tr>
<tr>
<td>aliases</td>
<td>array</td>
<td>无</td>
<td>对象别名列表</td>
</tr>
<tr>
<td>import</td>
<td>array</td>
<td>无</td>
<td>导入指定目录下的对象类</td>
</tr>
<tr>
<td>preload</td>
<td>array</td>
<td>array('is')</td>
<td>预加载的对象列表</td>
</tr>
<tr>
<td>beforeConstruct</td>
<td>callbale</td>
<td>无</td>
<td>每个对象初始化前的回调</td>
</tr>
<tr>
<td>afterConstruct</td>
<td>callbale</td>
<td>无</td>
<td>每个对象初始化后的回调</td>
</tr>
</tbody>
</table><h3>回调</h3>

<h4>beforeConstruct($widget, $full, $name)</h4>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>$widget</td>
<td>Widget\Widget</td>
<td>对象管理器</td>
</tr>
<tr>
<td>$full</td>
<td>string</td>
<td>完整的对象名称,包含<code>.</code>连接符,如<code>db</code>,<code>user.db</code>
</td>
</tr>
<tr>
<td>$name</td>
<td>string</td>
<td>对象名称,不包含<code>.</code>连接符,如<code>db</code>,<code>request</code>
</td>
</tr>
</tbody>
</table><h4>afterConstruct($widget, $full, $name, $object)</h4>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>$widget</td>
<td>Widget\Widget</td>
<td>对象管理器</td>
</tr>
<tr>
<td>$full</td>
<td>string</td>
<td>完整的对象名称,包含<code>.</code>连接符,如<code>db</code>,<code>user.db</code>
</td>
</tr>
<tr>
<td>$name</td>
<td>string</td>
<td>对象名称,不包含<code>.</code>连接符,如<code>db</code>,<code>request</code>
</td>
</tr>
<tr>
<td>$object</td>
<td>Widget\Base</td>
<td>当前初始化的对象</td>
</tr>
</tbody>
</table><h3>方法</h3>

<h4>widget($config)</h4>

<p>获取对象管理器,如果不存在,将创建一个新的对象</p>

<p><strong>返回:</strong> <code>Widget\Widget</code> 对象管理器</p>

<p><strong>参数</strong></p>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr></thead>
<tbody><tr>
<td>$config</td>
<td>string,array</td>
<td>对象的配置数组或配置文件</td>
</tr></tbody>
</table><h4>widget()-&gt;isDebug()</h4>

<p>检查是否启用了调试模式</p>

<p><strong>返回:</strong> <code>bool</code></p>

<h4>widget()-&gt;setDebug($debug)</h4>

<p>开启或关闭调试模式</p>

<p><strong>返回:</strong> <code>Widget\Widget</code> 对象管理器</p>

<p><strong>参数</strong></p>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr></thead>
<tbody><tr>
<td>$debug</td>
<td>bool</td>
<td>是否启用调试</td>
</tr></tbody>
</table><h4>widget()-&gt;setConfig($name, $vlaue = array())</h4>

<p>设置对象的配置</p>

<p><strong>返回:</strong> <code>Widget\Widget</code> 对象管理器</p>

<p><strong>参数</strong></p>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>$name</td>
<td>string</td>
<td>无</td>
<td>对象的名称,如<code>request</code>, <code>request.sub</code>
</td>
</tr>
<tr>
<td>$value</td>
<td>array</td>
<td>无</td>
<td>对象的配置选项</td>
</tr>
</tbody>
</table><h4>widget()-&gt;setConfig($array = array())</h4>

<p>设置对象所有配置</p>

<p><strong>返回:</strong> <code>Widget\Widget</code> 对象管理器</p>

<p><strong>参数</strong></p>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody><tr>
<td>$array</td>
<td>array</td>
<td>无</td>
<td>对象的完整配置</td>
</tr></tbody>
</table><h4>widget()-&gt;getConfig($name)</h4>

<p>获取对象的选项配置</p>

<p><strong>返回:</strong> <code>mixed</code> 配置的值,如果配置不存在,返回<code>null</code></p>

<p><strong>参数</strong></p>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody><tr>
<td>$name</td>
<td>string</td>
<td>无</td>
<td>配置的名称</td>
</tr></tbody>
</table><h4>widget()-&gt;get($name, $options = array(), $deps = array())</h4>

<p>获取一个对象</p>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>$name</td>
<td>string</td>
<td>无</td>
<td>对象的名称</td>
</tr>
<tr>
<td>$options</td>
<td>array</td>
<td>无</td>
<td>除了会通过<code>config</code>方法获取配置选项之外的附加的配置选项</td>
</tr>
<tr>
<td>$deps</td>
<td>array</td>
<td>无</td>
<td>指定对象的依赖关系</td>
</tr>
</tbody>
</table><h4>widget()-&gt;import($dir, $namespace, $format = null)</h4>

<p>导入指定目录下的类文件</p>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>$dir</td>
<td>string</td>
<td>无</td>
<td>类文件所在的目录</td>
</tr>
<tr>
<td>$namespace</td>
<td>string</td>
<td>无</td>
<td>类名对应的命名空间</td>
</tr>
<tr>
<td>$format</td>
<td>string</td>
<td>无</td>
<td>类文件的格式</td>
</tr>
</tbody>
</table><h4>widget()-&gt;newInstance($name, $options = array(), $deps = array())</h4>

<p>初始化一个新的对象</p>

<h4>widget()-&gt;set($name, widget())</h4>

<p>设置对象</p>

<h4>widget()-&gt;remove($name)</h4>

<p>移除对象,如果对象存在,返回<code>true</code>,否则返回<code>false</code></p>

<h4>widget()-&gt;getClass($name)</h4>

<p>根据对象名称获取对象类名</p>

<h4>widget()-&gt;has($name)</h4>

<p>检查对象是否存在</p>

<h4>widget()-&gt;setAutoload($bool)</h4>

<p>启用或禁用PSR-0类自动加载</p>
  </section>

<!-- api/cache
  ================================================== -->
  <section id="cache">
  <div class="page-header"><h1>Cache</h1></div>

<p>缓存数据管理,可设定Memcached,Redis,APC,文件等作为缓存驱动</p>

<h2>案例</h2>

<h3>设置和获取缓存</h3>

<div class="highlight"><pre><code class="php"><span class="c1">// 设置缓存,成功返回true,失败返回false</span>
<span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">cache</span><span class="p">(</span><span class="s1">'key'</span><span class="p">,</span> <span class="s1">'value'</span><span class="p">);</span>

<span class="c1">// 获取缓存,返回'value'</span>
<span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">cache</span><span class="p">(</span><span class="s1">'key'</span><span class="p">);</span>
</code></pre></div>

<h3>设置60秒后就过期的缓存</h3>

<div class="highlight"><pre><code class="php"><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">cache</span><span class="p">(</span><span class="s1">'key'</span><span class="p">,</span> <span class="s1">'value'</span><span class="p">,</span> <span class="mi">60</span><span class="p">);</span>
</code></pre></div>

<h3>配置缓存驱动为<code>Redis</code>
</h3>

<div class="highlight"><pre><code class="php"><span class="c1">// 配置缓存驱动为`redis`,同时配置redis的服务器地址</span>
<span class="nx">widget</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
    <span class="s1">'cache'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">'driver'</span> <span class="o">=&gt;</span> <span class="s1">'redis'</span>
    <span class="p">),</span>
    <span class="s1">'redis'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">'host'</span> <span class="o">=&gt;</span> <span class="s1">'127.0.0.1'</span><span class="p">,</span>
    <span class="p">)</span>
<span class="p">));</span>

<span class="c1">// 获取缓存对象</span>
<span class="nv">$cache</span> <span class="o">=</span> <span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">cache</span><span class="p">;</span>

<span class="c1">// 输出缓存驱动, 输出为`redis`</span>
<span class="k">echo</span> <span class="nv">$cache</span><span class="o">-&gt;</span><span class="na">getDriver</span><span class="p">();</span>
</code></pre></div>

<h3>缓存数据库查询,如缓存用户总数,每30秒更新一次</h3>

<div class="highlight"><pre><code class="php"><span class="nv">$totalUsers</span> <span class="o">=</span> <span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">cache</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">'totalUsers'</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="k">function</span><span class="p">(</span><span class="nv">$widget</span><span class="p">){</span>
    <span class="k">return</span> <span class="nv">$widget</span><span class="o">-&gt;</span><span class="na">db</span><span class="o">-&gt;</span><span class="na">fetchColumn</span><span class="p">(</span><span class="s2">"SELECT COUNT(1) FROM user"</span><span class="p">);</span>
<span class="p">});</span>
</code></pre></div>

<h3>将缓存作为计数器,记录文章访问次数</h3>

<div class="highlight"><pre><code class="php"><span class="nv">$cache</span> <span class="o">=</span> <span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">cache</span><span class="p">;</span>

<span class="c1">// 设置文章访问次数增加1,返回增加后的总次数</span>
<span class="c1">// 注意: 开发人员无需预先判断该键名的缓存是否存在,如果缓存不存在,将自动从0开始计算</span>
<span class="nv">$hits</span> <span class="o">=</span> <span class="nv">$cache</span><span class="o">-&gt;</span><span class="na">incr</span><span class="p">(</span><span class="s1">'article-1'</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>

<span class="k">echo</span> <span class="s1">'该文章已被访问'</span> <span class="o">.</span> <span class="nv">$hits</span> <span class="o">.</span> <span class="s1">'次'</span><span class="p">;</span>
</code></pre></div>

<h3>使用缓存前缀来避免缓存名称冲突</h3>

<p>有些时候,我们会在多个应用中,共享同一个memcched服务,共享同一个APC,这时可以通过设置缓存名称前缀,避免数据冲突</p>

<div class="highlight"><pre><code class="php"><span class="c1">// 设置APC缓存的键名前缀</span>
<span class="nx">widget</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
    <span class="s1">'memcached'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">'keyPrefix'</span> <span class="o">=&gt;</span> <span class="s1">'project-'</span>
    <span class="p">)</span>
<span class="p">));</span>

<span class="c1">// 缓存键名将自动转换为'project-key'</span>
<span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">memcached</span><span class="o">-&gt;</span><span class="na">set</span><span class="p">(</span><span class="s1">'key'</span><span class="p">,</span> <span class="s1">'value'</span><span class="p">);</span>
</code></pre></div>

<h3>批量设置和获取缓存</h3>

<p><strong>注意:</strong> 目前只有<code>redis</code>和<code>couchbase</code>支持原生的批量设置,其他的缓存实际都是通过<code>foreach</code>语句逐个设置.</p>

<div class="highlight"><pre><code class="php"><span class="nv">$cache</span> <span class="o">=</span> <span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">cache</span><span class="p">;</span>

<span class="c1">// 批量设置缓存</span>
<span class="nv">$result</span> <span class="o">=</span> <span class="nv">$cache</span><span class="o">-&gt;</span><span class="na">setMulti</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
    <span class="s1">'array'</span>     <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(),</span>
    <span class="s1">'bool'</span>      <span class="o">=&gt;</span> <span class="k">true</span><span class="p">,</span>
    <span class="s1">'float'</span>     <span class="o">=&gt;</span> <span class="mf">1.2</span><span class="p">,</span>
    <span class="s1">'int'</span>       <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s1">'null'</span>      <span class="o">=&gt;</span> <span class="k">null</span><span class="p">,</span>
    <span class="s1">'object'</span>    <span class="o">=&gt;</span> <span class="k">new</span> <span class="nx">\stdClass</span><span class="p">()</span>
<span class="p">));</span>

<span class="c1">// 返回结果</span>
<span class="nv">$result</span> <span class="o">=</span> <span class="k">array</span> <span class="p">(</span>
    <span class="s1">'array'</span> <span class="o">=&gt;</span> <span class="k">true</span><span class="p">,</span>
    <span class="s1">'bool'</span> <span class="o">=&gt;</span> <span class="k">true</span><span class="p">,</span>
    <span class="s1">'float'</span> <span class="o">=&gt;</span> <span class="k">true</span><span class="p">,</span>
    <span class="s1">'int'</span> <span class="o">=&gt;</span> <span class="k">true</span><span class="p">,</span>
    <span class="s1">'null'</span> <span class="o">=&gt;</span> <span class="k">true</span><span class="p">,</span>
    <span class="s1">'object'</span> <span class="o">=&gt;</span> <span class="k">true</span><span class="p">,</span>
<span class="p">);</span>

<span class="c1">// 批量获取缓存</span>
<span class="nv">$result</span> <span class="o">=</span> <span class="nv">$cache</span><span class="o">-&gt;</span><span class="na">getMulti</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
    <span class="s1">'array'</span><span class="p">,</span>
    <span class="s1">'bool'</span><span class="p">,</span>
    <span class="s1">'float'</span><span class="p">,</span>
    <span class="s1">'int'</span><span class="p">,</span>
    <span class="s1">'null'</span><span class="p">,</span>
    <span class="s1">'object'</span>
<span class="p">));</span>

<span class="c1">// 返回结果</span>
<span class="nv">$result</span> <span class="o">=</span> <span class="k">array</span> <span class="p">(</span>
    <span class="s1">'array'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(),</span>
    <span class="s1">'bool'</span> <span class="o">=&gt;</span> <span class="k">true</span><span class="p">,</span>
    <span class="s1">'float'</span> <span class="o">=&gt;</span> <span class="mf">1.2</span><span class="p">,</span>
    <span class="s1">'int'</span> <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s1">'null'</span> <span class="o">=&gt;</span> <span class="k">NULL</span><span class="p">,</span>
    <span class="s1">'object'</span> <span class="o">=&gt;</span> <span class="k">stdClass</span><span class="o">::</span><span class="na">__set_state</span><span class="p">(</span><span class="k">array</span><span class="p">()),</span>
<span class="p">);</span>
</code></pre></div>

<h2>调用方式</h2>

<h3>通用选项</h3>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody><tr>
<td>keyPrefix</td>
<td>string</td>
<td>无</td>
<td>缓存名称的前缀</td>
</tr></tbody>
</table><h3>选项</h3>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody><tr>
<td>driver</td>
<td>string</td>
<td>apc</td>
<td>缓存的类型</td>
</tr></tbody>
</table><h4>支持的缓存类型</h4>

<ul>
<li>
<a href="#apc">apc</a> - APC缓存 <em>(推荐)</em>
</li>
<li>
<a href="#arrayCache">arrayCache</a> - PHP数组缓存</li>
<li>
<a href="#couchbase">couchbase</a> - Couchbase缓存</li>
<li>
<a href="#dbCache">dbCache</a> - 数据库缓存</li>
<li>
<a href="#fileCache">fileCache</a> - 文件缓存</li>
<li>
<a href="#memcache">memcache</a> - Memcachce缓存</li>
<li>
<a href="#memcached">memcached</a> - Memcached缓存 <em>(推荐)</em>
</li>
<li>
<a href="#mongoCache">mongoCache</a> - MongoDB缓存</li>
<li>
<a href="#redis">redis</a> - Redis缓存 <em>(推荐)</em>
</li>
<li>
<a href="#bicache">bicache</a> - 二级缓存</li>
</ul><h4>特性对比</h4>

<table class="table table-bordered table-striped">
<thead><tr>
<th>特性</th>
<th>Apc</th>
<th>ArrayCache</th>
<th>DbCache</th>
<th>FileCache</th>
<th>Memecache</th>
<th>Memcached</th>
<th>MongoCache</th>
<th>Couchbase</th>
<th>Redis</th>
</tr></thead>
<tbody>
<tr>
<td>速度</td>
<td>快</td>
<td>快</td>
<td>慢</td>
<td>慢</td>
<td>快</td>
<td>快</td>
<td>快</td>
<td>快</td>
<td>快</td>
</tr>
<tr>
<td>持久化</td>
<td>×</td>
<td>-</td>
<td>√</td>
<td>√</td>
<td>×</td>
<td>×</td>
<td>√</td>
<td>√</td>
<td>√</td>
</tr>
<tr>
<td>分布式</td>
<td>×</td>
<td>×</td>
<td>√</td>
<td>×</td>
<td>√</td>
<td>√</td>
<td>√</td>
<td>√</td>
<td>√</td>
</tr>
<tr>
<td>原子性</td>
<td>√</td>
<td>√</td>
<td>×</td>
<td>√</td>
<td>√</td>
<td>√</td>
<td>×</td>
<td>√</td>
<td>√</td>
</tr>
</tbody>
</table><ul>
<li>
<code>√</code> 表示支持</li>
<li>
<code>×</code> 表示不支持</li>
<li>
<code>-</code>  表示不具备该特性</li>
</ul><p>说明:</p>

<ul>
<li>速度:判断依据是缓存数据存储的介质,如果数据存储在内存中则<code>快</code>,如果存储在磁盘则<code>慢</code>
</li>
<li>持久化:判断依据是缓存是否因为相关服务重启而丢失数据</li>
<li>原子性:判断依据是<code>add</code>,<code>replace</code>,<code>incr</code>和<code>decr</code>方法是否为原子操作</li>
<li>
<code>Cache</code>和<code>Bicache</code>为视配置而定,不列入比较</li>
<li>
<code>ArrayCache</code>使用PHP数组存储数据,每次请求结束后销毁,因此不具备持久化特性</li>
</ul><h3>通用方法</h3>

<p>在下面的方法中,<code>cache</code>表示缓存类的名称,可以替换为其他任意缓存,如<code>redis</code>, <code>memcached</code>等</p>

<h4>cache($key, $value, $expire = 0)</h4>

<p>设置缓存的值</p>

<p>返回: <code>bool</code> 是否设置成功</p>

<p>参数</p>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>$key</td>
<td>string</td>
<td>无</td>
<td>缓存的键名</td>
</tr>
<tr>
<td>$value</td>
<td>mixed</td>
<td>无</td>
<td>缓存的值,允许任意变量类型</td>
</tr>
<tr>
<td>$expire</td>
<td>int</td>
<td>0</td>
<td>缓存的有效期,默认为0秒,表示永不过期</td>
</tr>
</tbody>
</table><h4>cache($key)</h4>

<p>获取指定名称的缓存</p>

<p>返回: <code>mixed</code></p>

<p>参数</p>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody><tr>
<td>$key</td>
<td>string</td>
<td>无</td>
<td>缓存的键名</td>
</tr></tbody>
</table><h4>cache-&gt;set($key, $value, $expire = 0)</h4>

<p>设置缓存的值,同<code>cache($key, $value, $expire = 0)</code></p>

<h4>cache-&gt;get($key)</h4>

<p>获取缓存的值,同<code>cache($key)</code></p>

<h4>cache-&gt;remove($key)</h4>

<p>移除一项缓存</p>

<p>返回: <code>bool</code> 是否移除成功</p>

<p>参数</p>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody><tr>
<td>$key</td>
<td>string</td>
<td>无</td>
<td>缓存的键名</td>
</tr></tbody>
</table><h4>cache-&gt;exists($key)</h4>

<p>检查缓存是否存在</p>

<p>返回: <code>bool</code></p>

<p>参数</p>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody><tr>
<td>$key</td>
<td>string</td>
<td>无</td>
<td>缓存的键名</td>
</tr></tbody>
</table><h4>cache-&gt;add($key, $value, $expire = 0)</h4>

<p>增加一项缓存,如果缓存已存在,返回false</p>

<p>返回: <code>bool</code></p>

<p>参数</p>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>$key</td>
<td>string</td>
<td>无</td>
<td>缓存的键名</td>
</tr>
<tr>
<td>$value</td>
<td>mixed</td>
<td>无</td>
<td>缓存的值,允许任意变量类型</td>
</tr>
<tr>
<td>$expire</td>
<td>int</td>
<td>0</td>
<td>缓存的有效期,默认为0秒,表示永不过期</td>
</tr>
</tbody>
</table><h4>cache-&gt;replace($key, $value)</h4>

<p>替换一项缓存,如果缓存不存在,返回false</p>

<p>返回: <code>bool</code></p>

<p>参数</p>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>$key</td>
<td>string</td>
<td>无</td>
<td>缓存的键名</td>
</tr>
<tr>
<td>$value</td>
<td>mixed</td>
<td>无</td>
<td>缓存的值,允许任意变量类型</td>
</tr>
</tbody>
</table><h4>cache-&gt;incr($key, $offset = 1)</h4>

<p>增大一项缓存的值</p>

<p>返回: <code>int</code> 增大后缓存的值</p>

<p>参数</p>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>$key</td>
<td>string</td>
<td>无</td>
<td>缓存的键名</td>
</tr>
<tr>
<td>$offset</td>
<td>int</td>
<td>1</td>
<td>增大的值</td>
</tr>
</tbody>
</table><h4>cache-&gt;decr($key, $offset = 1)</h4>

<p>减小一项缓存的值</p>

<p>返回: <code>int</code> 减小后缓存的值</p>

<p>参数</p>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>$key</td>
<td>string</td>
<td>无</td>
<td>缓存的键名</td>
</tr>
<tr>
<td>$offset</td>
<td>int</td>
<td>1</td>
<td>减小的值</td>
</tr>
</tbody>
</table><h4>cache-&gt;getMulti($keys)</h4>

<p>批量获取缓存的值</p>

<p>返回: <code>array</code>  数组的键名是缓存的名称,值是缓存的值,如果某项缓存不存在,它的值为<code>false</code></p>

<p>参数</p>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody><tr>
<td>$keys</td>
<td>array</td>
<td>无</td>
<td>缓存的键名数组</td>
</tr></tbody>
</table><h4>cache-&gt;setMulti($values)</h4>

<p>批量设置缓存的值</p>

<p>返回: <code>array</code>  数组的键名是缓存的名称,值操作结果,即<code>true</code>和<code>false</code></p>

<p>参数</p>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody><tr>
<td>$values</td>
<td>array</td>
<td>无</td>
<td>要缓存的数据</td>
</tr></tbody>
</table>
  </section>

<!-- api/apc
  ================================================== -->
  <section id="apc">
  <div class="page-header"><h1>Apc</h1></div>

<p>通过面向对象的方式设置或获取PHP APC缓存,并提供更多友好方便的功能方法.</p>

<h2>案例</h2>

<h3>设置和获取缓存</h3>

<div class="highlight"><pre><code class="php"><span class="c1">// 设置缓存,返回true</span>
<span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">apc</span><span class="p">(</span><span class="s1">'key'</span><span class="p">,</span> <span class="s1">'value'</span><span class="p">);</span>

<span class="c1">// 获取缓存,返回'value'</span>
<span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">apc</span><span class="p">(</span><span class="s1">'key'</span><span class="p">);</span>
</code></pre></div>

<h3>设置60秒后就过期的缓存</h3>

<div class="highlight"><pre><code class="php"><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">apc</span><span class="p">(</span><span class="s1">'key'</span><span class="p">,</span> <span class="s1">'value'</span><span class="p">,</span> <span class="mi">60</span><span class="p">);</span>
</code></pre></div>

<p>更多案例请查看<a href="#cache">Cache</a>类</p>

<h2>调用方式</h2>

<h3>选项</h3>

<p><em>无</em></p>

<h3>继承的方法</h3>

<p>通用方法请查看<a href="#cache">Cache</a>类</p>

<h3>方法</h3>

<p><em>无</em></p>
  </section>

<!-- api/arrayCache
  ================================================== -->
  <section id="arrayCache">
  <div class="page-header"><h1>ArrayCache</h1></div>

<p>数组缓存,将数据存储在PHP数组中,每次 <strong>请求结束</strong> 数据就会被 <strong>清空</strong>.</p>

<p>使用数组缓存主要有两个场景:</p>

<ol>
<li>在开发环境使用,确保每次页面请求都会获得最新生成的数据</li>
<li>对计算结果进行临时存储,以便在不同地方获取数据,减少重复计算消耗的时间</li>
</ol><h2>案例</h2>

<h3>设置和获取缓存</h3>

<div class="highlight"><pre><code class="php"><span class="c1">// 设置缓存,返回true</span>
<span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">arrayCache</span><span class="p">(</span><span class="s1">'key'</span><span class="p">,</span> <span class="s1">'value'</span><span class="p">);</span>

<span class="c1">// 获取缓存,返回'value'</span>
<span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">arrayCache</span><span class="p">(</span><span class="s1">'key'</span><span class="p">);</span>
</code></pre></div>

<p>更多案例请查看<a href="#cache">Cache</a>类</p>

<h2>调用方式</h2>

<h3>选项</h3>

<p><em>无</em></p>

<h3>继承的方法</h3>

<p>通用方法请查看<a href="#cache">Cache</a>类</p>

<h3>方法</h3>

<p><em>无</em></p>
  </section>

<!-- api/bicache
  ================================================== -->
  <section id="bicache">
  <div class="page-header"><h1>Bicache</h1></div>

<p>设置或获取缓存,数据存储在二级缓存中</p>

<p>二级缓存使用主从同步机制,由一个主缓存(master)和一个从缓存(slave)组成,二级缓存的原理非常简单,有以下两点.</p>

<ol>
<li>每次读取数据时,如果主缓存读取不到数据,将从从缓存读取数据</li>
<li>每次写入数据时,如果检查上次更新到从缓存的间隔秒数大于配置秒数,则同步数据到从缓存中</li>
</ol><h2>案例</h2>

<h3>设置和获取缓存</h3>

<div class="highlight"><pre><code class="php"><span class="c1">// 设置缓存,返回true</span>
<span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">bicache</span><span class="p">(</span><span class="s1">'key'</span><span class="p">,</span> <span class="s1">'value'</span><span class="p">);</span>

<span class="c1">// 获取缓存,返回'value'</span>
<span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">bicache</span><span class="p">(</span><span class="s1">'key'</span><span class="p">);</span>
</code></pre></div>

<h3>设置60秒后就过期的缓存</h3>

<div class="highlight"><pre><code class="php"><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">bicache</span><span class="p">(</span><span class="s1">'key'</span><span class="p">,</span> <span class="s1">'value'</span><span class="p">,</span> <span class="mi">60</span><span class="p">);</span>
</code></pre></div>

<p>更多案例请查看<a href="#cache">Cache</a>类</p>

<h2>调用方式</h2>

<h3>选项</h3>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>time</td>
<td>int</td>
<td>5</td>
<td>当主缓存写数据时,会检查上次更新到slave缓存的间隔秒数,如果超过该秒数,就同步到从缓存中</td>
</tr>
<tr>
<td>deps</td>
<td>array</td>
<td></td>
<td>主从缓存类型的配置</td>
</tr>
<tr>
<td>- master</td>
<td>string</td>
<td>apc</td>
<td>主缓存的类型,推荐使用内存类缓存,如apc,redis,memcache,memcached或couchbase</td>
</tr>
<tr>
<td>- slave</td>
<td>string</td>
<td>fileCache</td>
<td>从缓存的类型,推荐使用文件类缓存,如fileCache或dbCache</td>
</tr>
</tbody>
</table><h3>继承的方法</h3>

<p>通用方法请查看<a href="#cache">Cache</a>类</p>

<h3>方法</h3>

<p><em>无</em></p>
  </section>

<!-- api/couchbase
  ================================================== -->
  <section id="couchbase">
  <div class="page-header"><h1>Couchbase</h1></div>

<p>设置或获取一项缓存,缓存数据存储于Couchbase中</p>

<h2>案例</h2>

<h3>设置和获取缓存</h3>

<div class="highlight"><pre><code class="php"><span class="c1">// 设置缓存,返回true</span>
<span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">couchbase</span><span class="p">(</span><span class="s1">'key'</span><span class="p">,</span> <span class="s1">'value'</span><span class="p">);</span>

<span class="c1">// 获取缓存,返回'value'</span>
<span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">couchbase</span><span class="p">(</span><span class="s1">'key'</span><span class="p">);</span>
</code></pre></div>

<h3>设置60秒后就过期的缓存</h3>

<div class="highlight"><pre><code class="php"><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">couchbase</span><span class="p">(</span><span class="s1">'key'</span><span class="p">,</span> <span class="s1">'value'</span><span class="p">,</span> <span class="mi">60</span><span class="p">);</span>
</code></pre></div>

<p>更多案例请查看<a href="#cache">Cache</a>对象</p>

<h2>调用方式</h2>

<h3>选项</h3>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>host</td>
<td>array</td>
<td>string</td>
<td>127.0.0.1:8091</td>
</tr>
<tr>
<td>user</td>
<td>string</td>
<td>无</td>
<td>用于服务器验证的用户名</td>
</tr>
<tr>
<td>password</td>
<td>string</td>
<td>无</td>
<td>用于服务器验证的密码</td>
</tr>
<tr>
<td>bucket</td>
<td>string</td>
<td>default</td>
<td>连接的桶的名称</td>
</tr>
<tr>
<td>persistent</td>
<td>bool</td>
<td>true</td>
<td>是否使用长连接</td>
</tr>
</tbody>
</table><h3>继承的方法</h3>

<p>通用方法请查看<a href="#cache">Cache</a>对象</p>

<h3>方法</h3>

<h4>couchbase-&gt;getObject()</h4>

<p>获取原生Couchbase对象</p>

<h4>couchbase-&gt;setObject($couchbase)</h4>

<p>设置原生Couchbase对象</p>
  </section>

<!-- api/dbCache
  ================================================== -->
  <section id="dbCache">
  <div class="page-header"><h1>DbCache</h1></div>

<p>设置或获取一项缓存,缓存数据存储于数据库中</p>

<p>dbCache对象依赖于<a href="#db">db</a>对象</p>

<h2>案例</h2>

<h3>设置和获取缓存</h3>

<div class="highlight"><pre><code class="php"><span class="c1">// 设置缓存,返回true</span>
<span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">dbCache</span><span class="p">(</span><span class="s1">'key'</span><span class="p">,</span> <span class="s1">'value'</span><span class="p">);</span>

<span class="c1">// 获取缓存,返回'value'</span>
<span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">dbCache</span><span class="p">(</span><span class="s1">'key'</span><span class="p">);</span>
</code></pre></div>

<h3>设置60秒后就过期的缓存</h3>

<div class="highlight"><pre><code class="php"><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">dbCache</span><span class="p">(</span><span class="s1">'key'</span><span class="p">,</span> <span class="s1">'value'</span><span class="p">,</span> <span class="mi">60</span><span class="p">);</span>
</code></pre></div>

<p>更多案例请查看<a href="#cache">Cache</a>对象</p>

<h2>调用方式</h2>

<h3>选项</h3>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody><tr>
<td>table</td>
<td>string</td>
<td>cache</td>
<td>缓存数据表名称</td>
</tr></tbody>
</table><h3>继承的方法</h3>

<p>通用方法请查看<a href="#cache">Cache</a>对象</p>

<h3>方法</h3>

<p><em>无</em></p>
  </section>

<!-- api/fileCache
  ================================================== -->
  <section id="fileCache">
  <div class="page-header"><h1>FileCache</h1></div>

<p>设置或获取文件缓存</p>

<h2>案例</h2>

<h3>设置和获取文件缓存</h3>

<div class="highlight"><pre><code class="php"><span class="c1">// 设置缓存,返回true</span>
<span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">fileCache</span><span class="p">(</span><span class="s1">'key'</span><span class="p">,</span> <span class="s1">'value'</span><span class="p">);</span>

<span class="c1">// 获取缓存,返回'value'</span>
<span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">fileCache</span><span class="p">(</span><span class="s1">'key'</span><span class="p">);</span>
</code></pre></div>

<p>更多案例请查看<a href="#cache">Cache</a>对象</p>

<h2>调用方式</h2>

<h3>选项</h3>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody><tr>
<td>dir</td>
<td>string</td>
<td>cache</td>
<td>缓存文件存储的目录</td>
</tr></tbody>
</table><h3>继承的方法</h3>

<p>通用方法请查看<a href="#cache">Cache</a>对象</p>

<h3>方法</h3>

<h4>fileCache-&gt;getDir()</h4>

<p>获取文件缓存的目录</p>

<h4>fileCache-&gt;setDir($dir)</h4>

<p>设置文件缓存目录</p>

<h4>fileCache-&gt;getFile($key)</h4>

<p>根据缓存名称获取缓存文件路径</p>
  </section>

<!-- api/memcache
  ================================================== -->
  <section id="memcache">
  <div class="page-header"><h1>Memcache</h1></div>

<p>设置或获取一项缓存,缓存数据存储于Memcache中</p>

<h2>案例</h2>

<h3>设置和获取缓存</h3>

<div class="highlight"><pre><code class="php"><span class="c1">// 设置缓存,返回true</span>
<span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">memcache</span><span class="p">(</span><span class="s1">'key'</span><span class="p">,</span> <span class="s1">'value'</span><span class="p">);</span>

<span class="c1">// 获取缓存,返回'value'</span>
<span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">memcache</span><span class="p">(</span><span class="s1">'key'</span><span class="p">);</span>
</code></pre></div>

<h3>设置60秒后就过期的缓存</h3>

<div class="highlight"><pre><code class="php"><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">memcache</span><span class="p">(</span><span class="s1">'key'</span><span class="p">,</span> <span class="s1">'value'</span><span class="p">,</span> <span class="mi">60</span><span class="p">);</span>
</code></pre></div>

<p>更多案例请查看<a href="#cache">Cache</a>对象</p>

<h2>调用方式</h2>

<h3>选项</h3>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>servers</td>
<td>array</td>
<td>见下表</td>
<td>服务器配置数组</td>
</tr>
<tr>
<td>flag</td>
<td>int</td>
<td><code>MEMCACHE_COMPRESSED</code></td>
<td>用于服务器验证的用户名</td>
</tr>
<tr>
<td>object</td>
<td>\Memcache</td>
<td>无</td>
<td>原始的Memcache对象</td>
</tr>
</tbody>
</table><h4>选项<code>servers</code>
</h4>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>host</td>
<td>string</td>
<td>127.0.0.1</td>
<td>Memcache服务器地址</td>
</tr>
<tr>
<td>port</td>
<td>int</td>
<td>11211</td>
<td>Memcache服务器端口</td>
</tr>
<tr>
<td>persistent</td>
<td>bool</td>
<td>true</td>
<td>是否使用长连接</td>
</tr>
</tbody>
</table><h3>继承的方法</h3>

<p>通用方法请查看<a href="#cache">Cache</a>对象</p>

<h3>方法</h3>

<h4>memcache-&gt;getObject()</h4>

<p>获取原生Memcache对象</p>

<h4>memcache-&gt;setObject($memcache)</h4>

<p>设置原生Memcache对象</p>
  </section>

<!-- api/memcached
  ================================================== -->
  <section id="memcached">
  <div class="page-header"><h1>Memcached</h1></div>

<p>设置或获取一项缓存,缓存数据存储于memcached中</p>

<h2>案例</h2>

<h3>设置和获取缓存</h3>

<div class="highlight"><pre><code class="php"><span class="c1">// 设置缓存,返回true</span>
<span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">memcached</span><span class="p">(</span><span class="s1">'key'</span><span class="p">,</span> <span class="s1">'value'</span><span class="p">);</span>

<span class="c1">// 获取缓存,返回'value'</span>
<span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">memcached</span><span class="p">(</span><span class="s1">'key'</span><span class="p">);</span>
</code></pre></div>

<h3>设置60秒后就过期的缓存</h3>

<div class="highlight"><pre><code class="php"><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">memcached</span><span class="p">(</span><span class="s1">'key'</span><span class="p">,</span> <span class="s1">'value'</span><span class="p">,</span> <span class="mi">60</span><span class="p">);</span>
</code></pre></div>

<p>更多案例请查看<a href="#cache">Cache</a>对象</p>

<h2>调用方式</h2>

<h3>选项</h3>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>servers</td>
<td>array</td>
<td>见下表</td>
<td>服务器配置数组</td>
</tr>
<tr>
<td>object</td>
<td>\Memcached</td>
<td>无</td>
<td>原始的memcached对象</td>
</tr>
</tbody>
</table><h4>选项<code>servers</code>
</h4>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>host</td>
<td>string</td>
<td>127.0.0.1</td>
<td>memcached服务器地址</td>
</tr>
<tr>
<td>port</td>
<td>int</td>
<td>11211</td>
<td>memcached服务器端口</td>
</tr>
</tbody>
</table><h3>继承的方法</h3>

<p>通用方法请查看<a href="#cache">Cache</a>对象</p>

<h3>方法</h3>

<h4>memcached-&gt;getObject()</h4>

<p>获取原生Memcached对象</p>

<h4>memcached-&gt;setObject($memcached)</h4>

<p>设置原生Memcached对象</p>
  </section>

<!-- api/mongoCache
  ================================================== -->
  <section id="mongoCache">
  <div class="page-header"><h1>MongoCache</h1></div>

<p>设置或获取一项缓存,缓存数据存储于<a href="http://docs.mongodb.org/ecosystem/drivers/php/" target="_blank">MangoDB</a>中</p>

<h2>案例</h2>

<h3>设置和获取缓存</h3>

<div class="highlight"><pre><code class="php"><span class="c1">// 设置缓存,返回true</span>
<span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">mongoCache</span><span class="p">(</span><span class="s1">'key'</span><span class="p">,</span> <span class="s1">'value'</span><span class="p">);</span>

<span class="c1">// 获取缓存,返回'value'</span>
<span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">mongoCache</span><span class="p">(</span><span class="s1">'key'</span><span class="p">);</span>
</code></pre></div>

<h3>设置60秒后就过期的缓存</h3>

<div class="highlight"><pre><code class="php"><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">mongoCache</span><span class="p">(</span><span class="s1">'key'</span><span class="p">,</span> <span class="s1">'value'</span><span class="p">,</span> <span class="mi">60</span><span class="p">);</span>
</code></pre></div>

<p>更多案例请查看<a href="#cache">Cache</a>对象</p>

<h2>调用方式</h2>

<h3>选项</h3>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>host</td>
<td>string</td>
<td>localhost</td>
<td>MangoDB所在的服务器名称</td>
</tr>
<tr>
<td>port</td>
<td>int</td>
<td>27017</td>
<td>MangoDB所在的服务器的端口</td>
</tr>
<tr>
<td>db</td>
<td>string</td>
<td>cache</td>
<td>存储缓存数据的数据库的名称</td>
</tr>
<tr>
<td>collection</td>
<td>string</td>
<td>cache</td>
<td>存储缓存数据的集合的名称</td>
</tr>
</tbody>
</table><h3>继承的方法</h3>

<p>通用方法请查看<a href="#cache">Cache</a>对象</p>

<h3>方法</h3>

<p><em>无</em></p>
  </section>

<!-- api/redis
  ================================================== -->
  <section id="redis">
  <div class="page-header"><h1>Redis</h1></div>

<p>设置或获取一项缓存,缓存数据存储于Redis中</p>

<h2>案例</h2>

<h3>设置和获取缓存</h3>

<div class="highlight"><pre><code class="php"><span class="c1">// 设置缓存,返回true</span>
<span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">redis</span><span class="p">(</span><span class="s1">'key'</span><span class="p">,</span> <span class="s1">'value'</span><span class="p">);</span>

<span class="c1">// 获取缓存,返回'value'</span>
<span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">redis</span><span class="p">(</span><span class="s1">'key'</span><span class="p">);</span>
</code></pre></div>

<h3>设置60秒后就过期的缓存</h3>

<div class="highlight"><pre><code class="php"><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">redis</span><span class="p">(</span><span class="s1">'key'</span><span class="p">,</span> <span class="s1">'value'</span><span class="p">,</span> <span class="mi">60</span><span class="p">);</span>
</code></pre></div>

<p>更多案例请查看<a href="#cache">Cache</a>对象</p>

<h2>调用方式</h2>

<h3>选项</h3>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>host</td>
<td>string</td>
<td>127.0.0.1</td>
<td>Redis所在的服务器名称</td>
</tr>
<tr>
<td>prot</td>
<td>int</td>
<td>6379</td>
<td>Redis所在的服务器端口</td>
</tr>
<tr>
<td>timeout</td>
<td>float</td>
<td>0.0</td>
<td>连接服务器的超时秒数</td>
</tr>
<tr>
<td>persistent</td>
<td>bool</td>
<td>true</td>
<td>是否使用长连接</td>
</tr>
<tr>
<td>auth</td>
<td>string</td>
<td>无</td>
<td>Redis服务器的验证密码</td>
</tr>
<tr>
<td>object</td>
<td>\Redis</td>
<td>无</td>
<td>原始的Redis对象</td>
</tr>
<tr>
<td>options</td>
<td>array</td>
<td>-</td>
<td>\Redis::setOption()方法的参数</td>
</tr>
</tbody>
</table><h3>继承的方法</h3>

<p>通用方法请查看<a href="#cache">Cache</a>对象</p>

<h3>方法</h3>

<h4>redis-&gt;getObject()</h4>

<p>获取原生Redis对象</p>

<h4>redis-&gt;setObject($redis)</h4>

<p>设置原生Redis对象</p>
  </section>

<!-- api/db
  ================================================== -->
  <section id="db">
  <div class="page-header"><h1>Db</h1></div>

<p>基于PDO的数据库操作对象,支持基本的增删查改(CRUD)和流行的Active Record模式的数据库操作.</p>

<p>目前主要支持<code>MySQL</code>,<code>SQLite</code>和<code>PostgreSQL</code>数据库.</p>

<h2>案例</h2>

<h3>增删查改(CRUD)操作</h3>

<div class="highlight"><pre><code class="php"><span class="c1">// 插入数据</span>
<span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">db</span><span class="o">-&gt;</span><span class="na">insert</span><span class="p">(</span><span class="s1">'user'</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">'username'</span> <span class="o">=&gt;</span> <span class="s1">'twin'</span><span class="p">,</span>
    <span class="s1">'createdAt'</span> <span class="o">=&gt;</span> <span class="nb">date</span><span class="p">(</span><span class="s1">'Y-m-d H:i:s'</span><span class="p">)</span>
<span class="p">));</span>

<span class="c1">// 更新数据</span>
<span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">db</span><span class="o">-&gt;</span><span class="na">update</span><span class="p">(</span>
    <span class="s1">'user'</span><span class="p">,</span>
    <span class="k">array</span><span class="p">(</span><span class="s1">'username'</span> <span class="o">=&gt;</span> <span class="s1">'twin'</span><span class="p">),</span>
    <span class="k">array</span><span class="p">(</span><span class="s1">'id'</span> <span class="o">=&gt;</span> <span class="s1">'1'</span><span class="p">)</span>
<span class="p">);</span>

<span class="c1">// 删除数据</span>
<span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">db</span><span class="o">-&gt;</span><span class="na">delete</span><span class="p">(</span><span class="s1">'user'</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">'id'</span> <span class="o">=&gt;</span> <span class="s1">'1'</span><span class="p">));</span>

<span class="c1">// 查找id为1的用户</span>
<span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">db</span><span class="o">-&gt;</span><span class="na">select</span><span class="p">(</span><span class="s1">'user'</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>

<span class="c1">// 查找所有分组编号为1的用户</span>
<span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">db</span><span class="o">-&gt;</span><span class="na">selectAll</span><span class="p">(</span><span class="s1">'user'</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">'groupId'</span> <span class="o">=&gt;</span> <span class="s1">'1'</span><span class="p">));</span>
</code></pre></div>

<h3>Active Record模式</h3>

<p>Active Record模式是将数据表的每一行映射为一个对象,数据表的字段与对象的属性一一对应.</p>

<p>完整的介绍请查看维基百科的说明<a href="http://zh.wikipedia.org/wiki/Active_Record" target="_blank">Active Record</a></p>

<p><a href="#activeRecord">查看Active Record</a></p>

<p><strong>创建记录并保存</strong></p>

<div class="highlight"><pre><code class="php"><span class="c1">// 创建一个新的用户记录对象</span>
<span class="nv">$user</span> <span class="o">=</span> <span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">db</span><span class="o">-&gt;</span><span class="na">create</span><span class="p">(</span><span class="s1">'user'</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">'groupId'</span> <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">));</span>

<span class="c1">// 设置对象的值</span>
<span class="nv">$user</span><span class="o">-&gt;</span><span class="na">username</span> <span class="o">=</span> <span class="s1">'twin'</span><span class="p">;</span>
<span class="nv">$user</span><span class="o">-&gt;</span><span class="na">createdAt</span> <span class="o">=</span> <span class="nb">date</span><span class="p">(</span><span class="s1">'Y-m-d H:i:s'</span><span class="p">);</span>

<span class="c1">// 保存到数据库中</span>
<span class="nv">$user</span><span class="o">-&gt;</span><span class="na">save</span><span class="p">();</span>
</code></pre></div>

<p><strong>查找并更新记录数据</strong></p>

<div class="highlight"><pre><code class="php"><span class="c1">// 查找主键为1的用户</span>
<span class="nv">$user</span> <span class="o">=</span> <span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">db</span><span class="o">-&gt;</span><span class="na">find</span><span class="p">(</span><span class="s1">'user'</span><span class="p">,</span> <span class="s1">'1'</span><span class="p">);</span>

<span class="c1">// 或是通过魔术方法更自然地获取对象</span>
<span class="nv">$user</span> <span class="o">=</span> <span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">db</span><span class="o">-&gt;</span><span class="na">user</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>

<span class="c1">// 更新对象的值</span>
<span class="nv">$user</span><span class="o">-&gt;</span><span class="na">username</span> <span class="o">=</span> <span class="s1">'twin'</span><span class="p">;</span>

<span class="c1">// 保存到数据库中</span>
<span class="nv">$user</span><span class="o">-&gt;</span><span class="na">save</span><span class="p">();</span>
</code></pre></div>

<p><strong>删除记录</strong></p>

<div class="highlight"><pre><code class="php"><span class="c1">// 查找主键为1的用户</span>
<span class="nv">$user</span> <span class="o">=</span> <span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">db</span><span class="o">-&gt;</span><span class="na">user</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>

<span class="c1">// 删除该记录</span>
<span class="nv">$user</span><span class="o">-&gt;</span><span class="na">delete</span><span class="p">();</span>
</code></pre></div>

<h3>SQL查询构建器</h3>

<p>如果增删查改(CRUD)操作和Active Record模式还不能满足您的需求,你可以尝试使用QueryBuilder来生成更复杂的SQL语句</p>

<p><a href="#queryBuilder">查看QueryBuilder</a></p>

<h3>连接到多个数据库</h3>

<div class="highlight"><pre><code class="php"><span class="nv">$widget</span> <span class="o">=</span> <span class="nx">widget</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
    <span class="c1">// 数据库对象的配置</span>
    <span class="s1">'db'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">'driver'</span>    <span class="o">=&gt;</span> <span class="s1">'mysql'</span><span class="p">,</span>
        <span class="s1">'host'</span>      <span class="o">=&gt;</span> <span class="s1">'localhost'</span><span class="p">,</span>
        <span class="s1">'dbname'</span>    <span class="o">=&gt;</span> <span class="s1">'widget'</span><span class="p">,</span>
        <span class="s1">'charset'</span>   <span class="o">=&gt;</span> <span class="s1">'utf8'</span><span class="p">,</span>
        <span class="s1">'user'</span>      <span class="o">=&gt;</span> <span class="s1">'root'</span><span class="p">,</span>
        <span class="s1">'password'</span>  <span class="o">=&gt;</span> <span class="s1">'123456'</span><span class="p">,</span>
    <span class="p">),</span>
    <span class="c1">// 备机数据库对象的配置</span>
    <span class="s1">'slave.db'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">'driver'</span>    <span class="o">=&gt;</span> <span class="s1">'mysql'</span><span class="p">,</span>
        <span class="s1">'host'</span>      <span class="o">=&gt;</span> <span class="s1">'slave-host'</span><span class="p">,</span>
        <span class="s1">'dbname'</span>    <span class="o">=&gt;</span> <span class="s1">'widget'</span><span class="p">,</span>
        <span class="s1">'charset'</span>   <span class="o">=&gt;</span> <span class="s1">'utf-8'</span><span class="p">,</span>
        <span class="s1">'user'</span>      <span class="o">=&gt;</span> <span class="s1">'root'</span><span class="p">,</span>
        <span class="s1">'password'</span>  <span class="o">=&gt;</span> <span class="s1">'123456'</span><span class="p">,</span>
    <span class="p">),</span>
    <span class="c1">// 日志数据库对象的配置</span>
    <span class="s1">'logger.db'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">'driver'</span>    <span class="o">=&gt;</span> <span class="s1">'mysql'</span><span class="p">,</span>
        <span class="s1">'host'</span>      <span class="o">=&gt;</span> <span class="s1">'logger-host'</span><span class="p">,</span>
        <span class="s1">'dbname'</span>    <span class="o">=&gt;</span> <span class="s1">'widget'</span><span class="p">,</span>
        <span class="s1">'charset'</span>   <span class="o">=&gt;</span> <span class="s1">'utf-8'</span><span class="p">,</span>
        <span class="s1">'user'</span>      <span class="o">=&gt;</span> <span class="s1">'root'</span><span class="p">,</span>
        <span class="s1">'password'</span>  <span class="o">=&gt;</span> <span class="s1">'123456'</span><span class="p">,</span>
    <span class="p">)</span>
<span class="p">));</span>

<span class="c1">// 获取默认数据库对象</span>
<span class="nv">$db</span> <span class="o">=</span> <span class="nv">$widget</span><span class="o">-&gt;</span><span class="na">db</span><span class="p">;</span>

<span class="c1">// 获取备机数据库对象</span>
<span class="nv">$slaveDb</span> <span class="o">=</span> <span class="nv">$widget</span><span class="o">-&gt;</span><span class="na">slaveDb</span><span class="p">;</span>

<span class="c1">// 获取日志数据库对象</span>
<span class="nv">$loggerDb</span> <span class="o">=</span> <span class="nv">$widget</span><span class="o">-&gt;</span><span class="na">loggerDb</span><span class="p">;</span>

<span class="c1">// 使用日志数据库对象查询用户编号为1的操作日志</span>
<span class="nv">$loggerDb</span><span class="o">-&gt;</span><span class="na">findAll</span><span class="p">(</span><span class="s1">'userLog'</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">'userId'</span> <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">));</span>
</code></pre></div>

<h3>区分<code>fetch</code>,<code>select</code>和<code>find</code>方法</h3>

<p>在db对象,<code>fetch</code>,<code>select</code>和<code>find</code>方法都是用于查询数据库数据,他们共同的特征是只返回第一行数据,不同点在于:</p>

<ul>
<li>
<code>fetch</code>方法的第一个参数是完整的SQL语句,返回的是数组</li>
<li>
<code>select</code>方法的第一个参数是数据表名称,返回的是数组</li>
<li>
<code>find</code>方法的第一个参数也是数据表名称,但返回的是<code>Widget\Db\Record</code>对象</li>
</ul><p>另外,如果要查询多条数据,对应的方法是<code>fetchAll</code>,<code>selectAll</code>和<code>findAll</code>.</p>

<div class="highlight"><pre><code class="php"><span class="nv">$db</span> <span class="o">=</span> <span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">db</span><span class="p">;</span>

<span class="c1">// 根据SQL语句查询一行记录,返回一个一维数组</span>
<span class="nv">$array</span> <span class="o">=</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">fetch</span><span class="p">(</span><span class="s2">"SELECT * FROM user WHERE id = 1"</span><span class="p">);</span>

<span class="c1">// 根据表名和条件查询一行记录,返回一个一维数组</span>
<span class="nv">$array</span> <span class="o">=</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">select</span><span class="p">(</span><span class="s1">'user'</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>

<span class="c1">// 根据表名和条件查询一行记录,返回一个`Widget\Db\Record`对象</span>
<span class="nv">$record</span> <span class="o">=</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">find</span><span class="p">(</span><span class="s1">'user'</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>

<span class="c1">// 根据SQL语句查询多行记录,返回一个二维数组</span>
<span class="nv">$array</span> <span class="o">=</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">fetchAll</span><span class="p">(</span><span class="s2">"SELECT * FROM user WHERE groupId = 1"</span><span class="p">);</span>

<span class="c1">// 根据表名和条件查询多行记录,返回一个二维数组</span>
<span class="nv">$array</span> <span class="o">=</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">select</span><span class="p">(</span><span class="s1">'user'</span><span class="p">);</span>

<span class="c1">// 根据表名和条件查询多行记录,返回一个`Widget\Db\Collection`对象</span>
<span class="nv">$collection</span> <span class="o">=</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="na">find</span><span class="p">(</span><span class="s1">'user'</span><span class="p">);</span>
</code></pre></div>

<h3>所有查询方法的参数和返回值类型比较</h3>

<table class="table table-bordered table-striped">
<thead><tr>
<th>方法</th>
<th>参数</th>
<th>返回值类型</th>
</tr></thead>
<tbody>
<tr>
<td>select</td>
<td>$table, $conditions</td>
<td>数组</td>
</tr>
<tr>
<td>selectAll</td>
<td>$table, $conditions</td>
<td>二维数组</td>
</tr>
<tr>
<td>fetch</td>
<td>$sql</td>
<td>数组</td>
</tr>
<tr>
<td>fetchAll</td>
<td>$sql</td>
<td>二维数组</td>
</tr>
<tr>
<td>fetchColumn</td>
<td>$sql</td>
<td>字符串,返回指定栏的值</td>
</tr>
<tr>
<td>find</td>
<td>$table, $conditions</td>
<td>Widget\Db\Record对象</td>
</tr>
<tr>
<td>findAll</td>
<td>$table, $conditions</td>
<td>Widget\Db\Collection对象</td>
</tr>
<tr>
<td>query</td>
<td>$sql</td>
<td>PDOStatement对象</td>
</tr>
</tbody>
</table><h3>通过beforeQuery回调记录SQL日志</h3>

<div class="highlight"><pre><code class="php"><span class="nv">$widget</span> <span class="o">=</span> <span class="nx">widget</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
    <span class="s1">'db'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">'beforeQuery'</span> <span class="o">=&gt;</span> <span class="k">function</span><span class="p">(</span><span class="nv">$sql</span><span class="p">,</span> <span class="nv">$params</span><span class="p">,</span> <span class="nv">$types</span><span class="p">,</span> <span class="nv">$db</span><span class="p">)</span> <span class="p">{</span>
            <span class="nv">$log</span> <span class="o">=</span> <span class="nv">$sql</span> <span class="o">.</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span> <span class="o">.</span> <span class="nb">var_export</span><span class="p">(</span><span class="nv">$params</span><span class="p">,</span> <span class="k">true</span><span class="p">);</span>
            <span class="c1">// 通过db对象获取logger对象,并调用debug方法记录SQL日志</span>
            <span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">logger</span><span class="o">-&gt;</span><span class="na">debug</span><span class="p">(</span><span class="nv">$log</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">)</span>
<span class="p">));</span>

<span class="nv">$widget</span><span class="o">-&gt;</span><span class="na">db</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="s2">"SELECT DATE('now')"</span><span class="p">);</span>

<span class="c1">// 日志文件内容</span>
<span class="c1">//[2013-07-10 23:15:38] widget.DEBUG: SELECT DATE('now')</span>
<span class="c1">//array (</span>
<span class="c1">//)</span>
</code></pre></div>

<h3>配置读写分离(master-slave)的数据库操作</h3>

<p>通过<code>slaveDb</code>选项可配置备数据库,主要具有以下功能</p>

<ul>
<li>读操作使用slave数据库</li>
<li>写操作使用master数据库</li>
</ul><div class="highlight"><pre><code class="php"><span class="nv">$widget</span> <span class="o">=</span> <span class="nx">widget</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
    <span class="c1">// 主数据库对象的配置</span>
    <span class="s1">'db'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">'driver'</span>    <span class="o">=&gt;</span> <span class="s1">'mysql'</span><span class="p">,</span>
        <span class="s1">'host'</span>      <span class="o">=&gt;</span> <span class="s1">'localhost'</span><span class="p">,</span>
        <span class="s1">'dbname'</span>    <span class="o">=&gt;</span> <span class="s1">'widget'</span><span class="p">,</span>
        <span class="s1">'charset'</span>   <span class="o">=&gt;</span> <span class="s1">'utf8'</span><span class="p">,</span>
        <span class="s1">'user'</span>      <span class="o">=&gt;</span> <span class="s1">'root'</span><span class="p">,</span>
        <span class="s1">'password'</span>  <span class="o">=&gt;</span> <span class="s1">'123456'</span><span class="p">,</span>
        <span class="c1">// 重要: 通过`slaveDb`选项指定备机数据库的配置名称</span>
        <span class="s1">'slaveDb'</span>   <span class="o">=&gt;</span> <span class="s1">'slave.db'</span>
    <span class="p">),</span>
    <span class="c1">// 备机数据库对象的配置</span>
    <span class="s1">'slave.db'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">'driver'</span>    <span class="o">=&gt;</span> <span class="s1">'mysql'</span><span class="p">,</span>
        <span class="s1">'host'</span>      <span class="o">=&gt;</span> <span class="s1">'slave-host'</span><span class="p">,</span>
        <span class="s1">'dbname'</span>    <span class="o">=&gt;</span> <span class="s1">'widget'</span><span class="p">,</span>
        <span class="s1">'charset'</span>   <span class="o">=&gt;</span> <span class="s1">'utf-8'</span><span class="p">,</span>
        <span class="s1">'user'</span>      <span class="o">=&gt;</span> <span class="s1">'root'</span><span class="p">,</span>
        <span class="s1">'password'</span>  <span class="o">=&gt;</span> <span class="s1">'123456'</span><span class="p">,</span>
    <span class="p">),</span>
<span class="p">));</span>

<span class="c1">// 获取主数据库对象</span>
<span class="nv">$db</span> <span class="o">=</span> <span class="nv">$widget</span><span class="o">-&gt;</span><span class="na">db</span><span class="p">;</span>

<span class="c1">// 执行写操作,使用主数据库</span>
<span class="nv">$db</span><span class="o">-&gt;</span><span class="na">insert</span><span class="p">(</span><span class="s1">'table'</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">'key'</span> <span class="o">=&gt;</span> <span class="s1">'value'</span><span class="p">));</span>
<span class="nv">$db</span><span class="o">-&gt;</span><span class="na">update</span><span class="p">(</span><span class="s1">'table'</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">'set'</span> <span class="o">=&gt;</span> <span class="s1">'value'</span><span class="p">),</span> <span class="k">array</span><span class="p">(</span><span class="s1">'where'</span> <span class="o">=&gt;</span> <span class="s1">'value'</span><span class="p">))</span>

<span class="c1">// 执行读操作,使用备数据库</span>
<span class="nv">$db</span><span class="o">-&gt;</span><span class="na">select</span><span class="p">(</span><span class="s1">'table'</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">'key'</span> <span class="o">=&gt;</span> <span class="s1">'value'</span><span class="p">));</span>
<span class="nv">$db</span><span class="o">-&gt;</span><span class="na">find</span><span class="p">(</span><span class="s1">'table'</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">'key'</span> <span class="o">=&gt;</span> <span class="s1">'value'</span><span class="p">));</span>

<span class="c1">// 获取备数据库对象</span>
<span class="nv">$slaveDb</span> <span class="o">=</span> <span class="nv">$widget</span><span class="o">-&gt;</span><span class="na">slaveDb</span><span class="p">;</span>

<span class="c1">// 直接使用备数据库操作</span>
<span class="nv">$slaveDb</span><span class="o">-&gt;</span><span class="na">select</span><span class="p">(</span><span class="s1">'table'</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">'key'</span> <span class="o">=&gt;</span> <span class="s1">'value'</span><span class="p">));</span>
</code></pre></div>

<h2>调用方式</h2>

<h3>选项</h3>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>dirver</td>
<td>string</td>
<td>mysql</td>
<td>数据库驱动类型,可以是<code>mysql</code>,<code>sqlite</code>或<code>pgsql</code>
</td>
</tr>
<tr>
<td>user</td>
<td>string</td>
<td>无</td>
<td>连接数据库的用户名</td>
</tr>
<tr>
<td>password</td>
<td>string</td>
<td>无</td>
<td>连接数据库的密码</td>
</tr>
<tr>
<td>host</td>
<td>string</td>
<td>127.0.0.1</td>
<td>数据库所在的主机地址,仅驱动为mysql和pgsql时有效</td>
</tr>
<tr>
<td>port</td>
<td>string</td>
<td>无</td>
<td>数据库服务器运行的端口,仅驱动为mysql和pgsql时有效</td>
</tr>
<tr>
<td>dbname</td>
<td>string</td>
<td>无</td>
<td>数据库名称,仅驱动为mysql和pgsql时有效</td>
</tr>
<tr>
<td>unixSocket</td>
<td>string</td>
<td>无</td>
<td>MySQL数据库的Unix socket连接文件,仅驱动为mysql时有效</td>
</tr>
<tr>
<td>charset</td>
<td>string</td>
<td>无</td>
<td>连接数据库的字符集,仅驱动为mysql时有效</td>
</tr>
<tr>
<td>path</td>
<td>string</td>
<td>无</td>
<td>SQLite数据库所在的路径,如果存储在内存中,使用<code>:memory:</code>
</td>
</tr>
<tr>
<td>attrs</td>
<td>array</td>
<td>array()</td>
<td>PDO的属性配置</td>
</tr>
<tr>
<td>recordClass</td>
<td>string</td>
<td>Widget\Db\Record</td>
<td>记录类的基础类名称</td>
</tr>
<tr>
<td>collectionClass</td>
<td>string</td>
<td>Widget\Db\Collection</td>
<td>记录集合类的基础类名称</td>
</tr>
<tr>
<td>recordClasses</td>
<td>array</td>
<td>array()</td>
<td>自定义记录类的数组,键名为数据表名称,值为记录类名称</td>
</tr>
<tr>
<td>recordNamespace</td>
<td>string</td>
<td>无</td>
<td>自定义记录类的命名空间</td>
</tr>
<tr>
<td>slaveDb</td>
<td>string</td>
<td>无</td>
<td>Slave数据库(用于读查询)的配置名称</td>
</tr>
<tr>
<td>global</td>
<td>bool</td>
<td>false</td>
<td>新创建的db服务是否使用默认<code>db</code>的选项</td>
</tr>
<tr>
<td>beforeConnect</td>
<td>callback</td>
<td>无</td>
<td>在连接PDO之前触发的回调方法</td>
</tr>
<tr>
<td>connectFails</td>
<td>callback</td>
<td>无</td>
<td>连接PDO失败时触发的回调方法</td>
</tr>
<tr>
<td>afterConnect</td>
<td>callback</td>
<td>无</td>
<td>连接PDO完成(成功)时触发的回调方法</td>
</tr>
<tr>
<td>beforeQuery</td>
<td>callback</td>
<td>无</td>
<td>在执行SQL语句之前触发的回调方法</td>
</tr>
<tr>
<td>afterQuery</td>
<td>callback</td>
<td>无</td>
<td>在执行SQL语句之后触发的回调方法</td>
</tr>
</tbody>
</table><h4>不同驱动连接到数据库的连接选项</h4>

<table class="table table-bordered table-striped">
<thead><tr>
<th>驱动类型</th>
<th>选项</th>
</tr></thead>
<tbody>
<tr>
<td>mysql</td>
<td>user, password, host, port, dbname, unixSocket, charset</td>
</tr>
<tr>
<td>pgsql</td>
<td>user, password, host, port, dbname</td>
</tr>
<tr>
<td>sqlite</td>
<td>path</td>
</tr>
</tbody>
</table><h3>回调</h3>

<h4>beforeConnect</h4>

<p>在连接PDO之前触发的回调方法</p>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr></thead>
<tbody><tr>
<td>$db</td>
<td>Widget\Db</td>
<td>当前Db对象</td>
</tr></tbody>
</table><h4>connectFails</h4>

<p>连接PDO失败时触发的回调方法</p>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>$db</td>
<td>Widget\Db</td>
<td>当前Db对象</td>
</tr>
<tr>
<td>$e</td>
<td>PDOException</td>
<td>PDO异常对象</td>
</tr>
</tbody>
</table><h4>afterConnect</h4>

<p>连接PDO完成(成功)时触发的回调方法</p>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>$db</td>
<td>Widget\Db</td>
<td>当前Db对象</td>
</tr>
<tr>
<td>$pdo</td>
<td>PDO</td>
<td>PDO对象</td>
</tr>
</tbody>
</table><h4>beforeQuery</h4>

<p>在执行SQL语句之前触发的回调方法</p>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>$sql</td>
<td>string</td>
<td>当前执行的SQL语句</td>
</tr>
<tr>
<td>$params</td>
<td>array</td>
<td>执行语句的参数</td>
</tr>
<tr>
<td>$types</td>
<td>array</td>
<td>执行语句的参数类型</td>
</tr>
<tr>
<td>$db</td>
<td>Widget\Db</td>
<td>当前Db对象</td>
</tr>
</tbody>
</table><h4>afterQuery</h4>

<p>在执行SQL语句之后触发的回调方法</p>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr></thead>
<tbody><tr>
<td>$db</td>
<td>Widget\Db</td>
<td>当前Db对象</td>
</tr></tbody>
</table><h3>方法</h3>

<h4>db($table = null)</h4>

<p>根据数据表名称,创建一个新Query Builder对象</p>

<p><strong>返回:</strong> <code>Widget\Db\QueryBuilder</code></p>

<p><strong>参数</strong></p>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr></thead>
<tbody><tr>
<td>$table</td>
<td>string</td>
<td>数据表的名称,如<code>user</code>,或带别名形式的<code>user u</code>
</td>
</tr></tbody>
</table><h4>db-&gt;insert($table, $data = array())</h4>

<p>向指定的数据表插入一条数据</p>

<p><strong>返回:</strong> <code>int</code> 受影响的行数</p>

<p><strong>参数</strong></p>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>$table</td>
<td>string</td>
<td>要插入的数据表名称</td>
</tr>
<tr>
<td>$data</td>
<td>array</td>
<td>要插入的数据,数组的键名是数据表的字段名称,值是字段的值</td>
</tr>
</tbody>
</table><h4>db-&gt;insertBatch($table, $data = array())</h4>

<p>向指定的数据表插入多条数据(目前不支持<code>SQLite</code>)</p>

<p><strong>返回:</strong> <code>int</code> 受影响的行数</p>

<p><strong>参数</strong></p>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>$table</td>
<td>string</td>
<td>要插入的数据表名称</td>
</tr>
<tr>
<td>$data</td>
<td>array</td>
<td>要插入的二维数组数据</td>
</tr>
</tbody>
</table><h4>db-&gt;lastInsertId($sequence = null)</h4>

<p>获取最后插入数据表的自增编号</p>

<p><strong>返回:</strong> <code>string</code></p>

<p><strong>参数</strong></p>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr></thead>
<tbody><tr>
<td>$sequence</td>
<td>string</td>
<td>序列名称,数据库驱动为<code>PostgreSQL</code>时才需要提供该参数</td>
</tr></tbody>
</table><h4>db-&gt;update($table, $data = array(), $conditions = array())</h4>

<p>根据条件更新数据表数据</p>

<p><strong>返回:</strong> <code>int</code> 受影响的行数</p>

<p><strong>参数</strong></p>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>$table</td>
<td>string</td>
<td>要更新的数据表名称</td>
</tr>
<tr>
<td>$data</td>
<td>array</td>
<td>要更新的数据</td>
</tr>
<tr>
<td>$conditions</td>
<td>array</td>
<td>更新语句的查询条件</td>
</tr>
</tbody>
</table><h4>db-&gt;delete($table, $conditions = array())</h4>

<p>根据条件删除数据表数据</p>

<p><strong>返回:</strong> <code>int</code> 受影响的行数</p>

<p><strong>参数</strong></p>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>$table</td>
<td>string</td>
<td>要删除的数据表名称</td>
</tr>
<tr>
<td>$conditions</td>
<td>array</td>
<td>删除语句的查询条件</td>
</tr>
</tbody>
</table><h4>db-&gt;select($table, $conditions = array())</h4>

<p>根据条件查找数据表的一条记录</p>

<p><strong>返回:</strong> <code>array</code>|<code>false</code> 如果记录存在,返回记录数组,不存在返回<code>false</code></p>

<p><strong>参数</strong></p>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>$table</td>
<td>string</td>
<td>要查找的数据表名称</td>
</tr>
<tr>
<td>$conditions</td>
<td>string,array</td>
<td>查询条件,如果类型是字符串,表示主键的值,如果是数组,键名表示数据表字段,值表示字段的值</td>
</tr>
</tbody>
</table><h4>db-&gt;selectAll($table, $conditions = array())</h4>

<p>根据条件查找数据表的所有匹配记录</p>

<p><strong>返回:</strong> <code>array</code>|<code>false</code> 如果记录存在,返回二维记录数组,不存在返回<code>false</code></p>

<p><strong>参数</strong></p>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>$table</td>
<td>string</td>
<td>要查找的数据表名称</td>
</tr>
<tr>
<td>$conditions</td>
<td>string,array</td>
<td>查询条件,如果类型是字符串,表示主键的值,如果是数组,键名表示数据表字段,值表示字段的值</td>
</tr>
</tbody>
</table><h4>db-&gt;fetch($sql, $params = array())</h4>

<p>执行一条SQL语句并返回第一条记录,主要用于SELECT的SQL语句</p>

<p><strong>返回:</strong> <code>array</code>|<code>false</code> 如果记录存在,返回记录数组,不存在返回<code>false</code></p>

<p><strong>参数</strong></p>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>$sql</td>
<td>string</td>
<td>要执行的SQL语句</td>
</tr>
<tr>
<td>$params</td>
<td>array</td>
<td>绑定到SQL的参数</td>
</tr>
</tbody>
</table><h4>db-&gt;fetchAll($sql, $params = array())</h4>

<p>执行一条SQL语句并返回所有记录</p>

<p><strong>返回:</strong> <code>array</code>|<code>false</code> 如果记录存在,返回二维记录数组,不存在返回<code>false</code></p>

<p><strong>参数</strong></p>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>$sql</td>
<td>string</td>
<td>要执行的SQL语句</td>
</tr>
<tr>
<td>$params</td>
<td>array</td>
<td>绑定到SQL的参数</td>
</tr>
</tbody>
</table><h4>db-&gt;fetchColumn($sql, $params = array(), $column = 0)</h4>

<p>执行一条SQL语句,并返回指定项目的值</p>

<p><strong>返回:</strong> <code>string</code></p>

<p><strong>参数</strong></p>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>$sql</td>
<td>string</td>
<td>要执行的SQL语句</td>
</tr>
<tr>
<td>$params</td>
<td>array</td>
<td>绑定到SQL的参数</td>
</tr>
<tr>
<td>$column</td>
<td>int</td>
<td>返回第几项的值</td>
</tr>
</tbody>
</table><h4>db-&gt;find($table, $conditions)</h4>

<p>根据条件查找数据表的一条记录</p>

<p><strong>返回:</strong> <code>Widget\Db\Record</code>|<code>false</code> 如果记录存在,返回记录对象,否则返回<code>false</code></p>

<p><strong>参数</strong></p>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>$table</td>
<td>string</td>
<td>要查找的数据表名称</td>
</tr>
<tr>
<td>$conditions</td>
<td>string,array</td>
<td>查询条件,如果类型是字符串,表示主键的值,如果是数组,键名表示数据表字段,值表示字段的值</td>
</tr>
</tbody>
</table><h4>db-&gt;findAll($table, $conditions)</h4>

<p>根据条件查找数据表的所有匹配记录</p>

<p><strong>返回:</strong> <code>Widget\Db\Collection</code>|<code>false</code> 如果记录存在,返回集合对象,否则返回<code>false</code></p>

<p><strong>参数</strong></p>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>$table</td>
<td>string</td>
<td>要查找的数据表名称</td>
</tr>
<tr>
<td>$conditions</td>
<td>string,array</td>
<td>查询条件,如果类型是字符串,表示主键的值,如果是数组,键名表示数据表字段,值表示字段的值</td>
</tr>
</tbody>
</table><h4>db-&gt;create($table, $data = array())</h4>

<p>创建一个新的数据表记录对象</p>

<p><strong>返回:</strong> <code>Widget\Db\Record</code> 记录对象</p>

<p><strong>参数</strong></p>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>$table</td>
<td>string</td>
<td>记录的数据表名称</td>
</tr>
<tr>
<td>$data</td>
<td>array</td>
<td>初始化的数据</td>
</tr>
</tbody>
</table><h4>db-&gt;findOrCreate($table, $id, $data = array())</h4>

<p>根据条件查找数据表的一条记录,如果记录不存在,将根据<code>$data</code>创建一条新的数据表记录对象</p>

<p><strong>返回:</strong> <code>Widget\Db\Record</code> 记录对象</p>

<p><strong>参数</strong></p>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>$table</td>
<td>string</td>
<td>记录的数据表名称</td>
</tr>
<tr>
<td>$id</td>
<td>string</td>
<td>主键的值</td>
</tr>
<tr>
<td>$data</td>
<td>array</td>
<td>初始化的数据</td>
</tr>
</tbody>
</table><h4>db-&gt;executeUpdate($sql, $params = array())</h4>

<p>执行一条SQL语句,并返回影响的行数,主要用于INSERT/UPDATE/DELETE操作的SQL语句</p>

<p><strong>返回:</strong> <code>int</code> 受影响的行数</p>

<p><strong>参数</strong></p>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>$sql</td>
<td>string</td>
<td>要执行的SQL语句</td>
</tr>
<tr>
<td>$params</td>
<td>array</td>
<td>绑定到SQL的参数</td>
</tr>
</tbody>
</table><h4>db-&gt;query($sql, $params = array())</h4>

<p>执行一条SQL语句,并返回<code>PDOStatement</code>对象</p>

<p><strong>返回:</strong> <code>PDOStatement</code></p>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>$sql</td>
<td>string</td>
<td>要执行的SQL语句</td>
</tr>
<tr>
<td>$params</td>
<td>array</td>
<td>绑定到SQL的参数</td>
</tr>
</tbody>
</table><h4>db-&gt;errorCode()</h4>

<p>获取PDO错误代号</p>

<p><strong>返回:</strong> <code>int</code></p>

<h4>db-&gt;errorInfo()</h4>

<p>获取PD错误信息数组</p>

<p><strong>返回:</strong> <code>array</code></p>

<h4>db-&gt;isConnected()</h4>

<p>检查是否已经连接到数据库</p>

<p><strong>返回:</strong> <code>bool</code></p>

<h4>db-&gt;getRecordClass($table)</h4>

<p>根据数据表名称获取记录类名称</p>

<p><strong>返回:</strong> <code>string</code> 如果记录类不存在,返回默认类<code>Widget\Db\Record</code></p>

<h4>db-&gt;getUser()</h4>

<p>获取连接数据库的用户名称</p>

<p><strong>返回:</strong> <code>string</code></p>

<h4>db-&gt;getPassword()</h4>

<p>获取连接数据库的用户密码</p>

<p><strong>返回:</strong> <code>string</code></p>

<h4>db-&gt;getHost()</h4>

<p>获取数据库所在的主机地址</p>

<p><strong>返回:</strong> <code>string</code></p>

<h4>db-&gt;getPort()</h4>

<p>获取数据库服务器运行的端口</p>

<p><strong>返回:</strong> <code>string</code></p>

<h4>db-&gt;getDbname()</h4>

<p>获取数据库的名称</p>

<p><strong>返回:</strong> <code>string</code></p>

<h4>db-&gt;getDsn()</h4>

<p>获取连接到PDO的DSN字符串</p>

<p><strong>返回:</strong> <code>string</code></p>

<h4>db-&gt;getLastSql()</h4>

<p>获取最后执行的SQL语句</p>

<p><strong>返回:</strong> <code>string</code></p>

<h3>魔术方法</h3>

<h4>db-&gt;$table($conditions)</h4>

<p>根据条件查找数据表的一行记录,返回的是一个<code>Widget\Db\Record</code>对象,等于<code>db-&gt;find($table, $conditions)</code></p>

<p><strong>返回:</strong> <code>Widget\Db\Record</code></p>
  </section>

<!-- api/queryBuilder
  ================================================== -->
  <section id="queryBuilder">
  <div class="page-header"><h1>Query Builder</h1></div>

<p>Query Builder是一个简单的SQL查询构建器.</p>

<h2>案例</h2>

<h3>从用户表里查询id为<code>1</code>且用户名为<code>twin</code>的用户</h3>

<div class="highlight"><pre><code class="php"><span class="nv">$member</span> <span class="o">=</span> <span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">db</span><span class="p">(</span><span class="s1">'member'</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="na">select</span><span class="p">(</span><span class="s1">'id, username'</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="na">where</span><span class="p">(</span><span class="s1">'id = 1'</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="na">andWhere</span><span class="p">(</span><span class="s1">'username = ?'</span><span class="p">,</span> <span class="s1">'twin'</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="na">orderBy</span><span class="p">(</span><span class="s1">'id'</span><span class="p">,</span> <span class="s1">'DESC'</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="na">find</span><span class="p">();</span>

<span class="c1">// 执行的SQL语句如下</span>
<span class="c1">// SELECT id, title FROM member WHERE id = 1 AND author = ? ORDER BY id DESC LIMIT 1</span>
</code></pre></div>

<h3>创建一个新的QueryBuilder</h3>

<div class="highlight"><pre><code class="php"><span class="c1">// 创建一个新的QueryBuilder</span>
<span class="nv">$qb</span> <span class="o">=</span> <span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">db</span><span class="o">-&gt;</span><span class="na">createQueryBuilder</span><span class="p">()</span>

<span class="c1">// 创建一个指定数据表的QueryBuilder</span>
<span class="nv">$qb</span> <span class="o">=</span> <span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">db</span><span class="p">(</span><span class="s1">'member'</span><span class="p">);</span>
</code></pre></div>

<h3>字符串查询条件</h3>

<div class="highlight"><pre><code class="php"><span class="nv">$qb</span> <span class="o">=</span> <span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">db</span><span class="p">(</span><span class="s1">'member'</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">where</span><span class="p">(</span><span class="s2">"name = 'twin'"</span><span class="p">);</span>

<span class="c1">// 执行SQL: SELECT * FROM member WHERE name = 'twin' LIMIT 1</span>
<span class="nv">$member</span> <span class="o">=</span> <span class="nv">$qb</span><span class="o">-&gt;</span><span class="na">find</span><span class="p">();</span>
</code></pre></div>

<h3>通过问号占位符<code>?</code>构造查询条件</h3>

<div class="highlight"><pre><code class="php"><span class="nv">$qb</span> <span class="o">=</span> <span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">db</span><span class="p">(</span><span class="s1">'member'</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">where</span><span class="p">(</span><span class="s1">'name = ?'</span><span class="p">,</span> <span class="s1">'twin'</span><span class="p">);</span>

<span class="c1">// 执行SQL: SELECT * FROM member WHERE name = ? LIMIT 1</span>
<span class="nv">$member</span> <span class="o">=</span> <span class="nv">$qb</span><span class="o">-&gt;</span><span class="na">find</span><span class="p">();</span>
</code></pre></div>

<h3>通过多个问号占位符<code>?</code>构造查询条件</h3>

<div class="highlight"><pre><code class="php"><span class="nv">$qb</span> <span class="o">=</span> <span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">db</span><span class="p">(</span><span class="s1">'member'</span><span class="p">)</span><span class="o">&gt;</span><span class="nx">where</span><span class="p">(</span><span class="s1">'group_id = ? AND name = ?'</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">'1'</span><span class="p">,</span> <span class="s1">'twin'</span><span class="p">));</span>

<span class="c1">// 执行SQL: SELECT * FROM member WHERE group_id = ? AND name = ?  LIMIT 1</span>
<span class="nv">$member</span> <span class="o">=</span> <span class="nv">$qb</span><span class="o">-&gt;</span><span class="na">find</span><span class="p">();</span>
</code></pre></div>

<h3>通过命名占位符<code>:</code>构造查询条件</h3>

<div class="highlight"><pre><code class="php"><span class="nv">$qb</span> <span class="o">=</span> <span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">db</span><span class="p">(</span><span class="s1">'member'</span><span class="p">)</span>
        <span class="o">-&gt;</span><span class="na">where</span><span class="p">(</span><span class="s1">'group_id = :groupId AND name = :name'</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
            <span class="s1">'groupId'</span> <span class="o">=&gt;</span> <span class="s1">'1'</span><span class="p">,</span>
            <span class="s1">'name'</span> <span class="o">=&gt;</span> <span class="s1">'twin'</span>
        <span class="p">));</span>

<span class="c1">// 执行SQL: SELECT * FROM member WHERE group_id = :groupId AND name = :name</span>
<span class="nv">$member</span> <span class="o">=</span> <span class="nv">$qb</span><span class="o">-&gt;</span><span class="na">find</span><span class="p">();</span>
</code></pre></div>

<h3>构造范围查询</h3>

<div class="highlight"><pre><code class="php"><span class="nv">$qb</span> <span class="o">=</span> <span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">db</span><span class="p">(</span><span class="s1">'member'</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">where</span><span class="p">(</span><span class="s1">'group_id BETWEEN ? AND ?'</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">'1'</span><span class="p">,</span> <span class="s1">'2'</span><span class="p">));</span>

<span class="c1">// 执行SQL: SELECT * FROM member WHERE group_id BETWEEN ? AND ?</span>
<span class="nv">$member</span> <span class="o">=</span> <span class="nv">$qb</span><span class="o">-&gt;</span><span class="na">find</span><span class="p">();</span>
</code></pre></div>

<h3>构造IN查询</h3>

<div class="highlight"><pre><code class="php"><span class="nv">$qb</span> <span class="o">=</span> <span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">db</span><span class="p">(</span><span class="s1">'member'</span><span class="p">)</span>
        <span class="o">-&gt;</span><span class="na">where</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
            <span class="s1">'id'</span> <span class="o">=&gt;</span> <span class="s1">'1'</span><span class="p">,</span>
            <span class="s1">'group_id'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s1">'1'</span><span class="p">,</span> <span class="s1">'2'</span><span class="p">)</span>
        <span class="p">));</span>

<span class="c1">// 执行SQL: SELECT * FROM member WHERE id = ? AND group_id IN (?, ?) LIMIT 1</span>
<span class="nv">$member</span> <span class="o">=</span> <span class="nv">$qb</span><span class="o">-&gt;</span><span class="na">find</span><span class="p">();</span>
</code></pre></div>

<h3>构造ORDER BY语句</h3>

<div class="highlight"><pre><code class="php"><span class="nv">$qb</span> <span class="o">=</span> <span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">db</span><span class="p">(</span><span class="s1">'member'</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">orderBy</span><span class="p">(</span><span class="s1">'id'</span><span class="p">,</span> <span class="s1">'ASC'</span><span class="p">);</span>

<span class="nv">$member</span> <span class="o">=</span> <span class="nv">$qb</span><span class="o">-&gt;</span><span class="na">find</span><span class="p">();</span>

<span class="c1">// 执行SQL: SELECT * FROM member ORDER BY id ASC LIMIT 1</span>
</code></pre></div>

<h3>增加ORDER BY语句</h3>

<div class="highlight"><pre><code class="php"><span class="nv">$qb</span> <span class="o">=</span> <span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">db</span><span class="p">(</span><span class="s1">'member'</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">orderBy</span><span class="p">(</span><span class="s1">'id'</span><span class="p">,</span> <span class="s1">'ASC'</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">addOrderBy</span><span class="p">(</span><span class="s1">'group_id'</span><span class="p">,</span> <span class="s1">'ASC'</span><span class="p">);</span>

<span class="nv">$member</span> <span class="o">=</span> <span class="nv">$query</span><span class="o">-&gt;</span><span class="na">find</span><span class="p">();</span>

<span class="c1">// 执行SQL: SELECT * FROM member ORDER BY id ASC, group_id ASC LIMIT 1</span>
</code></pre></div>

<h3>设置SELECT查询的字段</h3>

<div class="highlight"><pre><code class="php"><span class="nv">$qb</span> <span class="o">=</span> <span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">db</span><span class="p">(</span><span class="s1">'member'</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">select</span><span class="p">(</span><span class="s1">'id, group_id'</span><span class="p">);</span>

<span class="nv">$member</span> <span class="o">=</span> <span class="nv">$query</span><span class="o">-&gt;</span><span class="na">find</span><span class="p">();</span>

<span class="c1">// 执行SQL: SELECT id, group_id FROM member LIMIT 1</span>
</code></pre></div>

<h3>增加SELECT查询的字段</h3>

<div class="highlight"><pre><code class="php"><span class="nv">$qb</span> <span class="o">=</span> <span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">db</span><span class="p">(</span><span class="s1">'member'</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">select</span><span class="p">(</span><span class="s1">'id'</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">addSelect</span><span class="p">(</span><span class="s1">'group_id'</span><span class="p">);</span>

<span class="nv">$member</span> <span class="o">=</span> <span class="nv">$query</span><span class="o">-&gt;</span><span class="na">find</span><span class="p">();</span>

<span class="c1">// 执行SQL: SELECT id, group_id FROM member LIMIT 1</span>
</code></pre></div>

<h3>构造LIMIT和OFFSET语句</h3>

<div class="highlight"><pre><code class="php"><span class="nv">$qb</span> <span class="o">=</span> <span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">db</span><span class="p">(</span><span class="s1">'member'</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">limit</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>

<span class="c1">// 生成SQL: SELECT * FROM member LIMIT 2</span>
<span class="k">echo</span> <span class="nv">$qb</span><span class="o">-&gt;</span><span class="na">getSql</span><span class="p">();</span>

<span class="nv">$qb</span> <span class="o">=</span> <span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">db</span><span class="p">(</span><span class="s1">'member'</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">limit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">offset</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>

<span class="c1">// 生成SQL: SELECT * FROM member LIMIT 1 OFFSET 1</span>
<span class="k">echo</span> <span class="nv">$qb</span><span class="o">-&gt;</span><span class="na">getSql</span><span class="p">();</span>

<span class="nv">$qb</span> <span class="o">=</span> <span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">db</span><span class="p">(</span><span class="s1">'member'</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">limit</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">page</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>

<span class="c1">// 生成SQL: SELECT * FROM member LIMIT 3 OFFSET 6</span>
<span class="k">echo</span> <span class="nv">$qb</span><span class="o">-&gt;</span><span class="na">getSql</span><span class="p">();</span>
</code></pre></div>

<h3>构造GROUP BY语句</h3>

<div class="highlight"><pre><code class="php"><span class="nv">$qb</span> <span class="o">=</span> <span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">db</span><span class="p">(</span><span class="s1">'member'</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">groupBy</span><span class="p">(</span><span class="s1">'id, group_id'</span><span class="p">);</span>

<span class="c1">// 生成SQL: SELECT * FROM member GROUP BY id, group_id</span>
<span class="k">echo</span> <span class="nv">$qb</span><span class="o">-&gt;</span><span class="na">groupBy</span><span class="p">();</span>
</code></pre></div>

<h3>构造HAVING语句</h3>

<div class="highlight"><pre><code class="php"><span class="nv">$qb</span> <span class="o">=</span> <span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">db</span><span class="p">(</span><span class="s1">'member'</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">groupBy</span><span class="p">(</span><span class="s1">'id, group_id'</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">having</span><span class="p">(</span><span class="s1">'group_id &gt;= ?'</span><span class="p">,</span> <span class="s1">'1'</span><span class="p">);</span>

<span class="c1">// 生成SQL: SELECT * FROM member GROUP BY id, group_id HAVING group_id &gt;= ?</span>
<span class="k">echo</span> <span class="nv">$qb</span><span class="o">-&gt;</span><span class="na">getSql</span><span class="p">();</span>
</code></pre></div>

<h3>构造JOIN语句</h3>

<div class="highlight"><pre><code class="php"><span class="nv">$qb</span> <span class="o">=</span> <span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">db</span><span class="p">(</span><span class="s1">'member'</span><span class="p">)</span>
        <span class="o">-&gt;</span><span class="na">select</span><span class="p">(</span><span class="s1">'member.*, member_group.name AS group_name'</span><span class="p">)</span>
        <span class="o">-&gt;</span><span class="na">leftJoin</span><span class="p">(</span><span class="s1">'member_group'</span><span class="p">,</span> <span class="s1">'member_group.id = member.group_id'</span><span class="p">);</span>

<span class="c1">// 生成SQL: SELECT member.*, member_group.name AS group_name FROM member LEFT JOIN member_group ON member_group.id = member.group_id</span>
<span class="k">echo</span> <span class="nv">$qb</span><span class="o">-&gt;</span><span class="na">getSql</span><span class="p">();</span>
</code></pre></div>

<h3>重置已有的查询条件</h3>

<div class="highlight"><pre><code class="php"><span class="nv">$qb</span> <span class="o">=</span> <span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">db</span><span class="p">(</span><span class="s1">'member'</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">where</span><span class="p">(</span><span class="s1">'id = 1'</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">orderBy</span><span class="p">(</span><span class="s1">'id'</span><span class="p">,</span> <span class="s1">'DESC'</span><span class="p">);</span>

<span class="c1">// 生成SQL: SELECT * FROM member WHERE id = 1 ORDER BY id DESC</span>
<span class="k">echo</span> <span class="nv">$qb</span><span class="o">-&gt;</span><span class="na">getSql</span><span class="p">();</span>

<span class="nv">$qb</span><span class="o">-&gt;</span><span class="na">reset</span><span class="p">(</span><span class="s1">'where'</span><span class="p">);</span>

<span class="c1">// 生成SQL: SELECT * FROM member ORDER BY id DESC</span>
<span class="k">echo</span> <span class="nv">$qb</span><span class="o">-&gt;</span><span class="na">getSql</span><span class="p">();</span>
</code></pre></div>

<h3>使用<code>indexBy</code>控制返回二维数组的键名</h3>

<div class="highlight"><pre><code class="php"><span class="nv">$qb</span> <span class="o">=</span> <span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">db</span><span class="p">(</span><span class="s1">'member'</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">indexBy</span><span class="p">(</span><span class="s1">'name'</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">limit</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>

<span class="nv">$data</span> <span class="o">=</span> <span class="nv">$qb</span><span class="o">-&gt;</span><span class="na">fetchAll</span><span class="p">();</span>

<span class="c1">// 使用前,数组的键名是数字,从0开始</span>
<span class="nv">$data</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
    <span class="mi">0</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">'id'</span> <span class="o">=&gt;</span> <span class="s1">'1'</span><span class="p">,</span>
        <span class="s1">'name'</span> <span class="o">=&gt;</span> <span class="s1">'twin'</span><span class="p">,</span>
    <span class="p">),</span>
    <span class="mi">1</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">'id'</span> <span class="o">=&gt;</span> <span class="s1">'2'</span><span class="p">,</span>
        <span class="s1">'name'</span> <span class="o">=&gt;</span> <span class="s1">'test'</span>
    <span class="p">)</span>
<span class="p">);</span>

<span class="c1">// 使用后,数组的键名被替换为指定字段的值</span>
<span class="nv">$data</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">'twin'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">'id'</span> <span class="o">=&gt;</span> <span class="s1">'1'</span><span class="p">,</span>
        <span class="s1">'name'</span> <span class="o">=&gt;</span> <span class="s1">'twin'</span><span class="p">,</span>
    <span class="p">),</span>
    <span class="s1">'test'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">'id'</span> <span class="o">=&gt;</span> <span class="s1">'2'</span><span class="p">,</span>
        <span class="s1">'name'</span> <span class="o">=&gt;</span> <span class="s1">'test'</span>
    <span class="p">)</span>
<span class="p">);</span>
</code></pre></div>

<blockquote>
<h4>注意</h4>

<ol>
<li>
<code>indexBy</code>仅对<code>fetchAll</code>和<code>findAll</code>的返回值有作用,<code>execute</code>方法仍然返回原始的数组</li>
<li>如果字段的值重复,后面的值将覆盖前面的值</li>
</ol>
</blockquote>

<h2>调用方式</h2>

<h3>方法</h3>

<h4>db($table)</h4>

<p>根据数据表名称,创建一个新Query Builder对象</p>

<p><strong>返回:</strong> <code>QueryBuilder</code></p>

<h4>db-&gt;createQueryBuilder()</h4>

<p>创建一个新Query Builder对象</p>

<p><strong>返回:</strong> <code>QueryBuilder</code></p>

<h4>$qb-&gt;select($select = null)</h4>

<p>设置SELECT字句要查询的字段名称</p>

<p><strong>返回:</strong> <code>QueryBuilder</code></p>

<h4>$qb-&gt;addSelect($select = null)</h4>

<p>增加SELECT子句要查询的字段名称</p>

<p><strong>返回:</strong> <code>QueryBuilder</code></p>

<h4>$qb-&gt;delete($table = null)</h4>

<p>设置SQL语句为DELETE操作</p>

<p><strong>返回:</strong> <code>QueryBuilder</code></p>

<h4>$qb-&gt;update($table = null)</h4>

<p>设置SQL语句为UPDATE操作</p>

<p><strong>返回:</strong> <code>QueryBuilder</code></p>

<h4>$qb-&gt;from($table)</h4>

<p>设置<code>FROM</code>字句的数据表名称</p>

<p><strong>返回:</strong> <code>QueryBuilder</code></p>

<h4>$qb-&gt;where($conditions, $params = null, $types = array())</h4>

<p>设置<code>WHERE</code>查询条件</p>

<p><strong>返回:</strong> <code>QueryBuilder</code></p>

<p><strong>参数</strong></p>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>$conditions</td>
<td>string</td>
<td>查询条件,如<code>id = 1</code>, <code>id = ?</code>
</td>
</tr>
<tr>
<td>$params</td>
<td>array</td>
<td>参数的值</td>
</tr>
<tr>
<td>$types</td>
<td>array</td>
<td>参数的类型</td>
</tr>
</tbody>
</table><h4>$qb-&gt;andWhere($conditions, $params = null, $types = array())</h4>

<p>增加<code>AND</code>类型的<code>WHERE</code>条件到当前查询中</p>

<p><strong>返回:</strong> <code>QueryBuilder</code></p>

<p><strong>参数</strong></p>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>$conditions</td>
<td>string</td>
<td>查询条件,如<code>id = 1</code>, <code>id = ?</code>
</td>
</tr>
<tr>
<td>$params</td>
<td>array</td>
<td>参数的值</td>
</tr>
<tr>
<td>$types</td>
<td>array</td>
<td>参数的类型</td>
</tr>
</tbody>
</table><h4>$qb-&gt;orWhere($conditions, $params = null, $types = array())</h4>

<p>增加<code>OR</code>类型的<code>WHERE</code>条件到当前查询中</p>

<p><strong>返回:</strong> <code>QueryBuilder</code></p>

<p><strong>参数</strong></p>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>$conditions</td>
<td>string</td>
<td>查询条件,如<code>id = 1</code>, <code>id = ?</code>
</td>
</tr>
<tr>
<td>$params</td>
<td>array</td>
<td>参数的值</td>
</tr>
<tr>
<td>$types</td>
<td>array</td>
<td>参数的类型</td>
</tr>
</tbody>
</table><h4>$qb-&gt;orderBy($sort, $order = 'ASC')</h4>

<p>设置<code>ORDER BY</code>字句</p>

<p><strong>返回:</strong> <code>QueryBuilder</code></p>

<p><strong>参数</strong></p>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>$sort</td>
<td>string</td>
<td>排序的字段名称</td>
</tr>
<tr>
<td>$order</td>
<td>string</td>
<td>排序类型,<code>ASC</code>或<code>DESC</code>
</td>
</tr>
</tbody>
</table><h4>$qb-&gt;addOrderBy($sort, $order = 'ASC')</h4>

<p>添加<code>ORDER BY</code>字句到当前查询中</p>

<p><strong>返回:</strong> <code>QueryBuilder</code></p>

<p><strong>参数</strong></p>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>$sort</td>
<td>string</td>
<td>排序的字段名称</td>
</tr>
<tr>
<td>$order</td>
<td>string</td>
<td>排序类型,<code>ASC</code>或<code>DESC</code>
</td>
</tr>
</tbody>
</table><h4>$qb-&gt;offset($offset)</h4>

<p>设置<code>OFFSET</code>字句</p>

<p><strong>返回:</strong> <code>QueryBuilder</code></p>

<p><strong>参数</strong></p>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr></thead>
<tbody><tr>
<td>$offset</td>
<td>int</td>
<td>
<code>OFFSET</code>字句的值,如0,10</td>
</tr></tbody>
</table><h4>$qb-&gt;limit($limit)</h4>

<p>设置<code>LIMIT</code>字句</p>

<p><strong>返回:</strong> <code>QueryBuilder</code></p>

<p><strong>参数</strong></p>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr></thead>
<tbody><tr>
<td>$limit</td>
<td>int</td>
<td>
<code>LIMIT</code>字句的值,如0,10</td>
</tr></tbody>
</table><h4>$qb-&gt;page($page)</h4>

<p>设置<code>OFFSET</code>和<code>LIMIT</code>字句</p>

<p>通过该方法设置<code>$page</code>的值之后,<code>OFFSET</code>的值等于<code>($page - 1) * $limit</code>,如果<code>$limit</code>为空,<code>$limit</code>会被设置为<code>10</code></p>

<p><strong>返回:</strong> <code>QueryBuilder</code></p>

<p><strong>参数</strong></p>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr></thead>
<tbody><tr>
<td>$page</td>
<td>int</td>
<td>当前在第几页</td>
</tr></tbody>
</table><h4>$qb-&gt;join($table, $on = null)</h4>

<p>增加<code>INNER JOIN</code>字句到当前查询中</p>

<p><strong>返回:</strong> <code>QueryBuilder</code></p>

<p><strong>参数</strong></p>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>$table</td>
<td>string</td>
<td>要连接的数据表名称,如<code>userGroup</code>
</td>
</tr>
<tr>
<td>$on</td>
<td>string</td>
<td>连接的关联条件,如<code>user.groupId = userGroup.id</code>
</td>
</tr>
</tbody>
</table><h4>$qb-&gt;innerJoin($table, $on = null)</h4>

<p>同上,增加<code>INNER JOIN</code>字句到当前查询中</p>

<h4>$qb-&gt;leftJoin($table, $on = null)</h4>

<p>增加<code>LEFT JOIN</code>字句到当前查询中</p>

<p><strong>返回:</strong> <code>QueryBuilder</code></p>

<p><strong>参数</strong></p>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>$table</td>
<td>string</td>
<td>要连接的数据表名称,如<code>userGroup</code>
</td>
</tr>
<tr>
<td>$on</td>
<td>string</td>
<td>连接的关联条件,如<code>user.groupId = userGroup.id</code>
</td>
</tr>
</tbody>
</table><h4>$qb-&gt;rightJoin($table, $on = null)</h4>

<p>增加<code>RIGHT JOIN</code>字句到当前查询中</p>

<p><strong>返回:</strong> <code>QueryBuilder</code></p>

<p><strong>参数</strong></p>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>$table</td>
<td>string</td>
<td>要连接的数据表名称,如<code>userGroup</code>
</td>
</tr>
<tr>
<td>$on</td>
<td>string</td>
<td>连接的关联条件,如<code>user.groupId = userGroup.id</code>
</td>
</tr>
</tbody>
</table><h4>$qb-&gt;groupBy($groupBy)</h4>

<p>设置<code>GROUP BY</code>字句</p>

<p><strong>返回:</strong> <code>QueryBuilder</code></p>

<p><strong>参数</strong></p>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr></thead>
<tbody><tr>
<td>$groupBy</td>
<td>string</td>
<td>
<code>GROUP BY</code>字句的值</td>
</tr></tbody>
</table><h4>$qb-&gt;addGroupBy($groupBy)</h4>

<p>添加<code>GROUP BY</code>字句到当前查询中</p>

<p><strong>返回:</strong> <code>QueryBuilder</code></p>

<p><strong>参数</strong></p>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr></thead>
<tbody><tr>
<td>$groupBy</td>
<td>string</td>
<td>
<code>GROUP BY</code>字句的值</td>
</tr></tbody>
</table><h4>$qb-&gt;having($conditions, $params = array(), $types = array())</h4>

<p>设置<code>HAVING</code>字句</p>

<p><strong>返回:</strong> <code>QueryBuilder</code></p>

<p><strong>参数</strong></p>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>$conditions</td>
<td>string</td>
<td>查询条件,如<code>id = 1</code>, <code>id = ?</code>
</td>
</tr>
<tr>
<td>$params</td>
<td>array</td>
<td>参数的值</td>
</tr>
<tr>
<td>$types</td>
<td>array</td>
<td>参数的类型</td>
</tr>
</tbody>
</table><h4>$qb-&gt;andHaving($conditions, $params = array(), $types = array())</h4>

<p>添加<code>AND</code>类型<code>HAVING</code>字句到当前查询中</p>

<p><strong>返回:</strong> <code>QueryBuilder</code></p>

<p><strong>参数</strong></p>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>$conditions</td>
<td>string</td>
<td>查询条件,如<code>id = 1</code>, <code>id = ?</code>
</td>
</tr>
<tr>
<td>$params</td>
<td>array</td>
<td>参数的值</td>
</tr>
<tr>
<td>$types</td>
<td>array</td>
<td>参数的类型</td>
</tr>
</tbody>
</table><h4>$qb-&gt;orHaving($conditions, $params = array(), $types = array())</h4>

<p>添加<code>OR</code>类型的<code>HAVING</code>字句到当前查询中</p>

<p><strong>返回:</strong> <code>QueryBuilder</code></p>

<p><strong>参数</strong></p>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>$conditions</td>
<td>string</td>
<td>查询条件,如<code>id = 1</code>, <code>id = ?</code>
</td>
</tr>
<tr>
<td>$params</td>
<td>array</td>
<td>参数的值</td>
</tr>
<tr>
<td>$types</td>
<td>array</td>
<td>参数的类型</td>
</tr>
</tbody>
</table><h4>$qb-&gt;indexBy($column)</h4>

<p>控制返回二维数组的键名为指定字段的值</p>

<p><strong>返回:</strong> <code>QueryBuilder</code></p>

<p><strong>参数</strong></p>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr></thead>
<tbody><tr>
<td>$column</td>
<td>string</td>
<td>字段的名称,必须存在select语句中</td>
</tr></tbody>
</table><h4>$qb-&gt;reset($queryPartName)</h4>

<p>重置某一部分SQL字句</p>

<p><strong>返回:</strong> <code>QueryBuilder</code></p>

<p><strong>参数</strong></p>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr></thead>
<tbody><tr>
<td>$queryPartName</td>
<td>string</td>
<td>允许的值为<code>select</code>,<code>from</code>,<code>join</code>,<code>set</code>,<code>where</code>,<code>groupBy</code>,<code>having</code>,<code>orderBy</code>,<code>limit</code>或<code>offset</code>
</td>
</tr></tbody>
</table><h4>$qb-&gt;resetAll($queryPartNames = null)</h4>

<p>重置某一部分或全部SQL字句</p>

<p><strong>返回:</strong> <code>QueryBuilder</code></p>

<p><strong>参数</strong></p>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr></thead>
<tbody><tr>
<td>$queryPartNames</td>
<td>null</td>
<td>array</td>
</tr></tbody>
</table><h4>$qb-&gt;find()</h4>

<p>执行构造的SQL语句,并返回一个<code>Record</code>对象,如果结果为空,返回<code>false</code></p>

<p><strong>返回:</strong> <code>Record</code>|<code>false</code></p>

<h4>$qb-&gt;findAll()</h4>

<p>执行构造的SQL语句,并返回一个<code>Collection</code>对象</p>

<p><strong>返回:</strong> <code>Collection</code></p>

<h4>$qb-&gt;fetch()</h4>

<p>执行构造的SQL语句,并返回一个一维数组,如果结果为空,返回<code>false</code></p>

<p><strong>返回:</strong> <code>array</code>|<code>false</code></p>

<h4>$qb-&gt;fetchAll()</h4>

<p>执行构造的SQL语句,并返回一个二维数组,如果结果为空,返回<code>false</code></p>

<p><strong>返回:</strong> <code>array</code>|<code>false</code></p>

<h4>$qb-&gt;count()</h4>

<p>获取当前构造的SQL语句所查找到的行数</p>

<p><strong>返回:</strong> <code>int</code></p>

<h4>$qb-&gt;setParameter($key, $value, $type = null)</h4>

<p>设置绑定参数的值和类型</p>

<p><strong>返回:</strong> <code>QueryBuilder</code></p>

<p><strong>参数</strong></p>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>$key</td>
<td>string</td>
<td>参数的名称,对于使用命名占位符的预处理语句，应是类似 :name 形式的参数名。对于使用问号占位符的预处理语句，应是以1开始索引的参数位置。</td>
</tr>
<tr>
<td>$value</td>
<td>mixed</td>
<td>参数的值</td>
</tr>
<tr>
<td>$type</td>
<td>int</td>
<td>参数的类型,使用 PDO::PARAM_* 常量明确地指定参数的类型</td>
</tr>
</tbody>
</table><p>相关链接: <a href="http://php.net/manual/zh/pdostatement.bindvalue.php" target="_blank">http://php.net/manual/zh/pdostatement.bindvalue.php</a></p>

<h4>$qb-&gt;setParameters(array $params, array $types = array())</h4>

<p>设置多个绑定参数的值和类型</p>

<p><strong>返回:</strong> <code>QueryBuilder</code></p>

<h4>$qb-&gt;getParameter($key)</h4>

<p>获取绑定参数的值</p>

<p><strong>返回:</strong> <code>mixed</code></p>

<h4>$qb-&gt;getParameters()</h4>

<p>获取所有绑定参数的值</p>

<p><strong>返回:</strong> <code>array</code></p>

<h4>$qb-&gt;getTable()</h4>

<p>获取当前查询的数据表名称</p>

<p><strong>返回:</strong> <code>string</code></p>

<h4>$qb-&gt;getSql()</h4>

<p>获取当前查询的完整SQL语句</p>

<p><strong>返回:</strong> <code>string</code></p>
  </section>

<!-- api/activeRecord
  ================================================== -->
  <section id="activeRecord">
  <div class="page-header"><h1>Active Record</h1></div>

<div class="page-header"><h1>案例</h1></div>

<h3>创建一条新记录并保存</h3>

<div class="highlight"><pre><code class="php"><span class="c1">// 通过`create`方法创建一个新的用户记录对象</span>
<span class="cm">/* @var $user \Widget\Db\Record */</span>
<span class="nv">$user</span> <span class="o">=</span> <span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">db</span><span class="o">-&gt;</span><span class="na">create</span><span class="p">(</span><span class="s1">'user'</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">'groupId'</span> <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">));</span>

<span class="c1">// 设置对象的值</span>
<span class="nv">$user</span><span class="o">-&gt;</span><span class="na">username</span> <span class="o">=</span> <span class="s1">'twin'</span><span class="p">;</span>
<span class="nv">$user</span><span class="o">-&gt;</span><span class="na">createdAt</span> <span class="o">=</span> <span class="nb">date</span><span class="p">(</span><span class="s1">'Y-m-d H:i:s'</span><span class="p">);</span>

<span class="c1">// 保存到数据库中</span>
<span class="nv">$user</span><span class="o">-&gt;</span><span class="na">save</span><span class="p">();</span>
</code></pre></div>

<h3>查找并更新记录数据</h3>

<div class="highlight"><pre><code class="php"><span class="c1">// 查找主键为1的用户</span>
<span class="nv">$user</span> <span class="o">=</span> <span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">db</span><span class="o">-&gt;</span><span class="na">find</span><span class="p">(</span><span class="s1">'user'</span><span class="p">,</span> <span class="s1">'1'</span><span class="p">);</span>

<span class="c1">// 或是通过魔术方法更自然地获取对象</span>
<span class="nv">$user</span> <span class="o">=</span> <span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">db</span><span class="o">-&gt;</span><span class="na">user</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>

<span class="c1">// 更新对象的值</span>
<span class="nv">$user</span><span class="o">-&gt;</span><span class="na">username</span> <span class="o">=</span> <span class="s1">'twin'</span><span class="p">;</span>

<span class="c1">// 保存到数据库中</span>
<span class="nv">$user</span><span class="o">-&gt;</span><span class="na">save</span><span class="p">();</span>
</code></pre></div>

<h3>删除记录</h3>

<div class="highlight"><pre><code class="php"><span class="c1">// 查找主键为1的用户</span>
<span class="nv">$user</span> <span class="o">=</span> <span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">db</span><span class="o">-&gt;</span><span class="na">user</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>

<span class="c1">// 删除该记录</span>
<span class="nv">$user</span><span class="o">-&gt;</span><span class="na">delete</span><span class="p">();</span>
</code></pre></div>

<h3>回调调用顺序</h3>

<h4>创建新记录并保存</h4>

<ul>
<li>afterLoad</li>
<li>beforeSave</li>
<li>beforeInsert</li>
<li>afterInsert</li>
<li>afterSave</li>
</ul><h4>更新已有记录并保存</h4>

<ul>
<li>afterLoad</li>
<li>beforeSave</li>
<li>beforeUpdate</li>
<li>afterUpdate</li>
<li>afterSave</li>
</ul><h4>删除记录</h4>

<ul>
<li>afterLoad</li>
<li>beforeDelete</li>
<li>afterDelete</li>
</ul><h2>调用方式</h2>

<h3>属性</h3>

<h4>Widget\Db $db</h4>

<p>数据库连接对象</p>

<h4>Widget\Widget $widget</h4>

<p>对象管理器</p>

<h3>回调</h3>

<h4>afterLoad($record, $widget)</h4>

<p>加载记录后触发的回调</p>

<h4>beforeSave($record, $widget)</h4>

<p>保存记录前触发的回调</p>

<h4>afterSave($record, $widget)</h4>

<p>保存记录后触发的回调</p>

<h4>beforeInsert($record, $widget)</h4>

<p>插入记录到数据库前触发的回调</p>

<h4>afterInsert($record, $widget)</h4>

<p>插入记录到数据库后触发的回调</p>

<h4>beforeUpdate($record, $widget)</h4>

<p>更新记录到数据库前触发的回调</p>

<h4>afterUpdate($record, $widget)</h4>

<p>更新记录到数据库后触发的回调</p>

<h4>beforeDelete($record, $widget)</h4>

<p>删除记录前触发的回调</p>

<h4>afterDelete($record, $widget)</h4>

<p>删除记录后触发的回调</p>

<h3>方法</h3>

<h4>$record-&gt;getTable()</h4>

<p>获取数据表名称</p>

<h4>$record-&gt;setTable($table)</h4>

<p>设置数据表名称</p>

<h4>$record-&gt;setPrimaryKey($primaryKey)</h4>

<p>设置主键字段的名称</p>

<h4>$record-&gt;getPrimaryKey()</h4>

<p>获取主键字段的名称</p>

<h4>$record-&gt;toArray()</h4>

<p>以数组形式返回记录里的数据</p>

<h4>$record-&gt;toJson()</h4>

<p>以JSON字符串形式返回记录里的数据</p>

<h4>$record-&gt;fromArray($data)</h4>

<p>批量设置记录数据</p>

<h4>$record-&gt;setData($data)</h4>

<p>批量设置记录数据,同<code>fromArray</code></p>

<h4>$record-&gt;save()</h4>

<p>保存记录数据到数据库中</p>

<h4>$record-&gt;delete()</h4>

<p>从数据库中删除该记录数据</p>

<h4>$record-&gt;remove($field)</h4>

<p>删除指定字段的值</p>

<h4>$record-&gt;isNew()</h4>

<p>判断当前记录是否为新建,并且未保存到数据库</p>

<h4>$record-&gt;isModified()</h4>

<p>判断当前记录的字段值是否修改过</p>

<h3>动态属性和方法</h3>

<h4>$record-&gt;$field</h4>

<p>获取字段的值</p>

<h4>$record-&gt;$field = 'xxx'</h4>

<p>设置字段的值</p>

<h4>unset($record-&gt;$field)</h4>

<p>删除字段的值</p>

<h3>数组操作方式</h3>

<h4>$record[$field]</h4>

<p>获取字段的值</p>

<h4>$record[$field] = 'xxx'</h4>

<p>设置字段的值</p>
  </section>

<!-- api/call
  ================================================== -->
  <section id="call">
  <div class="page-header"><h1>Call</h1></div>

<p>象<a href="http://api.jquery.com/jQuery.ajax/" target="_blank">jQuery Ajax</a>一样调用您的接口</p>

<h2>案例</h2>

<h3>一个完整的例子:获取公开的gists列表</h3>

<div class="highlight"><pre><code class="php"><span class="nv">$call</span> <span class="o">=</span> <span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">call</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
    <span class="c1">// 设置请求的URL地址</span>
    <span class="s1">'url'</span> <span class="o">=&gt;</span> <span class="s1">'https://api.github.com/gists'</span><span class="p">,</span>
    <span class="c1">// 默认请求方式为GET,可以设置为POST,PUT等</span>
    <span class="s1">'method'</span> <span class="o">=&gt;</span> <span class="s1">'GET'</span><span class="p">,</span>
    <span class="c1">// 自动解析返回数据为JSON数组</span>
    <span class="s1">'dataType'</span> <span class="o">=&gt;</span> <span class="s1">'json'</span><span class="p">,</span>
    <span class="c1">// 设置发送的参数</span>
    <span class="s1">'data'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">'time'</span> <span class="o">=&gt;</span> <span class="nb">time</span><span class="p">(),</span>
    <span class="p">),</span>
<span class="p">));</span>

<span class="k">if</span> <span class="p">(</span><span class="nv">$call</span><span class="o">-&gt;</span><span class="na">isSuccess</span><span class="p">())</span> <span class="p">{</span>
    <span class="c1">// 输出第一条的地址,如https://api.github.com/gists/xxxxxxx</span>
    <span class="nb">var_dump</span><span class="p">(</span><span class="nv">$call</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">'url'</span><span class="p">]);</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="c1">// 输出错误的类型,如`curl`,完全错误类型请查看选项</span>
    <span class="nb">var_dump</span><span class="p">(</span><span class="nv">$call</span><span class="o">-&gt;</span><span class="na">getErrorStatus</span><span class="p">());</span>

    <span class="c1">// 输出异常的信息,如`Couldn't resolve host '404.php.net'`</span>
    <span class="nb">var_dump</span><span class="p">(</span><span class="nv">$call</span><span class="o">-&gt;</span><span class="na">getErrorException</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">getMessage</span><span class="p">());</span>
<span class="p">}</span>
</code></pre></div>

<h3>指定请求域名的IP地址:通过指向不同的IP地址,访问不同的环境</h3>

<div class="highlight"><pre><code class="php"><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">call</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
    <span class="s1">'url'</span> <span class="o">=&gt;</span> <span class="s1">'http://google.com'</span><span class="p">,</span>
    <span class="s1">'ip'</span> <span class="o">=&gt;</span> <span class="s1">'74.125.128.105'</span><span class="p">,</span> <span class="c1">// 线上运营环境</span>
    <span class="c1">//'ip' =&gt; '127.0.0.1', // 本地开发环境</span>
<span class="p">));</span>
</code></pre></div>

<h3>通过切换IP地址实现负载均衡</h3>

<div class="highlight"><pre><code class="php"><span class="nv">$call</span> <span class="o">=</span> <span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">call</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
    <span class="s1">'url'</span> <span class="o">=&gt;</span> <span class="s1">'http://google.com'</span><span class="p">,</span>
    <span class="c1">// 随机使用其中一个IP地址</span>
    <span class="s1">'ip'</span> <span class="o">=&gt;</span> <span class="nb">array_rand</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
        <span class="s1">'74.125.128.147'</span><span class="p">,</span>
        <span class="s1">'74.125.128.105'</span>
    <span class="p">))</span>
<span class="p">));</span>
</code></pre></div>

<h3>自动设置请求地址为referer地址</h3>

<div class="highlight"><pre><code class="php"><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">call</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
    <span class="s1">'url'</span> <span class="o">=&gt;</span> <span class="s1">'http://google.com'</span><span class="p">,</span>
    <span class="s1">'referer'</span> <span class="o">=&gt;</span> <span class="k">true</span>
<span class="p">));</span>

<span class="c1">// referer等于true时,相当于`url`的值</span>

<span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">call</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
    <span class="s1">'url'</span> <span class="o">=&gt;</span> <span class="s1">'http://google.com'</span><span class="p">,</span>
    <span class="s1">'referer'</span> <span class="o">=&gt;</span> <span class="s1">'http://google.com'</span><span class="p">,</span>
<span class="p">));</span>
</code></pre></div>

<h3>通过HTTP方法发送请求</h3>

<p>此处的<code>get</code>还可以是<code>post</code>, <code>delete</code>, <code>put</code>或<code>patch</code>,表示通过相应的HTTP方法发送请求</p>

<div class="highlight"><pre><code class="php"><span class="nv">$call</span> <span class="o">=</span> <span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">call</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">'http://example.com'</span><span class="p">,</span> <span class="nv">$data</span><span class="p">);</span>
</code></pre></div>

<h3>通过<code>curlOptions</code>选项设置cURL会话选项</h3>

<p>call服务基于cURL实现,所有的cURL的会话选项都可以通过<code>curlOptions</code>批量设置.</p>

<p>如设置请求代理:</p>

<div class="highlight"><pre><code class="php"><span class="nv">$call</span> <span class="o">=</span> <span class="nv">$wei</span><span class="o">-&gt;</span><span class="na">call</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
    <span class="s1">'url'</span> <span class="o">=&gt;</span> <span class="s1">'http://www.google.com/'</span><span class="p">,</span>
    <span class="s1">'curlOptions'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="nx">CURLOPT_PROXY</span> <span class="o">=&gt;</span> <span class="s1">'192.168.18.1:8087'</span><span class="p">,</span>
    <span class="p">)</span>
<span class="p">));</span>
</code></pre></div>

<h3>通过回调方法记录请求日志</h3>

<p>Call对象提供了<code>beforeSend</code>, <code>success</code>, <code>error</code>, <code>complete</code>四个回调方法,可以用来记录日志,上报请求耗时等.</p>

<div class="highlight"><pre><code class="php"><span class="nx">wei</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
    <span class="s1">'call'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="c1">// cURL请求发送前的回调,记录请求的方式和地址参数</span>
        <span class="s1">'beforeSend'</span> <span class="o">=&gt;</span> <span class="k">function</span> <span class="p">(</span><span class="nx">\Widget\Call</span> <span class="nv">$call</span><span class="p">,</span> <span class="nv">$ch</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">wei</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">logger</span><span class="o">-&gt;</span><span class="na">debug</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
                <span class="s1">'Request URL'</span>       <span class="o">=&gt;</span> <span class="nv">$call</span><span class="o">-&gt;</span><span class="na">getUrl</span><span class="p">(),</span>
                <span class="s1">'Request Method'</span>    <span class="o">=&gt;</span> <span class="nv">$call</span><span class="o">-&gt;</span><span class="na">getMethod</span><span class="p">(),</span>
                <span class="s1">'Parameters'</span>        <span class="o">=&gt;</span> <span class="nv">$call</span><span class="o">-&gt;</span><span class="na">getData</span><span class="p">(),</span>
            <span class="p">));</span>
        <span class="p">},</span>
        <span class="c1">// cURL请求发送成功的回调</span>
        <span class="s1">'success'</span> <span class="o">=&gt;</span> <span class="k">function</span> <span class="p">(</span><span class="nv">$data</span><span class="p">,</span> <span class="nx">\Widget\Call</span> <span class="nv">$call</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// 按需记录</span>
        <span class="p">},</span>
        <span class="c1">// cURL请求发送失败的回调,记录错误原因和异常堆栈</span>
        <span class="s1">'error'</span> <span class="o">=&gt;</span> <span class="k">function</span> <span class="p">(</span><span class="nx">\Widget\Call</span> <span class="nv">$call</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">wei</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">logger</span><span class="o">-&gt;</span><span class="na">error</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
                <span class="s1">'Error status'</span>  <span class="o">=&gt;</span> <span class="nv">$call</span><span class="o">-&gt;</span><span class="na">getErrorStatus</span><span class="p">(),</span>
                <span class="s1">'Exception'</span>     <span class="o">=&gt;</span> <span class="p">(</span><span class="nx">string</span><span class="p">)</span><span class="nv">$call</span><span class="o">-&gt;</span><span class="na">getErrorException</span><span class="p">(),</span>
            <span class="p">));</span>
        <span class="p">},</span>
        <span class="c1">// cURL请求发送完成的回调,记录返回状态码,花费时间等</span>
        <span class="s1">'complete'</span> <span class="o">=&gt;</span> <span class="k">function</span> <span class="p">(</span><span class="nx">\Widget\Call</span> <span class="nv">$call</span><span class="p">,</span> <span class="nv">$ch</span><span class="p">)</span> <span class="p">{</span>
            <span class="nv">$curlInfo</span> <span class="o">=</span> <span class="nb">curl_getinfo</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>

            <span class="nx">wei</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">logger</span><span class="o">-&gt;</span><span class="na">debug</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
                <span class="s1">'Status Code'</span> <span class="o">=&gt;</span> <span class="nv">$curlInfo</span><span class="p">[</span><span class="s1">'http_code'</span><span class="p">],</span>
                <span class="s1">'Server IP'</span>     <span class="o">=&gt;</span> <span class="nv">$call</span><span class="o">-&gt;</span><span class="na">getIp</span><span class="p">()</span> <span class="o">?:</span> <span class="s1">'(Not specified)'</span><span class="p">,</span>
                <span class="s1">'Total Time'</span>    <span class="o">=&gt;</span> <span class="nv">$curlInfo</span><span class="p">[</span><span class="s1">'total_time'</span><span class="p">]</span> <span class="o">.</span> <span class="s1">'s'</span><span class="p">,</span>
                <span class="s1">'Response Body'</span> <span class="o">=&gt;</span> <span class="nv">$call</span><span class="o">-&gt;</span><span class="na">getResponse</span><span class="p">(),</span>
            <span class="p">));</span>
        <span class="p">}</span>
    <span class="p">)</span>
<span class="p">));</span>
</code></pre></div>

<h3>禁用SSL证书验证</h3>

<p>在开发环境中,如果我们未安装SSL证书,访问HTTPS网站会提示如下错误.</p>

<blockquote>
<p>curl SSL certificate problem, verify that the CA cert is OK. Details: error:14090086:SSL routines:SSL3_GET_SERVER_CERTIFICATE:certificate verify failed</p>
</blockquote>

<p>我们可以设置cURL的<code>CURLOPT_SSL_VERIFYPEER</code>选项来禁用SSL证书验证.当然该方法不建议在正式环境使用.</p>

<div class="highlight"><pre><code class="php"><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">call</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
    <span class="s1">'url'</span> <span class="o">=&gt;</span> <span class="s1">'https://api.github.com/gists'</span><span class="p">,</span>
    <span class="s1">'curlOptions'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="nx">CURLOPT_SSL_VERIFYPEER</span> <span class="o">=&gt;</span> <span class="k">false</span>
    <span class="p">)</span>
<span class="p">));</span>
</code></pre></div>

<p>扩展阅读:</p>

<p>在PHP中使用cURL来访问受SSL/TLS保护的网站</p>

<p><a href="http://unitstep.net/blog/2009/05/05/using-curl-in-php-to-access-https-ssltls-protected-sites/" target="_blank">http://unitstep.net/blog/2009/05/05/using-curl-in-php-to-access-https-ssltls-protected-sites/</a></p>

<p>StackOverflow上关于该问题的讨论和解决方法</p>

<p><a href="http://stackoverflow.com/questions/6400300/php-curl-https-causing-exception-ssl-certificate-problem-verify-that-the-ca-cer" target="_blank">http://stackoverflow.com/questions/6400300/php-curl-https-causing-exception-ssl-certificate-problem-verify-that-the-ca-cer</a></p>

<h2>调用方式</h2>

<h3>选项</h3>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>url</td>
<td>string</td>
<td>无</td>
<td>请求的URL地址</td>
</tr>
<tr>
<td>method</td>
<td>string</td>
<td>GET</td>
<td>HTTP的请求方式,可以是<code>GET</code>, <code>POST</code>, <code>DELETE</code>, <code>PUT</code>, <code>PATCH</code>或任意其他服务器支持的方式</td>
</tr>
<tr>
<td>contentType</td>
<td>string</td>
<td>application/x-www-form-urlencoded; charset=UTF-8</td>
<td>HTTP请求头内容类型</td>
</tr>
<tr>
<td>cookies</td>
<td>array</td>
<td>array()</td>
<td>cookie数组,key是cookie的名称,value是cookie的值,cookie的值只能是字符串</td>
</tr>
<tr>
<td>data</td>
<td>array,string</td>
<td>array()</td>
<td>要发送到服务器的数据</td>
</tr>
<tr>
<td>global</td>
<td>bool</td>
<td>true</td>
<td>是否使用全局配置选项</td>
</tr>
<tr>
<td>headers</td>
<td>array</td>
<td>array</td>
<td>要发送的HTTP头</td>
</tr>
<tr>
<td>ip</td>
<td>string</td>
<td>无</td>
<td>要请求的URL地址中域名的IP地址,注意不是您的服务器IP地址</td>
</tr>
<tr>
<td>timeout</td>
<td>int</td>
<td>0</td>
<td>整个请求的最大运行时间,单位是毫秒,默认是无限制</td>
</tr>
<tr>
<td>dataType</td>
<td>string</td>
<td>text</td>
<td>请求完成后,要对返回数据解析的类型,可以是<code>json</code>(数组),<code>jsonObject</code>,<code>xml</code>,<code>query</code>,<code>serialize</code>和<code>text</code>
</td>
</tr>
<tr>
<td>referer</td>
<td>string</td>
<td>无</td>
<td>请求HTTP头中的referer值</td>
</tr>
<tr>
<td>userAgent</td>
<td>string</td>
<td>无</td>
<td>请求HTTP头中的userAgent值</td>
</tr>
<tr>
<td>curlOptions</td>
<td>array</td>
<td>array()</td>
<td>批量设置cURL会话的选项,供<code>curl_setopt_array</code>函数调用</td>
</tr>
<tr>
<td>beforeSend</td>
<td>callable</td>
<td>无</td>
<td>在发送请求前触发的回调,可通过该回调更改任意配置</td>
</tr>
<tr>
<td>success</td>
<td>callable</td>
<td>无</td>
<td>请求并解析数据成功后触发的回调</td>
</tr>
<tr>
<td>error</td>
<td>callable</td>
<td>无</td>
<td>请求或解析失败后触发的回调,可用于记录日志,展示错误信息等</td>
</tr>
<tr>
<td>complete</td>
<td>callable</td>
<td>无</td>
<td>请求完成后,不论是否成功都触发的回调,可用于数据记录等</td>
</tr>
</tbody>
</table><h3>回调</h3>

<h4>beforeSend($call, $ch)</h4>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>$call</td>
<td>Widget\Call</td>
<td>当前的Call对象</td>
</tr>
<tr>
<td>$ch</td>
<td>resource</td>
<td>cUrl会话的变量</td>
</tr>
</tbody>
</table><h4>success($data, $call)</h4>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>$data</td>
<td>mixed</td>
<td>解析过的HTTP响应数据,数据类型与<code>dataType</code>选项相关,如下表所示</td>
</tr>
<tr>
<td>$call</td>
<td>\Widget\Call</td>
<td>当前的Call对象</td>
</tr>
</tbody>
</table><h5>
<code>dataType</code>的值与$data返回的类型</h5>

<table class="table table-bordered table-striped">
<thead><tr>
<th>dataType</th>
<th>返回数据类型</th>
</tr></thead>
<tbody>
<tr>
<td>json</td>
<td>array</td>
</tr>
<tr>
<td>jsonObject</td>
<td>stdClass</td>
</tr>
<tr>
<td>xml</td>
<td>SimpleXMLElement</td>
</tr>
<tr>
<td>query</td>
<td>array</td>
</tr>
<tr>
<td>serialize</td>
<td>任意PHP合法类型</td>
</tr>
<tr>
<td>text</td>
<td>string</td>
</tr>
</tbody>
</table><h4>error($call, $textStatus, $exception)</h4>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>$call</td>
<td>Widget\Call</td>
<td>当前的Call对象</td>
</tr>
<tr>
<td>$textStatus</td>
<td>string</td>
<td>简单的错误说明,可能出现的值及出现情况如下表</td>
</tr>
<tr>
<td>$exception</td>
<td>Exception</td>
<td>错误的异常对象,可通过该对象获取详细的错误信息</td>
</tr>
</tbody>
</table><h5>
<code>$textStatus</code>的值与出现的情况</h5>

<table class="table table-bordered table-striped">
<thead><tr>
<th>值</th>
<th>出现情况</th>
</tr></thead>
<tbody>
<tr>
<td>curl</td>
<td>cURL内部错误,如无法解析域名IP地址</td>
</tr>
<tr>
<td>http</td>
<td>HTTP状态码错误,如404页面不存在,500内部错误</td>
</tr>
<tr>
<td>parser</td>
<td>数据解析错误,如返回的数据不是正确的json格式</td>
</tr>
</tbody>
</table><h4>complete($call, $ch)</h4>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>$call</td>
<td>Widget\Call</td>
<td>当前的Call对象</td>
</tr>
<tr>
<td>$ch</td>
<td>resource</td>
<td>cUrl会话的变量</td>
</tr>
</tbody>
</table><h3>方法</h3>

<h4>call($options = array())</h4>

<p>初始化一个新的Call对象,并执行HTTP请求</p>

<p>返回:  <code>Widget\Call</code> 新的call服务对象</p>

<h4>call($url, $options = array())</h4>

<p>根据给定的URL地址,初始化一个Call对象,并执行HTTP请求</p>

<p>返回:  <code>Widget\Call</code> 新的call服务对象</p>

<h4>call-&gt;isSuccess()</h4>

<p>返回请求及数据解析是否成功</p>

<p>返回: <code>bool</code></p>

<h4>call-&gt;getCh()</h4>

<p>获取cURL的会话变量</p>

<p>返回: <code>resource</code></p>

<h4>call-&gt;getData()</h4>

<p>获取要发送到服务器的数据</p>

<p>返回: <code>array</code>|<code>string</code></p>

<h4>call-&gt;getIp()</h4>

<p>获取设置的服务器IP地址</p>

<p>返回: <code>string</code></p>

<h4>call-&gt;getMethod()</h4>

<p>获取HTTP请求的方式</p>

<p>返回: <code>string</code></p>

<h4>call-&gt;getUrl()</h4>

<p>获取HTTP请求的URL地址</p>

<p>返回: <code>string</code></p>

<h4>call-&gt;getResponseHeader($name)</h4>

<p>获取HTTP响应头的值</p>

<h4>call-&gt;getResponseText()</h4>

<p>获取HTTP响应的文本数据</p>

<h4>call-&gt;setMethod($method)</h4>

<p>设置HTTP的请求方式</p>

<h4>call-&gt;setRequestHeader($name, $value)</h4>

<p>设置HTTP请求头的值</p>

<h4>call-&gt;get($url, $data = array(), $dataType = null)</h4>

<p>通过GET方式发送带数据的请求</p>

<p>返回:  <code>Widget\Call</code> 新的call服务对象</p>

<h4>call-&gt;getJson($url, $data = array())</h4>

<p>通过GET方式发送带数据的请求,并将返回数据解析为JSON数组</p>

<p>返回:  <code>Widget\Call</code> 新的call服务对象</p>

<h4>call-&gt;getJsonObject($url, $data = array())</h4>

<p>通过GET方式发送带数据的请求,并将返回数据解析为JSON对象</p>

<p>返回:  <code>Widget\Call</code> 新的call服务对象</p>

<h4>call-&gt;post($url, $data = array(), $dataType = null)</h4>

<p>通过POST方式发送带数据的请求</p>

<p>返回:  <code>Widget\Call</code> 新的call服务对象</p>

<h4>call-&gt;put($url, $data = array(), $dataType = null)</h4>

<p>通过PUT方式发送带数据的请求</p>

<p>返回:  <code>Widget\Call</code> 新的call服务对象</p>

<h4>call-&gt;delete($url, $data = array(), $dataType = null)</h4>

<p>通过DELETE方式发送带数据的请求</p>

<p>返回:  <code>Widget\Call</code> 新的call服务对象</p>

<h4>call-&gt;patch($url, $data = array(), $dataType = null)</h4>

<p>通过PATCH方式发送带数据的请求</p>

<p>返回:  <code>Widget\Call</code> 新的call服务对象</p>
  </section>

<!-- api/validate
  ================================================== -->
  <section id="validate">
  <div class="page-header"><h1>Validate</h1></div>

<p>检查数组或对象中每一个元素是否能通过指定规则的验证</p>

<p><code>Validate</code>服务是参考<a href="http://bassistance.de/jquery-plugins/jquery-plugin-validation/" target="_blank">jQuery Validation</a>
开发的数据验证器,她与<code>jQuery Validation</code>有着很多相似的地方,所以如果你使用过
<code>jQuery Validation</code>,使用<code>Validate</code>服务将非常容易上手.</p>

<h2>案例</h2>

<h3>检查数据是否符合指定的验证规则</h3>

<div class="highlight"><pre><code class="php"><span class="nv">$validator</span> <span class="o">=</span> <span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">validate</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
    <span class="c1">// 待验证的数据</span>
    <span class="s1">'data'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">'username'</span> <span class="o">=&gt;</span> <span class="s1">'tw'</span><span class="p">,</span>
        <span class="s1">'email'</span> <span class="o">=&gt;</span> <span class="s1">'invalid'</span><span class="p">,</span>
    <span class="p">),</span>
    <span class="c1">// 验证规则数组</span>
    <span class="s1">'rules'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">'username'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
            <span class="s1">'minLength'</span> <span class="o">=&gt;</span> <span class="mi">3</span><span class="p">,</span>
            <span class="s1">'alnum'</span> <span class="o">=&gt;</span> <span class="k">true</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="s1">'email'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
            <span class="s1">'email'</span> <span class="o">=&gt;</span> <span class="k">true</span>
        <span class="p">)</span>
    <span class="p">),</span>
    <span class="c1">// 数据项名称的数组,用于错误信息提示</span>
    <span class="s1">'names'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">'username'</span> <span class="o">=&gt;</span> <span class="s1">'用户名'</span><span class="p">,</span>
        <span class="s1">'email'</span> <span class="o">=&gt;</span> <span class="s1">'邮箱'</span>
    <span class="p">),</span>
    <span class="c1">// 验证错误时的提示信息,留空将使用默认信息</span>
    <span class="s1">'messages'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">'username'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
            <span class="s1">'minLength'</span> <span class="o">=&gt;</span> <span class="s1">'%name%的长度必须大于3'</span><span class="p">,</span>
            <span class="s1">'alnum'</span> <span class="o">=&gt;</span> <span class="s1">'%name%只能由字母和数字组成'</span>
        <span class="p">),</span>
        <span class="s1">'email'</span> <span class="o">=&gt;</span> <span class="s1">'%name%格式不正确'</span>
    <span class="p">)</span>
<span class="p">));</span>

<span class="c1">// 检查是否通过验证,输出'No'</span>
<span class="k">if</span> <span class="p">(</span><span class="nv">$validator</span><span class="o">-&gt;</span><span class="na">isValid</span><span class="p">())</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'Yes'</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'No'</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// 获取第一条错误信息</span>
<span class="nv">$firstMessage</span> <span class="o">=</span> <span class="nv">$validator</span><span class="o">-&gt;</span><span class="na">getFirstMessage</span><span class="p">();</span>

<span class="c1">// 返回的信息如下</span>
<span class="nv">$firstMessage</span> <span class="o">=</span> <span class="s1">'用户名的长度必须大于3'</span><span class="p">;</span>

<span class="c1">// 获取合并的错误信息</span>
<span class="nv">$joinedMessage</span> <span class="o">=</span> <span class="nv">$validator</span><span class="o">-&gt;</span><span class="na">getJoinedMessage</span><span class="p">();</span>

<span class="c1">// 返回的信息如下</span>
<span class="nv">$joinedMessage</span> <span class="o">=</span> <span class="s2">"用户名的长度必须大于3</span><span class="se">\n</span><span class="s2">邮箱格式不正确"</span><span class="p">;</span>

<span class="c1">// 获取简练的错误信息</span>
<span class="nv">$summaryMessages</span> <span class="o">=</span> <span class="nv">$validator</span><span class="o">-&gt;</span><span class="na">getSummaryMessages</span><span class="p">();</span>

<span class="c1">// 返回的信息如下</span>
<span class="nv">$summaryMessages</span> <span class="o">=</span> <span class="k">array</span> <span class="p">(</span>
    <span class="s1">'username'</span> <span class="o">=&gt;</span> <span class="k">array</span> <span class="p">(</span>
        <span class="mi">0</span> <span class="o">=&gt;</span> <span class="s1">'用户名的长度必须大于3'</span><span class="p">,</span>
    <span class="p">),</span>
    <span class="s1">'email'</span> <span class="o">=&gt;</span> <span class="k">array</span> <span class="p">(</span>
        <span class="mi">0</span> <span class="o">=&gt;</span> <span class="s1">'邮箱格式不正确'</span><span class="p">,</span>
    <span class="p">),</span>
<span class="p">);</span>

<span class="c1">// 获取详细的错误信息</span>
<span class="nv">$detailMessages</span> <span class="o">=</span> <span class="nv">$validator</span><span class="o">-&gt;</span><span class="na">getDetailMessages</span><span class="p">();</span>

<span class="c1">// 返回的信息如下</span>
<span class="nv">$detailMessages</span> <span class="o">=</span> <span class="k">array</span> <span class="p">(</span>
    <span class="s1">'username'</span> <span class="o">=&gt;</span> <span class="k">array</span> <span class="p">(</span>
        <span class="s1">'minLength'</span> <span class="o">=&gt;</span> <span class="k">array</span> <span class="p">(</span>
            <span class="s1">'tooShort'</span> <span class="o">=&gt;</span> <span class="s1">'用户名的长度必须大于3'</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">),</span>
    <span class="s1">'email'</span> <span class="o">=&gt;</span> <span class="k">array</span> <span class="p">(</span>
        <span class="s1">'email'</span> <span class="o">=&gt;</span> <span class="k">array</span> <span class="p">(</span>
            <span class="s1">'format'</span> <span class="o">=&gt;</span> <span class="s1">'邮箱格式不正确'</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">),</span>
<span class="p">);</span>
</code></pre></div>

<h2>调用方式</h2>

<h3>选项</h3>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>data</td>
<td>array,object</td>
<td>array()</td>
<td>待验证的数据,可以是数组或对象</td>
</tr>
<tr>
<td>rules</td>
<td>array</td>
<td>array()</td>
<td>验证规则数组</td>
</tr>
<tr>
<td>names</td>
<td>array</td>
<td>array()</td>
<td>数据项名称的数组,用于错误信息提示</td>
</tr>
<tr>
<td>messages</td>
<td>array</td>
<td>array()</td>
<td>验证错误时的提示信息</td>
</tr>
<tr>
<td>breakRule</td>
<td>bool</td>
<td>false</td>
<td>是否当任意一项规则验证不通过时就中断验证流程</td>
</tr>
<tr>
<td>breakField</td>
<td>bool</td>
<td>false</td>
<td>是否当任意一项数据验证不通过时就中断验证流程</td>
</tr>
<tr>
<td>skip</td>
<td>bool</td>
<td>false</td>
<td>是否当任意一项数据中的一项规则不通过时,就跳转到下一项数据的验证流程,默认是false,启用后,每项数据最多会有一个未通过的验证规则</td>
</tr>
<tr>
<td>ruleValid</td>
<td>callable</td>
<td>无</td>
<td>规则验证通过时调用的回调函数</td>
</tr>
<tr>
<td>ruleInvalid</td>
<td>callable</td>
<td>无</td>
<td>规则验证不通过时调用的回调函数</td>
</tr>
<tr>
<td>fieldValid</td>
<td>callable</td>
<td>无</td>
<td>数据项验证通过时调用的回调函数</td>
</tr>
<tr>
<td>fieldInvalid</td>
<td>callable</td>
<td>无</td>
<td>数据项验证不通过时调用的回调函数</td>
</tr>
<tr>
<td>success</td>
<td>callable</td>
<td>无</td>
<td>验证器验证通过(所有验证规则都通过)时调用的回调函数</td>
</tr>
<tr>
<td>failure</td>
<td>callable</td>
<td>无</td>
<td>验证器验证不通过(任意验证规则不通过)时调用的回调函数</td>
</tr>
</tbody>
</table><h4>选项详细说明</h4>

<h4>选项:data</h4>

<p>待验证的数据,可以是数组或对象</p>

<p>验证数据的取值的顺序如下</p>

<ol>
<li>如果<code>$data</code>是数组或<code>\ArrayAccess</code>的实例化对象,检查并返回<code>$data[$key]</code>的值</li>
<li>如果<code>$data</code>是对象,检查属性<code>$key</code>是否存在,存在则返回<code>$data-&gt;$key</code>的值</li>
<li>如果<code>$data</code>是对象且方法<code>get. $key</code>存在,返回<code>$data-&gt;{'get' . $key}</code>
</li>
<li>如果以上均不存在,返回null</li>
</ol><h5>案例:使用数组和对象作为验证数据</h5>

<div class="highlight"><pre><code class="php"><span class="k">class</span> <span class="nc">User</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">getName</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="s1">'twin'</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">getEmail</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="s1">'test@test.com'</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// 以数组为验证数据</span>
<span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">validate</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
    <span class="s1">'data'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">'name'</span> <span class="o">=&gt;</span> <span class="s1">'twin'</span><span class="p">,</span>
        <span class="s1">'email'</span> <span class="o">=&gt;</span> <span class="s1">'test@test.com'</span>
    <span class="p">)</span>
<span class="p">));</span>

<span class="c1">// 以数组对象为验证数据</span>
<span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">validate</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
    <span class="s1">'data'</span> <span class="o">=&gt;</span> <span class="k">new</span> <span class="nx">\ArrayObject</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
        <span class="s1">'name'</span> <span class="o">=&gt;</span> <span class="s1">'twin'</span><span class="p">,</span>
        <span class="s1">'email'</span> <span class="o">=&gt;</span> <span class="s1">'test@test.com'</span>
    <span class="p">))</span>
<span class="p">));</span>

<span class="c1">// 以对象为验证数据</span>
<span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">validate</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
    <span class="s1">'data'</span> <span class="o">=&gt;</span> <span class="k">new</span> <span class="nx">User</span>
<span class="p">));</span>
</code></pre></div>

<h4>选项:rules</h4>

<p>验证规则数组.</p>

<p>规则可以字符串,表示一项验证规则,也可以是数组,表示多项验证规则.</p>

<p>所有的验证规则请查看<a href="https://github.com/twinh/widget/tree/master/docs/zh-CN/api/../#api%E5%8F%82%E8%80%83%E7%9B%AE%E5%BD%95" target="_blank">API目录</a>-<a href="https://github.com/twinh/widget/tree/master/docs/zh-CN/api/../#%E9%AA%8C%E8%AF%81%E5%99%A8" target="_blank">验证器</a>章节.</p>

<p><strong>注意:</strong></p>

<ol>
<li>所有数据项默认都是 <strong>必选</strong> 的,如果某一个数据项是选填的,只需增加 <strong><code>required =&gt; false</code></strong> 的验证规则</li>
<li>验证规则会被转换成对应的类.如<code>email</code>规则将被转换为<code>\Widget\Validator\Email</code>类,如果类不存在,将抛出异常提醒开发人员规则不存在.</li>
<li>验证规则都是 <strong>不</strong> 以<code>is</code>开头的,<code>email</code>,<code>digit</code>是正确的规则名称,<code>isEmail</code>,<code>isDigit</code>是错误的规则名称</li>
</ol><h5>案例:验证规则格式</h5>

<div class="highlight"><pre><code class="php"><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">validate</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
    <span class="s1">'rules'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="c1">// 简单规则,将会被转换为 array('required' =&gt; true)</span>
        <span class="s1">'name'</span> <span class="o">=&gt;</span> <span class="s1">'required'</span><span class="p">,</span>
        <span class="c1">// 复合规则</span>
        <span class="s1">'email'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
            <span class="s1">'required'</span> <span class="o">=&gt;</span> <span class="k">false</span><span class="p">,</span> <span class="c1">// 设置为false表示email是选填</span>
            <span class="s1">'email'</span> <span class="o">=&gt;</span> <span class="k">true</span><span class="p">,</span>
            <span class="s1">'length'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">256</span><span class="p">),</span>
        <span class="p">),</span>
        <span class="c1">// 完整规则</span>
        <span class="s1">'avatar'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
            <span class="s1">'image'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
                <span class="s1">'maxWidth'</span> <span class="o">=&gt;</span> <span class="mi">200</span><span class="p">,</span>
                <span class="s1">'maxHeight'</span> <span class="o">=&gt;</span> <span class="mi">200</span>
            <span class="p">)</span>
        <span class="p">),</span>
        <span class="c1">// 允许的验证器格式</span>
        <span class="s1">'数据项名称'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
            <span class="s1">'验证器名称1'</span><span class="p">,</span>
            <span class="s1">'验证器名称2'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s1">'验证的选项1'</span><span class="p">,</span> <span class="s1">'验证的选项2'</span><span class="p">),</span> <span class="c1">// 参数将传递给验证器的__invoke方法</span>
            <span class="s1">'验证器名称3'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span> <span class="c1">// 参数将传递给验证器的setOption方法</span>
                <span class="s1">'验证器选项名称1'</span> <span class="o">=&gt;</span> <span class="s1">'验证器选项值1'</span><span class="p">,</span>
                <span class="s1">'验证器选项名称2'</span> <span class="o">=&gt;</span> <span class="s1">'验证器选项值2'</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>
    <span class="p">)</span>
<span class="p">));</span>
</code></pre></div>

<h5>案例:区分验证规则和验证对象的名称</h5>

<ol>
<li>验证对象均是以<code>is</code>开头,如<code>isDigit</code>,<code>isAlnum</code>
</li>
<li>作为验证规则时,需使用原始的名称,如<code>digit</code>,<code>alnum</code>
</li>
</ol><div class="highlight"><pre><code class="php"><span class="nv">$age</span> <span class="o">=</span> <span class="mi">18</span><span class="p">;</span>

<span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">validate</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
    <span class="s1">'data'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">'age'</span> <span class="o">=&gt;</span> <span class="nv">$age</span>
    <span class="p">),</span>
    <span class="s1">'rules'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">'age'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
            <span class="s1">'digit'</span> <span class="o">=&gt;</span> <span class="k">true</span><span class="p">,</span> <span class="c1">// √正确</span>
            <span class="s1">'isDigit'</span> <span class="o">=&gt;</span> <span class="k">true</span><span class="p">,</span> <span class="c1">// ×错误</span>
        <span class="p">)</span>
    <span class="p">)</span>
<span class="p">));</span>

<span class="c1">// 通过isDigit验证对象,验证数据</span>
<span class="nv">$bool</span> <span class="o">=</span> <span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">isDigit</span><span class="p">(</span><span class="nv">$age</span><span class="p">);</span>

<span class="c1">// 通过is对象,指定验证规则验证数据</span>
<span class="nv">$bool</span> <span class="o">=</span> <span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">is</span><span class="p">(</span><span class="s1">'digit'</span><span class="p">,</span> <span class="nv">$age</span><span class="p">);</span>
</code></pre></div>

<h5>案例:区分<code>required</code>,<code>notBlank</code>和<code>present</code>验证规则</h5>

<p>这三个验证规则都用于检查数据不能为空,它们在使用场景和检查的数据内容稍有不同.</p>

<p><strong>使用场景的区别</strong></p>

<ul>
<li>
<p><code>required</code>通常用于验证器的规则中,表示某一项是不能为空或是可选</p>

<div class="highlight"><pre><code class="php"><span class="nv">$validator</span> <span class="o">=</span> <span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">validate</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
    <span class="s1">'rules'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">'email'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
            <span class="s1">'required'</span> <span class="o">=&gt;</span> <span class="k">true</span><span class="p">,</span>
            <span class="s1">'email'</span> <span class="o">=&gt;</span> <span class="k">true</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="p">)</span>
<span class="p">));</span>
</code></pre></div>
</li>
<li>
<p><code>present</code>和<code>notBlank</code>既可以用于验证器规则中,又可以独立作为验证对象</p>

<div class="highlight"><pre><code class="php"><span class="c1">// 作为验证器规则</span>
<span class="nv">$validator</span> <span class="o">=</span> <span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">validate</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
    <span class="s1">'rules'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">'email'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
            <span class="s1">'required'</span> <span class="o">=&gt;</span> <span class="k">true</span><span class="p">,</span>
            <span class="s1">'present'</span> <span class="o">=&gt;</span> <span class="k">true</span><span class="p">,</span>
            <span class="s1">'email'</span> <span class="o">=&gt;</span> <span class="k">true</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="p">)</span>
<span class="p">));</span>

<span class="c1">// 独立使用,注意不以`not`开头</span>
<span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">isBlank</span><span class="p">(</span><span class="nv">$input</span><span class="p">))</span> <span class="p">{</span>
    <span class="nb">print_r</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">isBlank</span><span class="o">-&gt;</span><span class="na">getMessages</span><span class="p">());</span>
<span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">isPresent</span><span class="p">(</span><span class="nv">$input</span><span class="p">))</span> <span class="p">{</span>
    <span class="nb">print_r</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">isPresent</span><span class="o">-&gt;</span><span class="na">getMessages</span><span class="p">());</span>
<span class="p">}</span>
</code></pre></div>
</li>
</ul><p><strong>检查内容的区别</strong></p>

<ul>
<li>
<p>当数据为以下值时,这三个规则均验证不通过,返回<code>false</code></p>

<ul>
<li>null</li>
<li>'' (空字符串)</li>
<li>false</li>
<li>array() (空数组)</li>
</ul>
</li>
<li>
<p>当数据完全由以下任意字符组成时,<code>notBlank</code>规则会验证不通过,返回<code>false</code></p>

<table class="table table-bordered table-striped">
<thead><tr>
<th>字符</th>
<th>ASCII</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>" "</td>
<td>32</td>
<td>普通空格符</td>
</tr>
<tr>
<td>"\t"</td>
<td>9</td>
<td>制表符</td>
</tr>
<tr>
<td>"\n"</td>
<td>10</td>
<td>换行符</td>
</tr>
<tr>
<td>"\r"</td>
<td>13</td>
<td>回车符</td>
</tr>
<tr>
<td>"\0"</td>
<td>0</td>
<td>空字节符</td>
</tr>
<tr>
<td>"\x0B"</td>
<td>11</td>
<td>垂直制表符</td>
</tr>
</tbody>
</table>
<p>来源参见<a href="http://www.php.net/manual/zh/function.trim.php" target="_blank">trim</a>函数</p>
</li>
<li><p>当数据由其他字符组成(包括0),所有规则均验证通过,返回<code>true</code></p></li>
</ul><h5>案例:区分<code>all</code>和<code>allOf</code>验证规则</h5>

<p>规则说明:</p>

<ul>
<li>
<code>all</code>: 检查<code>数组</code>里的每一项是否符合指定的规则</li>
<li>
<code>allOf</code>: 检查数据是否通过所有的规则校验</li>
</ul><p>它们的区别在于<code>all</code>的检查数据必须是数组,检查的对象是数组里的每一项,<code>allOf</code>可以是任意值</p>

<p><strong>检查数组里的每一项是否都为数字,并且小于8</strong></p>

<div class="highlight"><pre><code class="php"><span class="nv">$input</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">isAll</span><span class="p">(</span><span class="nv">$input</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">'digit'</span> <span class="o">=&gt;</span> <span class="k">true</span><span class="p">,</span>
    <span class="s1">'lessThan'</span> <span class="o">=&gt;</span> <span class="mi">8</span>
<span class="p">)))</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'Yes'</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'No'</span><span class="p">;</span>
<span class="p">}</span>
<span class="c1">// 输出Yes</span>
</code></pre></div>

<p><strong>检查数据是否为数字,并且小于8</strong></p>

<div class="highlight"><pre><code class="php"><span class="nv">$input</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
<span class="k">if</span> <span class="p">(</span><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">isAllOf</span><span class="p">(</span><span class="nv">$input</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">'digit'</span> <span class="o">=&gt;</span> <span class="k">true</span><span class="p">,</span>
    <span class="s1">'lessThan'</span> <span class="o">=&gt;</span> <span class="mi">8</span>
<span class="p">)))</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'Yes'</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'No'</span><span class="p">;</span>
<span class="p">}</span>
<span class="c1">// 输出Yes</span>
</code></pre></div>

<h4>选项:messages</h4>

<p>验证错误时的提示信息.提示信息的格式与验证规则类似.</p>

<h5>案例:提示信息的格式</h5>

<div class="highlight"><pre><code class="php"><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">validate</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
    <span class="s1">'rules'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">'name'</span> <span class="o">=&gt;</span> <span class="s1">'required'</span><span class="p">,</span>
        <span class="s1">'email'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
            <span class="s1">'required'</span> <span class="o">=&gt;</span> <span class="k">true</span><span class="p">,</span>
            <span class="s1">'email'</span> <span class="o">=&gt;</span> <span class="k">true</span>
        <span class="p">),</span>
        <span class="s1">'avatar'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
            <span class="s1">'image'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
                <span class="s1">'maxWidth'</span> <span class="o">=&gt;</span> <span class="mi">200</span><span class="p">,</span>
                <span class="s1">'maxHeight'</span> <span class="o">=&gt;</span> <span class="mi">200</span>
            <span class="p">)</span>
        <span class="p">)</span>
    <span class="p">),</span>
    <span class="s1">'messages'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="c1">// 简单信息</span>
        <span class="s1">'name'</span> <span class="o">=&gt;</span> <span class="s1">'请输入您的用户名'</span><span class="p">,</span>
        <span class="c1">// 复合信息</span>
        <span class="s1">'email'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
            <span class="s1">'required'</span> <span class="o">=&gt;</span> <span class="s1">'请输入邮箱地址'</span><span class="p">,</span>
            <span class="s1">'email'</span> <span class="o">=&gt;</span> <span class="s1">'您输入的邮箱格式不正确'</span>
        <span class="p">),</span>
        <span class="c1">// 完整信息</span>
        <span class="s1">'avatar'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
            <span class="s1">'image'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
                <span class="s1">'widthTooBig'</span> <span class="o">=&gt;</span> <span class="s1">'您的头像宽度不能超过200px'</span><span class="p">,</span>
                <span class="s1">'heightTooBig'</span> <span class="o">=&gt;</span> <span class="s1">'您的头像高度不能超过200px'</span>
            <span class="p">)</span>
        <span class="p">),</span>
        <span class="c1">// 信息的格式</span>
        <span class="s1">'数据项名称1'</span> <span class="o">=&gt;</span> <span class="s1">'数据项错误信息1'</span><span class="p">,</span>
        <span class="s1">'数据项名称2'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
            <span class="s1">'验证器名称1'</span> <span class="o">=&gt;</span> <span class="s1">'验证器错误信息1'</span><span class="p">,</span>
            <span class="s1">'验证器名称2'</span> <span class="o">=&gt;</span> <span class="s1">'验证器错误信息2'</span>
        <span class="p">),</span>
        <span class="s1">'数据项名称3'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
            <span class="s1">'验证器名称3'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
                <span class="s1">'验证错误信息的名称1'</span> <span class="o">=&gt;</span> <span class="s1">'验证错误信息1'</span>
                <span class="s1">'验证错误信息的名称2'</span> <span class="o">=&gt;</span> <span class="s1">'验证错误信息2'</span>
            <span class="p">)</span>
        <span class="p">),</span>
    <span class="p">)</span>
<span class="p">));</span>
</code></pre></div>

<h4>选项:names</h4>

<p>数据项名称的数组,用于错误信息提示.数组的键名是验证数据项的值,数值的值是验证数据项的名称.如</p>

<p><strong>注意:</strong>如果未提供数据项名称,错误信息将以<code>该项</code>作为验证数据项的名称,完整的错误信息例如<code>该项不能为空</code></p>

<h5>案例</h5>

<div class="highlight"><pre><code class="php"><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">validate</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
    <span class="s1">'rules'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">'name'</span> <span class="o">=&gt;</span> <span class="s1">'required'</span><span class="p">,</span>
        <span class="s1">'email'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
            <span class="s1">'required'</span> <span class="o">=&gt;</span> <span class="k">true</span><span class="p">,</span>
            <span class="s1">'email'</span> <span class="o">=&gt;</span> <span class="k">true</span>
        <span class="p">),</span>
        <span class="s1">'avatar'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
            <span class="s1">'image'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
                <span class="s1">'maxWidth'</span> <span class="o">=&gt;</span> <span class="mi">200</span><span class="p">,</span>
                <span class="s1">'maxHeight'</span> <span class="o">=&gt;</span> <span class="mi">200</span>
            <span class="p">)</span>
        <span class="p">)</span>
    <span class="p">),</span>
    <span class="c1">// 指定验证数据项的名称</span>
    <span class="s1">'names'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">'name'</span> <span class="o">=&gt;</span> <span class="s1">'用户名'</span><span class="p">,</span>
        <span class="s1">'email'</span> <span class="o">=&gt;</span> <span class="s1">'邮箱'</span><span class="p">,</span>
        <span class="s1">'avatar'</span> <span class="o">=&gt;</span> <span class="s1">'头像'</span>
    <span class="p">)</span>
<span class="p">));</span>

<span class="c1">// 输出信息类似:</span>
<span class="c1">// 用户名不能为空</span>
<span class="c1">// 邮箱不能为空</span>
<span class="c1">// 头像宽度不能超过200px</span>
</code></pre></div>

<h4>回调:ruleValid</h4>

<p>当任意一条规则验证通过时,验证器就会触发<code>ruleValid</code>回调.</p>

<p><strong>参数</strong></p>

<div class="highlight"><pre><code class="php"><span class="nx">ruleValid</span><span class="p">(</span><span class="nv">$rule</span><span class="p">,</span> <span class="nv">$field</span><span class="p">,</span> <span class="nv">$validator</span><span class="p">,</span> <span class="nv">$widget</span><span class="p">)</span>
</code></pre></div>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>$rule</td>
<td>string</td>
<td>验证规则的名称</td>
</tr>
<tr>
<td>$field</td>
<td>string</td>
<td>当前验证的数据项名称</td>
</tr>
<tr>
<td>$validator</td>
<td>Widget\Validate</td>
<td>验证器对象</td>
</tr>
<tr>
<td>$widget</td>
<td>Widget\Widget</td>
<td>对象管理器</td>
</tr>
</tbody>
</table><p>如果<code>ruleValid</code>回调返回false,验证器将直接中断后续所有验证流程,直接返回验证结果.</p>

<h5>案例</h5>

<div class="highlight"><pre><code class="php"><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">validate</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
    <span class="s1">'data'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">'name'</span> <span class="o">=&gt;</span> <span class="s1">'twin'</span>
    <span class="p">),</span>
    <span class="s1">'rules'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">'name'</span> <span class="o">=&gt;</span> <span class="s1">'required'</span>
    <span class="p">),</span>
    <span class="s1">'ruleValid'</span> <span class="o">=&gt;</span> <span class="k">function</span><span class="p">(</span><span class="nv">$rule</span><span class="p">,</span> <span class="nv">$field</span><span class="p">,</span> <span class="nv">$validator</span><span class="p">,</span> <span class="nv">$widget</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">echo</span> <span class="nv">$rule</span><span class="p">;</span>
        <span class="k">echo</span> <span class="nv">$field</span><span class="p">;</span>
        <span class="k">echo</span> <span class="s1">'Yes'</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">));</span>
</code></pre></div>

<h5>运行结果</h5>

<div class="highlight"><pre><code class="php"><span class="s1">'required'</span>
<span class="s1">'name'</span>
<span class="s1">'Yes'</span>
</code></pre></div>

<h4>回调:ruleInvalid</h4>

<p>当任意一条规则验证 <strong>不</strong> 通过时,验证器就会触发<code>ruleInvalid</code>回调.</p>

<p><strong>参数</strong></p>

<div class="highlight"><pre><code class="php"><span class="nx">ruleInvalid</span><span class="p">(</span><span class="nv">$rule</span><span class="p">,</span> <span class="nv">$field</span><span class="p">,</span> <span class="nv">$validator</span><span class="p">,</span> <span class="nv">$widget</span><span class="p">)</span>
</code></pre></div>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>$rule</td>
<td>string</td>
<td>验证规则的名称</td>
</tr>
<tr>
<td>$field</td>
<td>string</td>
<td>当前验证的数据项名称</td>
</tr>
<tr>
<td>$validator</td>
<td>Widget\Validate</td>
<td>验证器对象</td>
</tr>
<tr>
<td>$widget</td>
<td>Widget\Widget</td>
<td>对象管理器</td>
</tr>
</tbody>
</table><p><code>ruleInvalid</code>与<code>ruleValid</code>的行为一致.
同样的,如果<code>ruleInvalid</code>回调返回false,验证器将直接中断后续所有验证流程,直接返回验证结果.</p>

<h5>案例</h5>

<div class="highlight"><pre><code class="php"><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">validate</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
    <span class="s1">'data'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">'name'</span> <span class="o">=&gt;</span> <span class="k">null</span>
    <span class="p">),</span>
    <span class="s1">'rules'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">'name'</span> <span class="o">=&gt;</span> <span class="s1">'required'</span>
    <span class="p">),</span>
    <span class="s1">'ruleInvalid'</span> <span class="o">=&gt;</span> <span class="k">function</span><span class="p">(</span><span class="nv">$rule</span><span class="p">,</span> <span class="nv">$field</span><span class="p">,</span> <span class="nv">$validator</span><span class="p">,</span> <span class="nv">$widget</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">echo</span> <span class="nv">$rule</span><span class="p">;</span>
        <span class="k">echo</span> <span class="nv">$field</span><span class="p">;</span>
        <span class="k">echo</span> <span class="s1">'No'</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">));</span>
</code></pre></div>

<h5>运行结果</h5>

<div class="highlight"><pre><code class="php"><span class="s1">'required'</span>
<span class="s1">'name'</span>
<span class="s1">'No'</span>
</code></pre></div>

<h4>回调:fieldValid</h4>

<p>当任意数据项验证通过时,验证器就会触发<code>fieldValid</code>回调.</p>

<p><strong>参数</strong></p>

<div class="highlight"><pre><code class="php"><span class="nx">fieldValid</span><span class="p">(</span><span class="nv">$field</span><span class="p">,</span> <span class="nv">$validator</span><span class="p">,</span> <span class="nv">$widget</span><span class="p">)</span>
</code></pre></div>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>$rule</td>
<td>string</td>
<td>验证规则的名称</td>
</tr>
<tr>
<td>$validator</td>
<td>Widget\Validate</td>
<td>验证器对象</td>
</tr>
<tr>
<td>$widget</td>
<td>Widget\Widget</td>
<td>对象管理器</td>
</tr>
</tbody>
</table><p>如果<code>fieldValid</code>回调返回false,验证器将直接中断后续所有验证流程,直接返回验证结果.</p>

<h5>案例</h5>

<div class="highlight"><pre><code class="php"><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">validate</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
    <span class="s1">'data'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">'name'</span> <span class="o">=&gt;</span> <span class="s1">'twin'</span>
    <span class="p">),</span>
    <span class="s1">'rules'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">'name'</span> <span class="o">=&gt;</span> <span class="s1">'required'</span>
    <span class="p">),</span>
    <span class="s1">'fieldValid'</span> <span class="o">=&gt;</span> <span class="k">function</span><span class="p">(</span><span class="nv">$field</span><span class="p">,</span> <span class="nv">$validator</span><span class="p">,</span> <span class="nv">$widget</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">echo</span> <span class="nv">$field</span><span class="p">;</span>
        <span class="k">echo</span> <span class="s1">'Yes'</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">));</span>
</code></pre></div>

<h5>运行结果</h5>

<div class="highlight"><pre><code class="php"><span class="s1">'name'</span>
<span class="s1">'Yes'</span>
</code></pre></div>

<h5>回调:fieldInvalid</h5>

<p>当任意数据项验证 <strong>不</strong> 通过时,验证器就会触发<code>fieldInvalid</code>回调.</p>

<p><strong>参数</strong></p>

<div class="highlight"><pre><code class="php"><span class="nx">fieldInvalid</span><span class="p">(</span><span class="nv">$field</span><span class="p">,</span> <span class="nv">$validator</span><span class="p">,</span> <span class="nv">$widget</span><span class="p">)</span>
</code></pre></div>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>$rule</td>
<td>string</td>
<td>验证规则的名称</td>
</tr>
<tr>
<td>$validator</td>
<td>Widget\Validate</td>
<td>验证器对象</td>
</tr>
<tr>
<td>$widget</td>
<td>Widget\Widget</td>
<td>对象管理器</td>
</tr>
</tbody>
</table><p>如果<code>fieldInvalid</code>回调返回false,验证器将直接中断后续所有验证流程,直接返回验证结果.</p>

<h5>案例</h5>

<div class="highlight"><pre><code class="php"><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">validate</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
    <span class="s1">'data'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">'name'</span> <span class="o">=&gt;</span> <span class="k">null</span>
    <span class="p">),</span>
    <span class="s1">'rules'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">'name'</span> <span class="o">=&gt;</span> <span class="s1">'required'</span>
    <span class="p">),</span>
    <span class="s1">'fieldValid'</span> <span class="o">=&gt;</span> <span class="k">function</span><span class="p">(</span><span class="nv">$field</span><span class="p">,</span> <span class="nv">$validator</span><span class="p">,</span> <span class="nv">$widget</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">echo</span> <span class="nv">$field</span><span class="p">;</span>
        <span class="k">echo</span> <span class="s1">'No'</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">));</span>
</code></pre></div>

<h5>运行结果</h5>

<div class="highlight"><pre><code class="php"><span class="s1">'name'</span>
<span class="s1">'No'</span>
</code></pre></div>

<h4>回调:success</h4>

<p>验证结束时,如果最终验证结果为通过,验证器就触发<code>success</code>回调.</p>

<div class="highlight"><pre><code class="php"><span class="nx">success</span><span class="p">(</span><span class="nv">$validator</span><span class="p">,</span> <span class="nv">$widget</span><span class="p">)</span>
</code></pre></div>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>$validator</td>
<td>Widget\Validate</td>
<td>验证器对象</td>
</tr>
<tr>
<td>$widget</td>
<td>Widget\Widget</td>
<td>对象管理器</td>
</tr>
</tbody>
</table><h5>案例</h5>

<div class="highlight"><pre><code class="php"><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">validate</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
    <span class="s1">'data'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">'name'</span> <span class="o">=&gt;</span> <span class="s1">'twin'</span>
    <span class="p">),</span>
    <span class="s1">'rules'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">'name'</span> <span class="o">=&gt;</span> <span class="s1">'required'</span>
    <span class="p">),</span>
    <span class="s1">'success'</span> <span class="o">=&gt;</span> <span class="k">function</span><span class="p">(</span><span class="nv">$validator</span><span class="p">,</span> <span class="nv">$widget</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">echo</span> <span class="s1">'Yes'</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">));</span>
</code></pre></div>

<h5>运行结果</h5>

<div class="highlight"><pre><code class="php"><span class="s1">'Yes'</span>
</code></pre></div>

<h4>回调:failure</h4>

<p>验证结束时,如果最终验证结果为 <strong>不</strong> 通过,验证器就触发<code>failure</code>回调.</p>

<div class="highlight"><pre><code class="php"><span class="nx">failure</span> <span class="p">(</span> <span class="nv">$event</span><span class="p">,</span> <span class="nv">$widget</span><span class="p">,</span> <span class="nv">$validator</span> <span class="p">)</span>
</code></pre></div>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>$validator</td>
<td>Widget\Validate</td>
<td>验证器对象</td>
</tr>
<tr>
<td>$widget</td>
<td>Widget\Widget</td>
<td>对象管理器</td>
</tr>
</tbody>
</table><h5>案例</h5>

<div class="highlight"><pre><code class="php"><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">validate</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
    <span class="s1">'data'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">'name'</span> <span class="o">=&gt;</span> <span class="k">null</span>
    <span class="p">),</span>
    <span class="s1">'rules'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">'name'</span> <span class="o">=&gt;</span> <span class="s1">'required'</span>
    <span class="p">),</span>
    <span class="s1">'failure'</span> <span class="o">=&gt;</span> <span class="k">function</span><span class="p">(</span><span class="nv">$validator</span><span class="p">,</span> <span class="nv">$widget</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">echo</span> <span class="s1">'No'</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">));</span>
</code></pre></div>

<h5>运行结果</h5>

<div class="highlight"><pre><code class="php"><span class="s1">'No'</span>
</code></pre></div>

<h4>选项:breakRule</h4>

<p>默认为<code>false</code>.设置为<code>true</code>后,当任意一项规则验证不通过时就中断验证流程,直接返回验证结果(false)</p>

<h4>选项:breakField</h4>

<p>默认为<code>false</code>.设置为<code>true</code>后,当任意一项数据验证不通过时就中断验证流程,直接返回验证结果(false)</p>

<h4>选项:skip</h4>

<p>默认为<code>false</code>.设置为<code>true</code>后,当任意一项数据中的一项规则不通过时,就跳转到下一项数据的验证流程.</p>

<p>因此,每项数据最多会有一个未通过的验证规则</p>

<h3>方法</h3>

<h4>validate($options)</h4>

<p>检查数组或对象中每一个元素是否能通过指定规则的验证</p>

<p>返回: <code>Widget\Validate</code> 新的验证器对象</p>

<p>参数</p>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr></thead>
<tbody><tr>
<td>$options</td>
<td>array</td>
<td>验证器的选项,完整内容请查看"调用方式"-"选项"章节</td>
</tr></tbody>
</table><h4>validate-&gt;addRule($field, $rule, $parameters)</h4>

<p>为数据项增加新的验证规则</p>

<p>返回: <code>Widget\Validate</code> 验证器对象</p>

<p>参数</p>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>$field</td>
<td>string</td>
<td>数据项的名称</td>
</tr>
<tr>
<td>$rule</td>
<td>string</td>
<td>验证规则的名称</td>
</tr>
<tr>
<td>$parameters</td>
<td>string</td>
<td>验证规则的参数</td>
</tr>
</tbody>
</table><h4>validate-&gt;hasRule($field, $rule)</h4>

<p>检查数据项是否包含指定的验证规则</p>

<p>返回: <code>bool</code></p>

<p>参数</p>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>$field</td>
<td>string</td>
<td>数据项的名称</td>
</tr>
<tr>
<td>$rule</td>
<td>string</td>
<td>验证规则的名称</td>
</tr>
</tbody>
</table><h4>validate-&gt;removeRule($field, $rule)</h4>

<p>删除指定数据项的验证规则</p>

<p>返回: <code>bool</code> 规则存在并删除返回<code>true</code>,不存在返回<code>false</code></p>

<p>参数</p>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>$field</td>
<td>string</td>
<td>数据项的名称</td>
</tr>
<tr>
<td>$rule</td>
<td>string</td>
<td>验证规则的名称</td>
</tr>
</tbody>
</table><h4>validate-&gt;setRules(array $rules)</h4>

<p>设置验证规则</p>

<p>返回: <code>Widget\Validate</code> 验证器对象</p>

<h4>validate-&gt;getRules()</h4>

<p>获取验证规则</p>

<p>返回: <code>array</code> 验证规则数组</p>

<h4>validate-&gt;setData($data)</h4>

<p>设置要验证的数据</p>

<p>返回: <code>Widget\Validate</code> 验证器对象</p>

<h4>validate-&gt;getData()</h4>

<p>获取要验证的数据</p>

<p>返回: <code>array</code></p>

<h4>validate-&gt;setNames($names)</h4>

<p>设置数据项的名称</p>

<p>返回: <code>Widget\Validate</code> 验证器对象</p>

<h4>validate-&gt;getNames()</h4>

<p>获取数据项的名称</p>

<p>返回: <code>array</code></p>

<h4>validate-&gt;getFieldData($field)</h4>

<p>获取要验证的数据项的值</p>

<p>返回: <code>mixed</code> 不存在时返回null</p>

<p>参数</p>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr></thead>
<tbody><tr>
<td>$field</td>
<td>string</td>
<td>数据项的名称</td>
</tr></tbody>
</table><h4>validate-&gt;setFieldData($field, $value)</h4>

<p>设置要验证的数据项的值</p>

<p>返回: <code>Widget\Validate</code></p>

<p>参数</p>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>$field</td>
<td>string</td>
<td>数据项的名称</td>
</tr>
<tr>
<td>$value</td>
<td>mixed</td>
<td>数据项的值</td>
</tr>
</tbody>
</table><h4>validate-&gt;setMessages($messages)</h4>

<p>设置自定义的错误信息</p>

<p>返回: <code>Widget\Validate</code></p>

<p>参数</p>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr></thead>
<tbody><tr>
<td>$messages</td>
<td>array</td>
<td>错误信息数组</td>
</tr></tbody>
</table><h4>validate-&gt;getMessages()</h4>

<p>获取自定义的错误信息</p>

<p>返回: <code>array</code></p>

<h4>validate-&gt;getDetailMessages()</h4>

<p>获取详细的验证错误信息</p>

<p>返回: <code>array</code></p>

<h4>validate-&gt;getSummaryMessages()</h4>

<p>获取简洁的验证错误信息</p>

<p>返回: <code>array</code></p>

<h4>validate-&gt;getJoinedMessage($separator = "\n")</h4>

<p>获取合并的验证错误信息</p>

<p>返回: <code>string</code></p>

<p>参数</p>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr></thead>
<tbody><tr>
<td>$separator</td>
<td>string</td>
<td>合并错误信息数组的分隔符</td>
</tr></tbody>
</table><h4>validate-&gt;getFirstMessage()</h4>

<p>获取第一条验证错误信息</p>

<p>返回: <code>string</code>|<code>false</code> 验证不通过时返回第一条错误信息,通过时返回<code>false</code></p>

<h4>validate-&gt;getRuleValidator($field, $rule)</h4>

<p>获取规则验证器对象</p>

<p>返回: <code>Widget\Validator\BaseValidator</code>|<code>null</code> 验证器不存在时返回null</p>

<p>参数</p>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>$field</td>
<td>string</td>
<td>数据项的名称</td>
</tr>
<tr>
<td>$rule</td>
<td>string</td>
<td>验证规则的名称</td>
</tr>
</tbody>
</table>
  </section>

<!-- api/isAlnum
  ================================================== -->
  <section id="isAlnum">
  <div class="page-header"><h1>isAlnum</h1></div>

<p>检查数据是否只由字母(a-z)和数字(0-9)组成</p>

<h2>案例</h2>

<h3>检查数据是否只由字母和数字组成</h3>

<div class="highlight"><pre><code class="php"><span class="nv">$input</span> <span class="o">=</span> <span class="s1">'abc123'</span><span class="p">;</span>
<span class="k">if</span> <span class="p">(</span><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">isAlnum</span><span class="p">(</span><span class="nv">$input</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'Yes'</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'No'</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<h4>运行结果</h4>

<div class="highlight"><pre><code class="php"><span class="s1">'Yes'</span>
</code></pre></div>

<h2>调用方式</h2>

<h3>选项</h3>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>notStringMessage</td>
<td>string</td>
<td>%name%必须是字符串</td>
<td>-</td>
</tr>
<tr>
<td>patternMessage</td>
<td>string</td>
<td>%name%只能由字母(a-z)和数字(0-9)组成</td>
<td>-</td>
</tr>
<tr>
<td>negativeMessage</td>
<td>string</td>
<td>%name%不能只由字母(a-z)和数字(0-9)组成</td>
<td>-</td>
</tr>
</tbody>
</table><h3>方法</h3>

<h4>isAlnum($input)</h4>

<p>检查数据是否只由字母(a-z)和数字(0-9)组成</p>
  </section>

<!-- api/isAlpha
  ================================================== -->
  <section id="isAlpha">
  <div class="page-header"><h1>isAlpha</h1></div>

<p>检查数据是否只由字母(a-z)组成</p>

<h2>案例</h2>

<h3>检查数据是否只由字母组成</h3>

<div class="highlight"><pre><code class="php"><span class="nv">$input</span> <span class="o">=</span> <span class="s1">'abc123'</span><span class="p">;</span>
<span class="k">if</span> <span class="p">(</span><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">isAlpha</span><span class="p">(</span><span class="nv">$input</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'Yes'</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'No'</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<h4>运行结果</h4>

<div class="highlight"><pre><code class="php"><span class="s1">'No'</span>
</code></pre></div>

<h2>调用方式</h2>

<h3>选项</h3>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>notStringMessage</td>
<td>string</td>
<td>%name%必须是字符串</td>
<td>-</td>
</tr>
<tr>
<td>patternMessage</td>
<td>string</td>
<td>%name%只能由字母(a-z)组成</td>
<td>-</td>
</tr>
<tr>
<td>negativeMessage</td>
<td>string</td>
<td>%name%必须不匹配模式"%pattern%"</td>
<td>-</td>
</tr>
</tbody>
</table><h3>方法</h3>

<h4>isAlpha($input)</h4>

<p>检查数据是否只由字母(a-z)组成</p>
  </section>

<!-- api/isBlank
  ================================================== -->
  <section id="isBlank">
  <div class="page-header"><h1>isBlank</h1></div>

<p>检查数据是否为空(不允许空格)</p>

<h2>案例</h2>

<h3>检查空白字符会返回成功</h3>

<div class="highlight"><pre><code class="php"><span class="nv">$input</span> <span class="o">=</span> <span class="s1">'    '</span><span class="p">;</span>
<span class="k">if</span> <span class="p">(</span><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">isBlank</span><span class="p">(</span><span class="nv">$input</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'Yes'</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'No'</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<h4>运行结果</h4>

<div class="highlight"><pre><code class="php"><span class="s1">'Yes'</span>
</code></pre></div>

<h2>调用方式</h2>

<h3>选项</h3>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>blankMessage</td>
<td>string</td>
<td>%name%必须为空</td>
<td>-</td>
</tr>
<tr>
<td>negativeMessage</td>
<td>string</td>
<td>%name%不能为空</td>
<td>-</td>
</tr>
</tbody>
</table><h3>方法</h3>

<h4>isBlank($input)</h4>

<p>检查数据是否为空(不允许空格)</p>

<p><strong>返回:</strong> <code>bool</code> 检查结果</p>

<p><strong>参数</strong></p>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr></thead>
<tbody><tr>
<td>$input</td>
<td>string</td>
<td>要检查的数据</td>
</tr></tbody>
</table>
  </section>

<!-- api/isDecimal
  ================================================== -->
  <section id="isDecimal">
  <div class="page-header"><h1>isDecimal</h1></div>

<p>检查数据是否为小数</p>

<h2>案例</h2>

<h3>检查"1.0.0"是否为小数</h3>

<div class="highlight"><pre><code class="php"><span class="k">if</span> <span class="p">(</span><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">isDecimal</span><span class="p">(</span><span class="s1">'1.0.0'</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'Yes'</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'No'</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<h4>运行结果</h4>

<div class="highlight"><pre><code class="php"><span class="s1">'No'</span>
</code></pre></div>

<h2>调用方式</h2>

<h3>选项</h3>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>notStringMessage</td>
<td>string</td>
<td>%name%必须是字符串</td>
<td>-</td>
</tr>
<tr>
<td>invalidMessage</td>
<td>string</td>
<td>%name%必须是小数</td>
<td>-</td>
</tr>
<tr>
<td>negativeMessage</td>
<td>string</td>
<td>%name%不能是小数</td>
<td>-</td>
</tr>
</tbody>
</table><h3>方法</h3>

<h4>isDecimal($input)</h4>

<p>检查数据是否为小数</p>
  </section>

<!-- api/isDigit
  ================================================== -->
  <section id="isDigit">
  <div class="page-header"><h1>isDigit</h1></div>

<p>检查数据是否只由数字组成</p>

<h2>案例</h2>

<h3>检查"abc123"是否为数字</h3>

<div class="highlight"><pre><code class="php"><span class="k">if</span> <span class="p">(</span><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">isDigit</span><span class="p">(</span><span class="s1">'abc123'</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'Yes'</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'No'</span><span class="p">;</span>
<span class="p">}</span>
<span class="c1">// 输出了'No'</span>
</code></pre></div>

<h2>调用方式</h2>

<h3>选项</h3>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>patternMessage</td>
<td>string</td>
<td>%name%只能由数字(0-9)组成</td>
<td></td>
</tr>
<tr>
<td>negativeMessage</td>
<td>string</td>
<td>%name%不能只由数字(0-9)组成</td>
<td></td>
</tr>
<tr>
<td>notStringSring</td>
<td>string</td>
<td>%name%必须是字符串</td>
<td></td>
</tr>
</tbody>
</table><h3>方法</h3>

<h4>isDigit($input)</h4>

<p>检查数据是否只由数字组成</p>
  </section>

<!-- api/isDivisibleby
  ================================================== -->
  <section id="isDivisibleby">
  <div class="page-header"><h1>isDivisibleBy</h1></div>

<p>检查数据是否能被指定的除数整除</p>

<h2>案例</h2>

<h3>检查10能否被3整除</h3>

<div class="highlight"><pre><code class="php"><span class="k">if</span> <span class="p">(</span><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">isDivisibleBy</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'Yes'</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'No'</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<h4>运行结果</h4>

<div class="highlight"><pre><code class="php"><span class="s1">'No'</span>
</code></pre></div>

<h2>调用方式</h2>

<h3>选项</h3>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>notStringMessage</td>
<td>string</td>
<td>%name%必须是字符串</td>
<td>-</td>
</tr>
<tr>
<td>notDivisibleMessage</td>
<td>string</td>
<td>%name%必须被%divisor%整除</td>
<td>-</td>
</tr>
<tr>
<td>negativeMessage</td>
<td>string</td>
<td>%name%不可以被%divisor%整除</td>
<td>-</td>
</tr>
</tbody>
</table><h3>方法</h3>

<h4>isDivisibleBy($input)</h4>

<p>检查数据是否能被指定的除数整除</p>
  </section>

<!-- api/isDoubleByte
  ================================================== -->
  <section id="isDoubleByte">
  <div class="page-header"><h1>isDoubleByte</h1></div>

<p>检查数据是否只由双字节字符组成</p>

<h2>案例</h2>

<h3>检查"中文abc"是否只由双字节字符组成</h3>

<div class="highlight"><pre><code class="php"><span class="k">if</span> <span class="p">(</span><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">isDoubleByte</span><span class="p">(</span><span class="s1">'中文abc'</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'Yes'</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'No'</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<h4>运行结果</h4>

<div class="highlight"><pre><code class="php"><span class="s1">'No'</span>
</code></pre></div>

<h2>调用方式</h2>

<h3>选项</h3>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>notStringMessage</td>
<td>string</td>
<td>%name%必须是字符串</td>
<td>-</td>
</tr>
<tr>
<td>patternMessage</td>
<td>string</td>
<td>%name%只能由双字节字符组成</td>
<td>-</td>
</tr>
<tr>
<td>negativeMessage</td>
<td>string</td>
<td>%name%不能只由双字节字符组成</td>
<td>-</td>
</tr>
</tbody>
</table><h3>方法</h3>

<h4>isDoubleByte($input)</h4>

<p>检查数据是否只由双字节字符组成</p>
  </section>

<!-- api/isEndsWith
  ================================================== -->
  <section id="isEndsWith">
  <div class="page-header"><h1>isEndsWith</h1></div>

<p>检查数据是否以指定字符串结尾</p>

<h2>案例</h2>

<h3>检查"abc"是否以"C"结尾</h3>

<div class="highlight"><pre><code class="php"><span class="k">if</span> <span class="p">(</span><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">isEndsWith</span><span class="p">(</span><span class="s1">'abc'</span><span class="p">,</span> <span class="s1">'C'</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'Yes'</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'No'</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<h4>运行结果</h4>

<div class="highlight"><pre><code class="php"><span class="s1">'Yes'</span>
</code></pre></div>

<h3>以区分大小写的方式,检查"abc"是否以"C"结尾</h3>

<div class="highlight"><pre><code class="php"><span class="k">if</span> <span class="p">(</span><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">isEndsWith</span><span class="p">(</span><span class="s1">'abc'</span><span class="p">,</span> <span class="s1">'C'</span><span class="p">,</span> <span class="k">true</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'Yes'</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'No'</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<h4>运行结果</h4>

<div class="highlight"><pre><code class="php"><span class="s1">'No'</span>
</code></pre></div>

<h3>检查"abc"是否以数组array('a', 'b', 'c')中的任意元素结尾</h3>

<div class="highlight"><pre><code class="php"><span class="k">if</span> <span class="p">(</span><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">isEndsWith</span><span class="p">(</span><span class="s1">'abc'</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">'a'</span><span class="p">,</span> <span class="s1">'b'</span><span class="p">,</span> <span class="s1">'c'</span><span class="p">)))</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'Yes'</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'No'</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<h4>运行结果</h4>

<div class="highlight"><pre><code class="php"><span class="s1">'Yes'</span>
</code></pre></div>

<h2>调用方式</h2>

<h3>选项</h3>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>findMe</td>
<td>string,array</td>
<td>-</td>
<td>要查找的字符串.如果是数组,只要数据以数组中任何一个元素结尾就算验证通过</td>
</tr>
<tr>
<td>case</td>
<td>bool</td>
<td>false</td>
<td>查找时是否区分大小写</td>
</tr>
<tr>
<td>notStringMessage</td>
<td>string</td>
<td>%name%必须是字符串</td>
<td>-</td>
</tr>
<tr>
<td>notFoundMessage</td>
<td>string</td>
<td>%name%必须以%findMe%结尾</td>
<td>-</td>
</tr>
<tr>
<td>negativeMessage</td>
<td>string</td>
<td>%name%不能以%findMe%结尾</td>
<td>-</td>
</tr>
</tbody>
</table><h3>方法</h3>

<h4>isEndsWith($input, $findMe, $case = false)</h4>

<p>检查数据是否以指定字符串结尾</p>
  </section>

<!-- api/isIn
  ================================================== -->
  <section id="isIn">
  <div class="page-header"><h1>isIn</h1></div>

<p>检查数据是否在指定的数组中</p>

<h2>案例</h2>

<h3>检查"1"是否在array(1, 2, 3)之中</h3>

<div class="highlight"><pre><code class="php"><span class="k">if</span> <span class="p">(</span><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">isIn</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)))</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'Yes'</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'No'</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<h4>运行结果</h4>

<div class="highlight"><pre><code class="php"><span class="s1">'Yes'</span>
</code></pre></div>

<h2>调用方式</h2>

<h3>选项</h3>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>array</td>
<td>mixed</td>
<td>无</td>
<td>用于搜索的数组</td>
</tr>
<tr>
<td>strict</td>
<td>int</td>
<td>无</td>
<td>是否使用全等(===)进行比较,默认使用等于(==)比较</td>
</tr>
<tr>
<td>notInMessage</td>
<td>string</td>
<td>%name%必须在指定的数据中:%array%</td>
<td>-</td>
</tr>
<tr>
<td>negativeMessage</td>
<td>string</td>
<td>%name%不能在指定的数据中:%array%</td>
<td>-</td>
</tr>
</tbody>
</table><h3>方法</h3>

<h4>isIn($input, $array, $strict = false)</h4>

<p>检查数据是否在指定的数组中</p>
  </section>

<!-- api/isLowercase
  ================================================== -->
  <section id="isLowercase">
  <div class="page-header"><h1>isLowercase</h1></div>

<p>检查数据是否为小写字符</p>

<h2>案例</h2>

<h3>检查"abc"是否为小写字符</h3>

<div class="highlight"><pre><code class="php"><span class="k">if</span> <span class="p">(</span><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">isLowercase</span><span class="p">(</span><span class="s1">'abc'</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'Yes'</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'No'</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<h4>运行结果</h4>

<div class="highlight"><pre><code class="php"><span class="s1">'Yes'</span>
</code></pre></div>

<h2>调用方式</h2>

<h3>选项</h3>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>notStringMesssage</td>
<td>string</td>
<td>%name%必须是字符串</td>
<td>-</td>
</tr>
<tr>
<td>invalidMessage</td>
<td>string</td>
<td>%name%不能包含大写字母</td>
<td>-</td>
</tr>
<tr>
<td>negativeMessage</td>
<td>string</td>
<td>%name%不能包含小写字母</td>
<td>-</td>
</tr>
</tbody>
</table><h3>方法</h3>

<h4>isLowercase($input)</h4>

<p>检查数据是否为小写字符</p>

<p><strong>返回:</strong> <code>bool</code> 检查结果</p>

<p><strong>参数</strong></p>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr></thead>
<tbody><tr>
<td>$input</td>
<td>string</td>
<td>要检查的数据</td>
</tr></tbody>
</table>
  </section>

<!-- api/isNull
  ================================================== -->
  <section id="isNull">
  <div class="page-header"><h1>isNull</h1></div>

<p>检查数据是否为null</p>

<h3>检查0是否为null</h3>

<div class="highlight"><pre><code class="php"><span class="k">if</span> <span class="p">(</span><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">isNull</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'Yes'</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'No'</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<h4>运行结果</h4>

<div class="highlight"><pre><code class="php"><span class="s1">'No'</span>
</code></pre></div>

<h2>调用方式</h2>

<h3>选项</h3>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>notNullMesssage</td>
<td>string</td>
<td>%name%必须是null值</td>
<td>-</td>
</tr>
<tr>
<td>negativeMessage</td>
<td>string</td>
<td>%name%不能为null值</td>
<td>-</td>
</tr>
</tbody>
</table><h3>方法</h3>

<h4>isNull($input)</h4>

<p>检查数据是否为null</p>
  </section>

<!-- api/isNumber
  ================================================== -->
  <section id="isNumber">
  <div class="page-header"><h1>isNumber</h1></div>

<p>检查数据是否为有效数字</p>

<h2>案例</h2>

<h3>检查-123.4是否为数字</h3>

<div class="highlight"><pre><code class="php"><span class="k">if</span> <span class="p">(</span><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">isNumber</span><span class="p">(</span><span class="o">-</span><span class="mf">123.4</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'Yes'</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'No'</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<h4>运行结果</h4>

<div class="highlight"><pre><code class="php"><span class="s1">'Yes'</span>
</code></pre></div>

<h2>调用方式</h2>

<h3>选项</h3>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>notNumberMessage</td>
<td>string</td>
<td>%name%必须是有效的数字</td>
<td>-</td>
</tr>
<tr>
<td>negativeMessage</td>
<td>string</td>
<td>%name%不能是数字</td>
<td>-</td>
</tr>
</tbody>
</table><h3>方法</h3>

<h4>isNumber($input)</h4>

<p>检查数据是否为有效数字</p>
  </section>

<!-- api/isPresent
  ================================================== -->
  <section id="isPresent">
  <div class="page-header"><h1>isPresent</h1></div>

<p>检查数据是否为空(允许空格)</p>

<h2>案例</h2>

<h3>检查"abc"是否不为空</h3>

<div class="highlight"><pre><code class="php"><span class="k">if</span> <span class="p">(</span><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">isPresent</span><span class="p">(</span><span class="s1">'abc'</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'Yes'</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'No'</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<h4>运行结果</h4>

<div class="highlight"><pre><code class="php"><span class="s1">'Yes'</span>
</code></pre></div>

<h3>检查空格字符串是否不为空</h3>

<div class="highlight"><pre><code class="php"><span class="k">if</span> <span class="p">(</span><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">isPresent</span><span class="p">(</span><span class="s1">' '</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'Yes'</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'No'</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<h4>运行结果</h4>

<div class="highlight"><pre><code class="php"><span class="s1">'Yes'</span>
</code></pre></div>

<h2>调用方式</h2>

<h3>选项</h3>

<p><em>无</em></p>

<h3>错误信息</h3>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>信息</th>
</tr></thead>
<tbody>
<tr>
<td>emptyMessage</td>
<td>%name%必须为空</td>
</tr>
<tr>
<td>negativeMessage</td>
<td>%name%不能为空</td>
</tr>
</tbody>
</table><h3>方法</h3>

<h4>isPresent($input)</h4>

<p>检查数据是否不为空(允许空格)</p>
  </section>

<!-- api/isRegex
  ================================================== -->
  <section id="isRegex">
  <div class="page-header"><h1>isRegex</h1></div>

<p>检查数据是否匹配指定的正则表达式</p>

<h2>案例</h2>

<h3>检查"abc"是否匹配正则表达式"/d/i"</h3>

<div class="highlight"><pre><code class="php"><span class="k">if</span> <span class="p">(</span><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">isRegex</span><span class="p">(</span><span class="s1">'abc'</span><span class="p">,</span> <span class="s1">'/d/i'</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'Yes'</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'No'</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<h4>运行结果</h4>

<div class="highlight"><pre><code class="php"><span class="s1">'No'</span>
</code></pre></div>

<h2>调用方式</h2>

<h3>选项</h3>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>notStringMessage</td>
<td>string</td>
<td>%name%必须是字符串</td>
<td>-</td>
</tr>
<tr>
<td>patternMessage</td>
<td>string</td>
<td>%name%必须匹配模式"%pattern%"</td>
<td>-</td>
</tr>
<tr>
<td>negativeMessage</td>
<td>string</td>
<td>%name%必须不匹配模式"%pattern%"</td>
<td>-</td>
</tr>
</tbody>
</table><h3>方法</h3>

<h4>isRegex($input)</h4>

<p>检查数据是否匹配指定的正则表达式</p>

<p><strong>返回:</strong> <code>bool</code> 检查结果</p>

<p><strong>参数</strong></p>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr></thead>
<tbody><tr>
<td>$input</td>
<td>string</td>
<td>要检查的数据</td>
</tr></tbody>
</table>
  </section>

<!-- api/isRequired
  ================================================== -->
  <section id="isRequired">
  <div class="page-header"><h1>isRequired</h1></div>

<p>检查数据是否为空</p>

<p>检查以下值会返回false,其他值(包括0)均返回true</p>

<ul>
<li>null</li>
<li>'' (空字符串)</li>
<li>false</li>
<li>array() (空数组)</li>
</ul><h2>案例</h2>

<h3>检查null是否为空</h3>

<div class="highlight"><pre><code class="php"><span class="k">if</span> <span class="p">(</span><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">isRequired</span><span class="p">(</span><span class="k">null</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'Yes'</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'No'</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<h4>运行结果</h4>

<div class="highlight"><pre><code class="php"><span class="s1">'No'</span>
</code></pre></div>

<h3>检查0是否为空</h3>

<div class="highlight"><pre><code class="php"><span class="k">if</span> <span class="p">(</span><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">isRequired</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'Yes'</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'No'</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<h4>运行结果</h4>

<div class="highlight"><pre><code class="php"><span class="s1">'No'</span>
</code></pre></div>

<h2>调用方式</h2>

<h3>选项</h3>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>requiredMessage</td>
<td>string</td>
<td>%name%不能为空</td>
<td>-</td>
</tr>
<tr>
<td>negativeMessage</td>
<td>string</td>
<td>%name%不合法</td>
<td>-</td>
</tr>
</tbody>
</table><h3>方法</h3>

<h4>isRequired($input, $required = true)</h4>

<p>检查数据是否为空</p>
  </section>

<!-- api/isStartsWith
  ================================================== -->
  <section id="isStartsWith">
  <div class="page-header"><h1>isStartsWith</h1></div>

<p>检查数据是否以指定字符串开头</p>

<h2>案例</h2>

<h3>检查"abc"是否以"C"开头</h3>

<div class="highlight"><pre><code class="php"><span class="k">if</span> <span class="p">(</span><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">isEndsWith</span><span class="p">(</span><span class="s1">'abc'</span><span class="p">,</span> <span class="s1">'C'</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'Yes'</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'No'</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<h4>运行结果</h4>

<div class="highlight"><pre><code class="php"><span class="s1">'Yes'</span>
</code></pre></div>

<h3>以区分大小写的方式,检查"abc"是否以"C"开头</h3>

<div class="highlight"><pre><code class="php"><span class="k">if</span> <span class="p">(</span><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">isEndsWith</span><span class="p">(</span><span class="s1">'abc'</span><span class="p">,</span> <span class="s1">'C'</span><span class="p">,</span> <span class="k">true</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'Yes'</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'No'</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<h4>运行结果</h4>

<div class="highlight"><pre><code class="php"><span class="s1">'No'</span>
</code></pre></div>

<h3>检查"abc"是否以数组array('a', 'b', 'c')中的任意元素开头</h3>

<div class="highlight"><pre><code class="php"><span class="k">if</span> <span class="p">(</span><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">isEndsWith</span><span class="p">(</span><span class="s1">'abc'</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">'a'</span><span class="p">,</span> <span class="s1">'b'</span><span class="p">,</span> <span class="s1">'c'</span><span class="p">)))</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'Yes'</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'No'</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<h4>运行结果</h4>

<div class="highlight"><pre><code class="php"><span class="s1">'Yes'</span>
</code></pre></div>

<h2>调用方式</h2>

<h3>选项</h3>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>findMe</td>
<td>string,array</td>
<td>-</td>
<td>要查找的字符串.如果是数组,只要数据以数组中任何一个元素开头就算验证通过</td>
</tr>
<tr>
<td>case</td>
<td>bool</td>
<td>false</td>
<td>查找时是否区分大小写</td>
</tr>
<tr>
<td>notStringMessage</td>
<td>string</td>
<td>%name%必须是字符串</td>
<td>-</td>
</tr>
<tr>
<td>notFoundMessage</td>
<td>string</td>
<td>%name%必须以%findMe%开头</td>
<td>-</td>
</tr>
<tr>
<td>negativeMessage</td>
<td>string</td>
<td>%name%不能以%findMe%开头</td>
<td>-</td>
</tr>
</tbody>
</table><h3>方法</h3>

<h4>isStartsWith($input, $findMe, $case = false)</h4>

<p>检查数据是否以指定字符串开头</p>
  </section>

<!-- api/isType
  ================================================== -->
  <section id="isType">
  <div class="page-header"><h1>isType</h1></div>

<p>检查数据是否为指定的类型</p>

<h2>案例</h2>

<h3>检查"abc"是否为字符串</h3>

<div class="highlight"><pre><code class="php"><span class="k">if</span> <span class="p">(</span><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">isType</span><span class="p">(</span><span class="s1">'abc'</span><span class="p">,</span> <span class="s1">'string'</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'Yes'</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'No'</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<h4>运行结果</h4>

<div class="highlight"><pre><code class="php"><span class="s1">'Yes'</span>
</code></pre></div>

<h3>检查new ArrayObject()是否为Traversable类型</h3>

<div class="highlight"><pre><code class="php"><span class="k">if</span> <span class="p">(</span><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">isType</span><span class="p">(</span><span class="k">new</span> <span class="nx">ArrayObject</span><span class="p">(),</span> <span class="s1">'Traversable'</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'Yes'</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'No'</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<h4>运行结果</h4>

<div class="highlight"><pre><code class="php"><span class="s1">'Yes'</span>
</code></pre></div>

<h2>调用方式</h2>

<h3>选项</h3>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>type</td>
<td>string</td>
<td>无</td>
<td>数据的类型,可选值见下表</td>
</tr>
<tr>
<td>typeMessage</td>
<td>string</td>
<td>%name%必须是%typeName%</td>
<td>-</td>
</tr>
<tr>
<td>negativeMessage</td>
<td>string</td>
<td>%name%不能是%typeName%</td>
<td>-</td>
</tr>
</tbody>
</table><p>如果<code>type</code>的值不在下表中,将检查数据是否为<code>type</code>的实例化对象($input instanceof $type)</p>

<table class="table table-bordered table-striped">
<thead><tr>
<th>值</th>
<th>名称</th>
<th>值</th>
<th>名称</th>
</tr></thead>
<tbody>
<tr>
<td>array</td>
<td>数组</td>
<td>alnum</td>
<td>字母(a-z)或数字(0-9)</td>
</tr>
<tr>
<td>bool</td>
<td>布尔</td>
<td>alpha</td>
<td>字母</td>
</tr>
<tr>
<td>float</td>
<td>浮点数</td>
<td>cntrl</td>
<td>控制字符</td>
</tr>
<tr>
<td>int</td>
<td>整型</td>
<td>digit</td>
<td>数字</td>
</tr>
<tr>
<td>integer</td>
<td>整型</td>
<td>graph</td>
<td>可显示字符</td>
</tr>
<tr>
<td>null</td>
<td>NULL</td>
<td>lower</td>
<td>小写字母(a-z)</td>
</tr>
<tr>
<td>numeric</td>
<td>数字</td>
<td>print</td>
<td>可打印字符</td>
</tr>
<tr>
<td>object</td>
<td>对象</td>
<td>punct</td>
<td>标点符号</td>
</tr>
<tr>
<td>resource</td>
<td>资源</td>
<td>space</td>
<td>空白字符</td>
</tr>
<tr>
<td>scalar</td>
<td>标量</td>
<td>upper</td>
<td>大写字母(A-Z)</td>
</tr>
<tr>
<td>string</td>
<td>字符串</td>
<td>xdigit</td>
<td>16进制数字</td>
</tr>
</tbody>
</table><h3>方法</h3>

<h4>isType($input, $type)</h4>

<p>检查数据是否为指定的类型</p>
  </section>

<!-- api/isUppercase
  ================================================== -->
  <section id="isUppercase">
  <div class="page-header"><h1>isUppercase</h1></div>

<p>检查数据是否为大写字符</p>

<h2>案例</h2>

<h3>检查"abc"是否为大写字符</h3>

<div class="highlight"><pre><code class="php"><span class="k">if</span> <span class="p">(</span><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">isLowercase</span><span class="p">(</span><span class="s1">'abc'</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'Yes'</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'No'</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<h4>运行结果</h4>

<div class="highlight"><pre><code class="php"><span class="s1">'Yes'</span>
</code></pre></div>

<h2>调用方式</h2>

<h3>选项</h3>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>notStringMessage</td>
<td>string</td>
<td>%name%必须是字符串</td>
<td>-</td>
</tr>
<tr>
<td>invalidMessage</td>
<td>string</td>
<td>%name%不能包含小写字母</td>
<td>-</td>
</tr>
<tr>
<td>negativeMessage</td>
<td>string</td>
<td>%name%不能包含大写字母</td>
<td>-</td>
</tr>
</tbody>
</table><h3>方法</h3>

<h4>isUppercase($input)</h4>

<p>检查数据是否为大写字符</p>
  </section>

<!-- api/isLength
  ================================================== -->
  <section id="isLength">
  <div class="page-header"><h1>isLength</h1></div>

<p>检查数据的长度是否为指定的数值,或在指定的长度范围内</p>

<h2>案例</h2>

<h3>检查"abc"的长度是否为3</h3>

<div class="highlight"><pre><code class="php"><span class="k">if</span> <span class="p">(</span><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">isLength</span><span class="p">(</span><span class="s1">'abc'</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'Yes'</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'No'</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<h4>运行结果</h4>

<div class="highlight"><pre><code class="php"><span class="s1">'Yes'</span>
</code></pre></div>

<h3>检查"abc"的长度是否在3到6之间</h3>

<div class="highlight"><pre><code class="php"><span class="k">if</span> <span class="p">(</span><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">isLength</span><span class="p">(</span><span class="s1">'abc'</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'Yes'</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'No'</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<h4>运行结果</h4>

<div class="highlight"><pre><code class="php"><span class="s1">'Yes'</span>
</code></pre></div>

<h2>调用方式</h2>

<h3>选项</h3>

<p><em>见方法</em></p>

<h3>方法</h3>

<h4>isLength($input, $min, $max)</h4>

<p>检查数据的长度是否在指定的长度范围内</p>

<h5>选项</h5>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>min</td>
<td>int</td>
<td>无</td>
<td>限制长度的最小值</td>
</tr>
<tr>
<td>max</td>
<td>int</td>
<td>无</td>
<td>限制长度的最大值</td>
</tr>
<tr>
<td>notDetectdMessage</td>
<td>string</td>
<td>无法检测到%name%的长度</td>
<td>-</td>
</tr>
<tr>
<td>notInMessage</td>
<td>string</td>
<td>%name%的长度必须在%min%和%max%之间</td>
<td>-</td>
</tr>
<tr>
<td>notInItemMessage</td>
<td>string</td>
<td>%name%必须包含%min%到%max%项</td>
<td>-</td>
</tr>
</tbody>
</table><div class="highlight"><pre><code class="php"><span class="err">注意</span><span class="o">:</span> <span class="err">当检查的数据是字符串时</span><span class="p">,</span><span class="err">返回的错误信息是</span><span class="sb">`notIn`</span><span class="p">,</span><span class="err">当数据是数组时</span><span class="p">,</span><span class="err">返回的是</span><span class="sb">`notInItem`</span>
</code></pre></div>

<h4>isLength($input, $length)</h4>

<p>检查数据的长度是否为指定的数值</p>

<h5>选项</h5>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>length</td>
<td>int</td>
<td>无</td>
<td>指定长度的值</td>
</tr>
<tr>
<td>notDetectdMessage</td>
<td>string</td>
<td>无法检测到%name%的长度</td>
<td>-</td>
</tr>
<tr>
<td>lengthMessage</td>
<td>string</td>
<td>%name%的长度必须是%length%</td>
<td>-</td>
</tr>
<tr>
<td>lengthItemMessage</td>
<td>string</td>
<td>%name%必须包含%length%项</td>
<td>-</td>
</tr>
</tbody>
</table><div class="highlight"><pre><code class="php"><span class="err">注意</span><span class="o">:</span> <span class="err">当检查的数据是字符串时</span><span class="p">,</span><span class="err">返回的错误信息是</span><span class="sb">`length`</span><span class="p">,</span><span class="err">当数据是数组时</span><span class="p">,</span><span class="err">返回的是</span><span class="sb">`lengthItem`</span>
</code></pre></div>
  </section>

<!-- api/isCharLength
  ================================================== -->
  <section id="isCharLength">
  <div class="page-header"><h1>isCharLength</h1></div>

<p>检查数据的 <strong>字符数</strong> 是否为指定的数值</p>

<h2>案例</h2>

<h3>检查"微框架"的长度是否为3</h3>

<div class="highlight"><pre><code class="php"><span class="k">if</span> <span class="p">(</span><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">isCharLength</span><span class="p">(</span><span class="s1">'微框架'</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'Yes'</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'No'</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<h4>运行结果</h4>

<div class="highlight"><pre><code class="php"><span class="s1">'Yes'</span>
</code></pre></div>

<h3>检查"微框架"的长度是否在3到6之间</h3>

<div class="highlight"><pre><code class="php"><span class="k">if</span> <span class="p">(</span><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">isCharLength</span><span class="p">(</span><span class="s1">'微框架'</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'Yes'</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'No'</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<h4>运行结果</h4>

<div class="highlight"><pre><code class="php"><span class="s1">'Yes'</span>
</code></pre></div>

<h2>调用方式</h2>

<h3>选项</h3>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody><tr>
<td>charset</td>
<td>string</td>
<td>UTF-8</td>
<td>验证数据的字符集</td>
</tr></tbody>
</table><h3>方法</h3>

<h4>isCharLength($input, $min, $max)</h4>

<p>检查数据的字符数是否在指定的长度范围内</p>

<h5>选项</h5>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>min</td>
<td>int</td>
<td>无</td>
<td>限制长度的最小值</td>
</tr>
<tr>
<td>max</td>
<td>int</td>
<td>无</td>
<td>限制长度的最大值</td>
</tr>
<tr>
<td>notDetectdMessage</td>
<td>string</td>
<td>无法检测到%name%的长度</td>
<td>-</td>
</tr>
<tr>
<td>notInMessage</td>
<td>string</td>
<td>%name%的长度必须在%min%和%max%之间</td>
<td>-</td>
</tr>
</tbody>
</table><h4>isCharLength($input, $length)</h4>

<p>检查数据的字符数是否为指定的数值</p>

<h5>选项</h5>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>length</td>
<td>int</td>
<td>无</td>
<td>指定长度的值</td>
</tr>
<tr>
<td>notDetectdMessage</td>
<td>string</td>
<td>无法检测到%name%的长度</td>
<td>-</td>
</tr>
<tr>
<td>lengthMessage</td>
<td>string</td>
<td>%name%的长度必须是%length%</td>
<td>-</td>
</tr>
</tbody>
</table>
  </section>

<!-- api/isMaxLength
  ================================================== -->
  <section id="isMaxLength">
  <div class="page-header"><h1>isMaxLength</h1></div>

<p>检查数据的长度是否小于等于指定数值</p>

<h2>案例</h2>

<h3>检查"abc"的长度是否小于等于2</h3>

<div class="highlight"><pre><code class="php"><span class="k">if</span> <span class="p">(</span><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">isMaxLength</span><span class="p">(</span><span class="s1">'abc'</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'Yes'</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'No'</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<h4>运行结果</h4>

<div class="highlight"><pre><code class="php"><span class="s1">'No'</span>
</code></pre></div>

<h3>选项</h3>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>max</td>
<td>int</td>
<td>无</td>
<td>待比较的数值</td>
</tr>
<tr>
<td>notDetectdMessage</td>
<td>string</td>
<td>无法检测到%name%的长度</td>
<td>-</td>
</tr>
<tr>
<td>tooLongMessage</td>
<td>string</td>
<td>%name%的长度必须小于等于%max%</td>
<td>当数据为字符串时出现</td>
</tr>
<tr>
<td>tooManayMessage</td>
<td>string</td>
<td>%name%最多包含%max%项</td>
<td>当数据为数组时出现</td>
</tr>
<tr>
<td>negativeMessage</td>
<td>string</td>
<td>%name%不合法</td>
<td>-</td>
</tr>
</tbody>
</table><h3>方法</h3>

<h4>isMaxLength($input, $max)</h4>

<p>检查数据的长度是否小于等于指定数值</p>
  </section>

<!-- api/isMinLength
  ================================================== -->
  <section id="isMinLength">
  <div class="page-header"><h1>isMinLength</h1></div>

<p>检查数据的长度是否大于等于指定数值</p>

<h2>案例</h2>

<h3>检查"abc"的长度是否大于等于2</h3>

<div class="highlight"><pre><code class="php"><span class="k">if</span> <span class="p">(</span><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">isMinLength</span><span class="p">(</span><span class="s1">'abc'</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'Yes'</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'No'</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<h4>运行结果</h4>

<div class="highlight"><pre><code class="php"><span class="s1">'Yes'</span>
</code></pre></div>

<h2>调用方式</h2>

<h3>选项</h3>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>max</td>
<td>int</td>
<td>无</td>
<td>待比较的数值</td>
</tr>
<tr>
<td>notDetectdMessage</td>
<td>string</td>
<td>无法检测到%name%的长度</td>
<td>-</td>
</tr>
<tr>
<td>tooShortMessage</td>
<td>string</td>
<td>%name%的长度必须大于等于%min%</td>
<td>当数据为字符串时出现</td>
</tr>
<tr>
<td>tooFewMessage</td>
<td>string</td>
<td>%name%至少需要包括%min%项</td>
<td>当数据为数组时出现</td>
</tr>
<tr>
<td>negativeMessage</td>
<td>string</td>
<td>%name%不合法</td>
<td>-</td>
</tr>
</tbody>
</table><h3>方法</h3>

<h4>isMinLength($input, $min)</h4>

<p>检查数据的长度是否大于等于指定数值</p>
  </section>

<!-- api/isEqualTo
  ================================================== -->
  <section id="isEqualTo">
  <div class="page-header"><h1>isEqualTo</h1></div>

<p>检查数据是否等于(==)指定的值</p>

<h2>案例</h2>

<h3>检查指定的两个值是否相等</h3>

<div class="highlight"><pre><code class="php"><span class="nv">$post</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">'password'</span> <span class="o">=&gt;</span> <span class="s1">'123456'</span><span class="p">,</span>
    <span class="s1">'password_confirmation'</span> <span class="o">=&gt;</span> <span class="s1">'123456'</span><span class="p">,</span>
<span class="p">);</span>

<span class="k">if</span> <span class="p">(</span><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">isEqualTo</span><span class="p">(</span><span class="nv">$post</span><span class="p">[</span><span class="s1">'password'</span><span class="p">],</span> <span class="nv">$post</span><span class="p">[</span><span class="s1">'password_confirmation'</span><span class="p">]))</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'Yes'</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'No'</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<h4>运行结果</h4>

<div class="highlight"><pre><code class="php"><span class="s1">'Yes'</span>
</code></pre></div>

<h2>调用方式</h2>

<h3>选项</h3>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>value</td>
<td>mixed</td>
<td>无</td>
<td>与数据比较的值</td>
</tr>
<tr>
<td>invalidMessage</td>
<td>string</td>
<td>%name%必须等于%value%</td>
<td>-</td>
</tr>
<tr>
<td>negativeMessage</td>
<td>string</td>
<td>%name%不能等于%value%</td>
<td>-</td>
</tr>
</tbody>
</table><h3>方法</h3>

<h4>isEqualTo($input, $value)</h4>

<p>检查数据是否等于(==)指定的值</p>
  </section>

<!-- api/isIdenticalTo
  ================================================== -->
  <section id="isIdenticalTo">
  <div class="page-header"><h1>isIdenticalTo</h1></div>

<p>检查数据是否完全等于(===)指定的值</p>

<h2>案例</h2>

<h3>检查指定的两个值是否完全相等</h3>

<div class="highlight"><pre><code class="php"><span class="nv">$post</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">'password'</span> <span class="o">=&gt;</span> <span class="s1">'123456'</span><span class="p">,</span>
    <span class="s1">'password_confirmation'</span> <span class="o">=&gt;</span> <span class="s1">'123456'</span><span class="p">,</span>
<span class="p">);</span>

<span class="k">if</span> <span class="p">(</span><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">isIdenticalTo</span><span class="p">(</span><span class="nv">$post</span><span class="p">[</span><span class="s1">'password'</span><span class="p">],</span> <span class="nv">$post</span><span class="p">[</span><span class="s1">'password_confirmation'</span><span class="p">]))</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'Yes'</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'No'</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<h4>运行结果</h4>

<div class="highlight"><pre><code class="php"><span class="s1">'Yes'</span>
</code></pre></div>

<h3>检查<code>0</code>和<code>false</code>是否完全相等</h3>

<div class="highlight"><pre><code class="php"><span class="k">if</span> <span class="p">(</span><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">isIdenticalTo</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="k">false</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'Yes'</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'No'</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<h4>运行结果</h4>

<div class="highlight"><pre><code class="php"><span class="s1">'No'</span>
</code></pre></div>

<h2>调用方式</h2>

<h3>选项</h3>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>value</td>
<td>mixed</td>
<td>无</td>
<td>与数据比较的值</td>
</tr>
<tr>
<td>invalidMessage</td>
<td>string</td>
<td>%name%必须等于%value%</td>
<td>-</td>
</tr>
<tr>
<td>negativeMessage</td>
<td>string</td>
<td>%name%不能等于%value%</td>
<td>-</td>
</tr>
</tbody>
</table><h3>方法</h3>

<h4>isIdenticalTo($input, $value)</h4>

<p>检查数据是否完全等于(===)指定的值</p>
  </section>

<!-- api/isGreaterThan
  ================================================== -->
  <section id="isGreaterThan">
  <div class="page-header"><h1>isGreaterThan</h1></div>

<p>检查数据是否大于(&gt;)指定的值</p>

<h2>案例</h2>

<h3>检查10是否大于20</h3>

<div class="highlight"><pre><code class="php"><span class="k">if</span> <span class="p">(</span><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">isGreaterThan</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'Yes'</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'No'</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<h4>运行结果</h4>

<div class="highlight"><pre><code class="php"><span class="s1">'No'</span>
</code></pre></div>

<h2>调用方式</h2>

<h3>选项</h3>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>value</td>
<td>mixed</td>
<td>无</td>
<td>待比较的数值</td>
</tr>
<tr>
<td>invalidMessage</td>
<td>string</td>
<td>%name%必须大于等于%value%</td>
<td>-</td>
</tr>
<tr>
<td>negativeMessage</td>
<td>string</td>
<td>%name%不合法</td>
<td>-</td>
</tr>
</tbody>
</table><h3>方法</h3>

<h4>isGreaterThan($input, $value)</h4>

<p>检查数据是否大于(&gt;)指定的值</p>
  </section>

<!-- api/isGreaterThanOrEqual
  ================================================== -->
  <section id="isGreaterThanOrEqual">
  <div class="page-header"><h1>isGreaterThanOrEqual</h1></div>

<p>检查数据是否大于等于(&gt;=)指定的值</p>

<h2>案例</h2>

<h3>检查10是否大于等于20</h3>

<div class="highlight"><pre><code class="php"><span class="k">if</span> <span class="p">(</span><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">isGreaterThanOrEqual</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'Yes'</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'No'</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<h4>运行结果</h4>

<div class="highlight"><pre><code class="php"><span class="s1">'No'</span>
</code></pre></div>

<h2>调用方式</h2>

<h3>选项</h3>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>value</td>
<td>mixed</td>
<td>无</td>
<td>待比较的数值</td>
</tr>
<tr>
<td>invalidMessage</td>
<td>string</td>
<td>%name%必须大于等于%value%</td>
<td>-</td>
</tr>
<tr>
<td>negativeMessage</td>
<td>string</td>
<td>%name%不合法</td>
<td>-</td>
</tr>
</tbody>
</table><h3>方法</h3>

<h4>isGreaterThanOrEqual($input, $value)</h4>

<p>检查数据是否大于等于(&gt;=)指定的值</p>
  </section>

<!-- api/isLessThan
  ================================================== -->
  <section id="isLessThan">
  <div class="page-header"><h1>isLessThan</h1></div>

<p>检查数据是否小于(&lt;)指定的值</p>

<h2>案例</h2>

<h3>检查10是否小于20</h3>

<div class="highlight"><pre><code class="php"><span class="k">if</span> <span class="p">(</span><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">isLessThan</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'Yes'</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'No'</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<h4>运行结果</h4>

<div class="highlight"><pre><code class="php"><span class="s1">'Yes'</span>
</code></pre></div>

<h2>调用方式</h2>

<h3>选项</h3>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>value</td>
<td>mixed</td>
<td>无</td>
<td>待比较的数值</td>
</tr>
<tr>
<td>invalidMessage</td>
<td>string</td>
<td>%name%必须小于等于%max%</td>
<td>-</td>
</tr>
<tr>
<td>negativeMessage</td>
<td>string</td>
<td>%name%必须不小于等于%max%</td>
<td>-</td>
</tr>
</tbody>
</table><h3>方法</h3>

<h4>isLessThan($input, $value)</h4>

<p>检查数据是否小于(&lt;)指定的值</p>
  </section>

<!-- api/isLessThanOrEqual
  ================================================== -->
  <section id="isLessThanOrEqual">
  <div class="page-header"><h1>isLessThanOrEqual</h1></div>

<p>检查数据是否小于等于(&lt;=)指定的值</p>

<h2>案例</h2>

<h3>检查10是否小于等于20</h3>

<div class="highlight"><pre><code class="php"><span class="k">if</span> <span class="p">(</span><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">isLessThanOrEqual</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'Yes'</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'No'</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<h4>运行结果</h4>

<div class="highlight"><pre><code class="php"><span class="s1">'Yes'</span>
</code></pre></div>

<h2>调用方式</h2>

<h3>选项</h3>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>value</td>
<td>mixed</td>
<td>无</td>
<td>待比较的数值</td>
</tr>
<tr>
<td>invalidMessage</td>
<td>string</td>
<td>%name%必须小于等于%max%</td>
<td>-</td>
</tr>
<tr>
<td>negativeMessage</td>
<td>string</td>
<td>%name%必须不小于等于%max%</td>
<td>-</td>
</tr>
</tbody>
</table><h3>方法</h3>

<h4>isLessThanOrEqual($input, $value)</h4>

<p>检查数据是否在指定的两个值之间</p>
  </section>

<!-- api/isBetween
  ================================================== -->
  <section id="isBetween">
  <div class="page-header"><h1>isBetween</h1></div>

<p>检查数据是否在指定的两个值之间,不包含值本身($min &lt; $input &lt; $max)</p>

<h2>案例</h2>

<h3>检查18是否在1到10之间</h3>

<div class="highlight"><pre><code class="php"><span class="k">if</span> <span class="p">(</span><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">isBetween</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'Yes'</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'No'</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<h4>运行结果</h4>

<div class="highlight"><pre><code class="php"><span class="s1">'No'</span>
</code></pre></div>

<h2>调用方式</h2>

<h3>选项</h3>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>min</td>
<td>int</td>
<td>无</td>
<td>用于比较的较小值</td>
</tr>
<tr>
<td>max</td>
<td>int</td>
<td>无</td>
<td>用于比较的较大值</td>
</tr>
<tr>
<td>notStringMessage</td>
<td>string</td>
<td>%name%必须是字符串</td>
<td>-</td>
</tr>
<tr>
<td>betweenMessage</td>
<td>string</td>
<td>%name%必须在%min%到%max%之间</td>
<td>-</td>
</tr>
<tr>
<td>negativeMessage</td>
<td>string</td>
<td>%name%不能在%min%到%max%之间</td>
<td>-</td>
</tr>
</tbody>
</table><h3>方法</h3>

<h4>isBetween($input, $min, $max)</h4>

<p>检查数据是否在指定的两个值之间</p>
  </section>

<!-- api/isDate
  ================================================== -->
  <section id="isDate">
  <div class="page-header"><h1>isDate</h1></div>

<p>检查数据是否为合法的日期</p>

<h2>案例</h2>

<h3>检查"2013-01-01"是否为合法的日期</h3>

<div class="highlight"><pre><code class="php"><span class="k">if</span> <span class="p">(</span><span class="nx">wei</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">isDate</span><span class="p">(</span><span class="s1">'2013-01-01'</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'Yes'</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'No'</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<h4>运行结果</h4>

<div class="highlight"><pre><code class="php"><span class="s1">'Yes'</span>
</code></pre></div>

<h3>检查"2046-01-01"是否在今天之前(不包含今天)</h3>

<div class="highlight"><pre><code class="php"><span class="k">if</span> <span class="p">(</span><span class="nx">wei</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">isDate</span><span class="p">(</span><span class="s1">'2046-01-01'</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">'before'</span> <span class="o">=&gt;</span> <span class="nb">date</span><span class="p">(</span><span class="s1">'Y-m-d'</span><span class="p">))))</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'Yes'</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'No'</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<h4>运行结果</h4>

<div class="highlight"><pre><code class="php"><span class="s1">'No'</span>
</code></pre></div>

<h3>检查"2046-01-01"是否在今天之后(不包含今天)</h3>

<div class="highlight"><pre><code class="php"><span class="k">if</span> <span class="p">(</span><span class="nx">wei</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">isDate</span><span class="p">(</span><span class="s1">'2046-01-01'</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">'after'</span> <span class="o">=&gt;</span> <span class="nb">date</span><span class="p">(</span><span class="s1">'Y-m-d'</span><span class="p">))))</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'Yes'</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'No'</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<h4>运行结果</h4>

<div class="highlight"><pre><code class="php"><span class="s1">'Yes'</span>
</code></pre></div>

<h2>调用方式</h2>

<h3>选项</h3>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>format</td>
<td>string</td>
<td>Y-m-d</td>
<td>用于匹配数据的日期格式</td>
</tr>
<tr>
<td>before</td>
<td>string</td>
<td>无</td>
<td>输入的日期应该早于<code>before</code>的值</td>
</tr>
<tr>
<td>after</td>
<td>string</td>
<td>无</td>
<td>输入的日期应该晚于<code>after</code>的值</td>
</tr>
</tbody>
</table><p>完整的日期格式可以查看PHP官方文档中关于<a href="http://php.net/manual/zh/function.date.php" target="_blank">date</a>函数的格式说明.</p>

<h3>错误信息</h3>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>信息</th>
</tr></thead>
<tbody>
<tr>
<td>notStringMessage</td>
<td>%name%必须是字符串</td>
</tr>
<tr>
<td>invalidMessage</td>
<td>%name%必须是合法的日期时间(当日期无法解析时出现)</td>
</tr>
<tr>
<td>formatMessage</td>
<td>%name%不是合法的日期,格式应该是%format%,例如:%example%</td>
</tr>
<tr>
<td>tooEarlyMessage</td>
<td>%name%必须晚于%after%</td>
</tr>
<tr>
<td>tooLateMessage</td>
<td>%name%必须早于%before%</td>
</tr>
<tr>
<td>negativeMessage</td>
<td>%name%不能是合法的日期</td>
</tr>
</tbody>
</table><h3>方法</h3>

<h4>isDate($input, $format = 'Y-m-d')</h4>

<p>检查数据是否为合法的日期</p>

<h4>isDate($input, $options = array())</h4>

<p>检查数据是否为合法的日期,第二个参数为选项数组</p>
  </section>

<!-- api/isDateTime
  ================================================== -->
  <section id="isDateTime">
  <div class="page-header"><h1>isDateTime</h1></div>

<p>检查数据是否为合法的日期时间</p>

<h2>案例</h2>

<h3>检查"2013-01-01 10:00"是否为合法的日期时间</h3>

<div class="highlight"><pre><code class="php"><span class="k">if</span> <span class="p">(</span><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">isDateTime</span><span class="p">(</span><span class="s1">'2013-01-01 10:00'</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'Yes'</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'No'</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<h4>运行结果</h4>

<div class="highlight"><pre><code class="php"><span class="s1">'Yes'</span>
</code></pre></div>

<h3>检查"2013-01-01"是否为符合格式"Ymd"的日期时间</h3>

<div class="highlight"><pre><code class="php"><span class="k">if</span> <span class="p">(</span><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">isDateTime</span><span class="p">(</span><span class="s1">'20130101'</span><span class="p">,</span> <span class="s1">'Ymd'</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'Yes'</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'No'</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<h4>运行结果</h4>

<div class="highlight"><pre><code class="php"><span class="s1">'Yes'</span>
</code></pre></div>

<h2>调用方式</h2>

<h3>选项</h3>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>format</td>
<td>string</td>
<td>Y-m-d H:i:s</td>
<td>日期时间格式</td>
</tr>
<tr>
<td>notStringMessage</td>
<td>string</td>
<td>%name%必须是字符串</td>
<td>-</td>
</tr>
<tr>
<td>invalidMessage</td>
<td>string</td>
<td>%name%必须是合法的日期时间</td>
<td>当日期无法解析时出现</td>
</tr>
<tr>
<td>formatMessage</td>
<td>string</td>
<td>%name%不是合法的日期,格式应该是%format%,例如:%example%</td>
<td>-</td>
</tr>
<tr>
<td>tooEarlyMessage</td>
<td>string</td>
<td>%name%必须晚于%after%</td>
<td>-</td>
</tr>
<tr>
<td>tooLateMessage</td>
<td>string</td>
<td>%name%必须早于%before%</td>
<td>-</td>
</tr>
<tr>
<td>negativeMessage</td>
<td>string</td>
<td>%name%不能是合法的日期</td>
<td>-</td>
</tr>
</tbody>
</table><p>完整的日期格式可以查看PHP官方文档中关于<a href="http://php.net/manual/zh/function.date.php" target="_blank">date</a>函数的格式说明. </p>

<h3>方法</h3>

<h4>isDateTime($input, $format = 'Y-m-d H:i:s')</h4>

<p>检查数据是否为合法的日期时间</p>
  </section>

<!-- api/isTime
  ================================================== -->
  <section id="isTime">
  <div class="page-header"><h1>isTime</h1></div>

<p>检查数据是否为合法的时间</p>

<h2>案例</h2>

<h3>检查"12:00:00"是否为合法的时间</h3>

<div class="highlight"><pre><code class="php"><span class="k">if</span> <span class="p">(</span><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">isTime</span><span class="p">(</span><span class="s1">'12:00:00'</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'Yes'</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'No'</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<h4>运行结果</h4>

<div class="highlight"><pre><code class="php"><span class="s1">'Yes'</span>
</code></pre></div>

<h3>检查"12:00"是否为符合格式"i:s"的时间</h3>

<div class="highlight"><pre><code class="php"><span class="k">if</span> <span class="p">(</span><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">isTime</span><span class="p">(</span><span class="s1">'12:00'</span><span class="p">,</span> <span class="s1">'i:s'</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'Yes'</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'No'</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<h4>运行结果</h4>

<div class="highlight"><pre><code class="php"><span class="s1">'Yes'</span>
</code></pre></div>

<h2>调用方式</h2>

<h3>选项</h3>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>format</td>
<td>string</td>
<td>H:i:s</td>
<td>日期格式</td>
</tr>
<tr>
<td>notStringMessage</td>
<td>string</td>
<td>%name%必须是字符串</td>
<td>-</td>
</tr>
<tr>
<td>invalidMessage</td>
<td>string</td>
<td>%name%必须是合法的日期时间</td>
<td>当日期无法解析时出现</td>
</tr>
<tr>
<td>formatMessage</td>
<td>string</td>
<td>%name%不是合法的日期,格式应该是%format%,例如:%example%</td>
<td>-</td>
</tr>
<tr>
<td>tooEarlyMessage</td>
<td>string</td>
<td>%name%必须晚于%after%</td>
<td>-</td>
</tr>
<tr>
<td>tooLateMessage</td>
<td>string</td>
<td>%name%必须早于%before%</td>
<td>-</td>
</tr>
<tr>
<td>negativeMessage</td>
<td>string</td>
<td>%name%不能是合法的日期</td>
<td>-</td>
</tr>
</tbody>
</table><p>完整的日期格式可以查看PHP官方文档中关于<a href="http://php.net/manual/zh/function.date.php" target="_blank">date</a>函数的格式说明. </p>

<h3>方法</h3>

<h4>isTime($input, $format = 'H:i:s')</h4>

<p>检查数据是否为合法的日期</p>
  </section>

<!-- api/isDir
  ================================================== -->
  <section id="isDir">
  <div class="page-header"><h1>isDir</h1></div>

<p>检查数据是否为存在的目录</p>

<h2>案例</h2>

<h3>检查"/notfound/directory"是否为存在的目录</h3>

<div class="highlight"><pre><code class="php"><span class="k">if</span> <span class="p">(</span><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">isDir</span><span class="p">(</span><span class="s1">'/notfound/directory'</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'Yes'</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'No'</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<h4>运行结果</h4>

<div class="highlight"><pre><code class="php"><span class="s1">'No'</span>
</code></pre></div>

<h2>调用方式</h2>

<h3>选项</h3>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>notStringMessage</td>
<td>string</td>
<td>%name%必须是字符串</td>
<td>-</td>
</tr>
<tr>
<td>notFoundMessage</td>
<td>string</td>
<td>%name%必须是存在的目录</td>
<td>-</td>
</tr>
<tr>
<td>negativeMessage</td>
<td>string</td>
<td>%name%必须是不存在的目录</td>
<td>-</td>
</tr>
</tbody>
</table><h3>方法</h3>

<h4>isDir($input)</h4>

<p>检查数据是否为存在的目录</p>
  </section>

<!-- api/isExists
  ================================================== -->
  <section id="isExists">
  <div class="page-header"><h1>isExists</h1></div>

<p>检查数据是否为存在的文件或目录</p>

<h2>案例</h2>

<h3>检查路径"/notfound/directory"是否存在</h3>

<div class="highlight"><pre><code class="php"><span class="k">if</span> <span class="p">(</span><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">isExists</span><span class="p">(</span><span class="s1">'/notfound/directory'</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'Yes'</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'No'</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<h4>运行结果</h4>

<div class="highlight"><pre><code class="php"><span class="s1">'No'</span>
</code></pre></div>

<h2>调用方式</h2>

<h3>选项</h3>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>notStringMessage</td>
<td>string</td>
<td>%name%必须是字符串</td>
<td>-</td>
</tr>
<tr>
<td>notFoundMessage</td>
<td>string</td>
<td>%name%必须是存在的文件或目录</td>
<td>-</td>
</tr>
<tr>
<td>negativeMessage</td>
<td>string</td>
<td>%name%必须是不存在的文件或目录</td>
<td>-</td>
</tr>
</tbody>
</table><h3>方法</h3>

<h4>isExists($input)</h4>

<p>检查数据是否为存在的文件或目录</p>

<div class="highlight"><pre><code class="php"><span class="nx">bool</span> <span class="nx">isExists</span><span class="p">(</span> <span class="nv">$input</span> <span class="p">)</span>
</code></pre></div>
  </section>

<!-- api/isFile
  ================================================== -->
  <section id="isFile">
  <div class="page-header"><h1>isFile</h1></div>

<p>检查数据是否为合法的文件,可选的检查选项有文件大小,扩展名和媒体类型</p>

<h2>案例</h2>

<h3>检查文件"5x5.gif"是否为存在且大小小于1.2mb</h3>

<div class="highlight"><pre><code class="php"><span class="k">if</span> <span class="p">(</span><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">isImage</span><span class="p">(</span><span class="s1">'./5x5.gif'</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">'maxSize'</span> <span class="o">=&gt;</span> <span class="s1">'1.2mb'</span><span class="p">)))</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'Yes'</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'No'</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<h4>运行结果</h4>

<div class="highlight"><pre><code class="php"><span class="s1">'Yes'</span>
</code></pre></div>

<h2>调用方法</h2>

<h3>选项</h3>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>maxSize</td>
<td>int</td>
<td>0</td>
<td>允许的文件最大字节数,允许使用类似<code>10.5MB</code>, <code>500KB</code>的文件大小值</td>
</tr>
<tr>
<td>minSize</td>
<td>int</td>
<td>0</td>
<td>允许的文件最小字节数,允许使用类似<code>10.5MB</code>, <code>500KB</code>的文件大小值</td>
</tr>
<tr>
<td>exts</td>
<td>array</td>
<td>array()</td>
<td>允许的文件扩展名</td>
</tr>
<tr>
<td>excludeExts</td>
<td>array</td>
<td>array()</td>
<td>不允许的文件扩展名</td>
</tr>
<tr>
<td>mimeTypes</td>
<td>array</td>
<td>array()</td>
<td>允许的文件媒体类型</td>
</tr>
<tr>
<td>excludeMimeTypes</td>
<td>array</td>
<td>array()</td>
<td>不允许的文件媒体类型</td>
</tr>
<tr>
<td>notFoundMessage</td>
<td>string</td>
<td>%name%不存在或不可读</td>
<td>-</td>
</tr>
<tr>
<td>maxSizeMessage</td>
<td>string</td>
<td>%name%太大了(%sizeString%),允许的最大文件大小为%maxSizeString%</td>
<td>-</td>
</tr>
<tr>
<td>minSizeMessage</td>
<td>string</td>
<td>%name%太小了(%sizeString%),允许的最小文件大小为%minSizeString%</td>
<td>-</td>
</tr>
<tr>
<td>extsMessage</td>
<td>string</td>
<td>%name%的扩展名(%ext%)不合法,只允许扩展名为:%exts%</td>
<td>-</td>
</tr>
<tr>
<td>excludeExtsMessage</td>
<td>string</td>
<td>%name%的扩展名(%ext%)不合法,不允许扩展名为:%excludeExts%</td>
<td>-</td>
</tr>
<tr>
<td>mimeTypeNotDetectedMessage</td>
<td>string</td>
<td>无法检测%name%的媒体类型</td>
<td>-</td>
</tr>
<tr>
<td>mimeTypesMessage</td>
<td>string</td>
<td>%name%的媒体类型不合法</td>
<td>-</td>
</tr>
<tr>
<td>excludeMimeTypesMessage</td>
<td>string</td>
<td>%name%的媒体类型不合法</td>
<td>-</td>
</tr>
<tr>
<td>negativeMessage</td>
<td>string</td>
<td>%name%必须是不存在的文件</td>
<td>-</td>
</tr>
<tr>
<td>notStringMessage</td>
<td>string</td>
<td>%name%必须是字符串</td>
<td>-</td>
</tr>
</tbody>
</table><h3>方法</h3>

<h4>isFile($input, $options)</h4>

<p>检查数据是否为合法的文件,可选的检查选项有文件大小,扩展名和媒体类型</p>

<p>第一个参数<code>$input</code>允许以下3种变量类型.</p>

<ol>
<li>字符串,变量的值是文件的路径,可以是相对路径,也可以是绝对路径</li>
<li>数组,确切的说是来自文件上传变量<code>$_FILES</code>的子数组,该数组应该至少包括<code>tmp_name</code>和<code>name</code>两个键</li>
<li>
<code>\SplFile</code>对象</li>
</ol>
  </section>

<!-- api/isImage
  ================================================== -->
  <section id="isImage">
  <div class="page-header"><h1>isImage</h1></div>

<p>检查数据是否为图片,同时还可以检查图片宽度和高度是否在指定的范围内</p>

<h2>案例</h2>

<h3>检查文件"5x5.gif"是否为图片且最大高度不能超过5px</h3>

<div class="highlight"><pre><code class="php"><span class="k">if</span> <span class="p">(</span><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">isImage</span><span class="p">(</span><span class="s1">'./5x5.gif'</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">'maxWidth'</span> <span class="o">=&gt;</span> <span class="mi">5</span><span class="p">)))</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'Yes'</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'No'</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<h4>运行结果</h4>

<div class="highlight"><pre><code class="php"><span class="s1">'Yes'</span>
</code></pre></div>

<h3>检查文件"5x5.gif"是否为图片且后缀名不能为"gif"</h3>

<div class="highlight"><pre><code class="php"><span class="k">if</span> <span class="p">(</span><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">isImage</span><span class="p">(</span><span class="s1">'./5x5.gif'</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">'excludeExts'</span> <span class="o">=&gt;</span> <span class="s1">'gif'</span><span class="p">)))</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'Yes'</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'No'</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<h4>运行结果</h4>

<div class="highlight"><pre><code class="php"><span class="s1">'No'</span>
</code></pre></div>

<h2>调用方式</h2>

<h3>选项</h3>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>maxSize</td>
<td>int</td>
<td>0</td>
<td>允许的文件最大字节数,允许使用类似<code>10.5MB</code>, <code>500KB</code>的文件大小值</td>
</tr>
<tr>
<td>minSize</td>
<td>int</td>
<td>0</td>
<td>允许的文件最小字节数,允许使用类似<code>10.5MB</code>, <code>500KB</code>的文件大小值</td>
</tr>
<tr>
<td>exts</td>
<td>array</td>
<td>array()</td>
<td>允许的文件扩展名</td>
</tr>
<tr>
<td>excludeExts</td>
<td>array</td>
<td>array()</td>
<td>不允许的文件扩展名</td>
</tr>
<tr>
<td>mimeTypes</td>
<td>array</td>
<td>array()</td>
<td>允许的文件媒体类型</td>
</tr>
<tr>
<td>excludeMimeTypes</td>
<td>array</td>
<td>array()</td>
<td>不允许的文件媒体类型</td>
</tr>
<tr>
<td>maxWidth</td>
<td>int</td>
<td>0</td>
<td>允许的图片最大宽度</td>
</tr>
<tr>
<td>maxHeight</td>
<td>int</td>
<td>0</td>
<td>允许的图片最大高度</td>
</tr>
<tr>
<td>minWidth</td>
<td>int</td>
<td>0</td>
<td>允许的图片最小宽度</td>
</tr>
<tr>
<td>minHeight</td>
<td>int</td>
<td>0</td>
<td>允许的图片最小高度</td>
</tr>
<tr>
<td>notDetectedMessage</td>
<td>string</td>
<td>%name%不是有效的图片,或是无法检测到图片的尺寸</td>
<td>-</td>
</tr>
<tr>
<td>widthTooBigMessage</td>
<td>string</td>
<td>%name%的宽度太大(%width%px), 允许的最大宽度为%maxWidth%px</td>
<td>-</td>
</tr>
<tr>
<td>widthTooSmallMessage</td>
<td>string</td>
<td>%name%的宽度太小(%width%px),允许的最小宽度应为%minWidth%px</td>
<td>-</td>
</tr>
<tr>
<td>heightTooBigMessage</td>
<td>string</td>
<td>%name%的高度太大(%height%px), 允许的最大高度为%maxHeight%px</td>
<td>-</td>
</tr>
<tr>
<td>heightTooSmallMessage</td>
<td>string</td>
<td>%name%的高度太小(%height%px), 允许的最小高度为%minHeight%px</td>
<td>-</td>
</tr>
<tr>
<td>notFoundMessage</td>
<td>string</td>
<td>%name%不存在或不可读</td>
<td>-</td>
</tr>
<tr>
<td>maxSizeMessage</td>
<td>string</td>
<td>%name%太大了(%sizeString%),允许的最大文件大小为%maxSizeString%</td>
<td>-</td>
</tr>
<tr>
<td>minSizeMessage</td>
<td>string</td>
<td>%name%太小了(%sizeString%),允许的最小文件大小为%minSizeString%</td>
<td>-</td>
</tr>
<tr>
<td>extsMessage</td>
<td>string</td>
<td>%name%的扩展名(%ext%)不合法,只允许扩展名为:%exts%</td>
<td>-</td>
</tr>
<tr>
<td>excludeExtsMessage</td>
<td>string</td>
<td>%name%的扩展名(%ext%)不合法,不允许扩展名为:%excludeExts%</td>
<td>-</td>
</tr>
<tr>
<td>mimeTypeNotDetectedMessage</td>
<td>string</td>
<td>无法检测%name%的媒体类型</td>
<td>-</td>
</tr>
<tr>
<td>mimeTypesMessage</td>
<td>string</td>
<td>%name%的媒体类型不合法</td>
<td>-</td>
</tr>
<tr>
<td>excludeMimeTypesMessage</td>
<td>string</td>
<td>%name%的媒体类型不合法</td>
<td>-</td>
</tr>
<tr>
<td>negativeMessage</td>
<td>string</td>
<td>%name%必须是不存在的文件</td>
<td>-</td>
</tr>
<tr>
<td>notStringMessage</td>
<td>string</td>
<td>%name%必须是字符串</td>
<td>-</td>
</tr>
</tbody>
</table><h3>方法</h3>

<h4>isImage($input, $options = array())</h4>

<p>检查数据是否为图片,同时还可以检查图片宽度和高度是否在指定的范围内</p>

<p>图片验证器是文件验证器<a href="#isFile">isFile</a>的子类,其中选项<code>maxSize</code>, <code>minSize</code>, <code>exts</code>,
<code>excludeExts</code>, <code>mimeTypes</code>, <code>excludeMimeTypes</code>继承自父类.</p>
  </section>

<!-- api/isEmail
  ================================================== -->
  <section id="isEmail">
  <div class="page-header"><h1>isEmail</h1></div>

<p>检查数据是否为有效的邮箱地址</p>

<h2>案例</h2>

<h3>检查"<a href="#mailto:example@example.">example@example.com</a>"是否为邮箱地址</h3>

<div class="highlight"><pre><code class="php"><span class="k">if</span> <span class="p">(</span><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">isEmail</span><span class="p">(</span><span class="s1">'example@example.com'</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'Yes'</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'No'</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<h4>运行结果</h4>

<div class="highlight"><pre><code class="php"><span class="s1">'Yes'</span>
</code></pre></div>

<h2>调用方式</h2>

<h3>选项</h3>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>notStringMessage</td>
<td>string</td>
<td>%name%必须是字符串</td>
<td>-</td>
</tr>
<tr>
<td>formatMessage</td>
<td>string</td>
<td>%name%必须是有效的邮箱地址</td>
<td>-</td>
</tr>
<tr>
<td>negativeMessage</td>
<td>string</td>
<td>%name%不能是数字</td>
<td>-</td>
</tr>
</tbody>
</table><h3>方法</h3>

<h4>isEmail($input)</h4>

<p>检查数据是否为有效的邮箱地址</p>
  </section>

<!-- api/isIp
  ================================================== -->
  <section id="isIp">
  <div class="page-header"><h1>isIp</h1></div>

<p>检查数据是否为有效的IP地址</p>

<h2>案例</h2>

<h3>检查"192.168.0.1"是否为有效的IP地址</h3>

<div class="highlight"><pre><code class="php"><span class="k">if</span> <span class="p">(</span><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">isIp</span><span class="p">(</span><span class="s1">'192.168.0.1'</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'Yes'</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'No'</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<h4>运行结果</h4>

<div class="highlight"><pre><code class="php"><span class="s1">'Yes'</span>
</code></pre></div>

<h3>检查"192.168.0.1"是否不在私有的IP地址中</h3>

<div class="highlight"><pre><code class="php"><span class="k">if</span> <span class="p">(</span><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">isIp</span><span class="p">(</span><span class="s1">'192.168.0.1'</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">'noPrivRange'</span> <span class="o">=&gt;</span> <span class="k">true</span><span class="p">)))</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'Yes'</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'No'</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<h4>运行结果</h4>

<div class="highlight"><pre><code class="php"><span class="s1">'No'</span>
</code></pre></div>

<h2>调用方式</h2>

<h3>选项</h3>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>ipv4</td>
<td>bool</td>
<td>false</td>
<td>是否只允许IPv4格式的IP地址</td>
</tr>
<tr>
<td>ipv6</td>
<td>bool</td>
<td>false</td>
<td>是否只允许IPv6格式的IP地址</td>
</tr>
<tr>
<td>noPrivRange</td>
<td>bool</td>
<td>false</td>
<td>是否不允许私有的IP地址</td>
</tr>
<tr>
<td>noResRange</td>
<td>bool</td>
<td>false</td>
<td>是否不允许保留的IP地址</td>
</tr>
<tr>
<td>notAllowMessage</td>
<td>string</td>
<td>%name%必须是有效的IP地址</td>
<td>-</td>
</tr>
<tr>
<td>negativeMessage</td>
<td>string</td>
<td>%name%不能是IP地址</td>
<td>-</td>
</tr>
</tbody>
</table><h3>方法</h3>

<h4>isIp($input, $options = array())</h4>

<p>检查数据是否为有效的IP地址</p>
  </section>

<!-- api/isTld
  ================================================== -->
  <section id="isTld">
  <div class="page-header"><h1>isTld</h1></div>

<p>检查数据是否为存在的顶级域名</p>

<h2>案例</h2>

<h3>检查"cn"是否为存在的顶级域名</h3>

<div class="highlight"><pre><code class="php"><span class="k">if</span> <span class="p">(</span><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">isTld</span><span class="p">(</span><span class="s1">'cn'</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'Yes'</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'No'</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<h4>运行结果</h4>

<div class="highlight"><pre><code class="php"><span class="s1">'Yes'</span>
</code></pre></div>

<h2>调用方式</h2>

<h3>选项</h3>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>notStringMessage</td>
<td>string</td>
<td>%name%必须是字符串</td>
<td>-</td>
</tr>
<tr>
<td>notInMessage</td>
<td>string</td>
<td>%name%必须是有效的顶级域名</td>
<td>-</td>
</tr>
<tr>
<td>negativeMessage</td>
<td>string</td>
<td>%name%不能是有效的顶级域名</td>
<td>-</td>
</tr>
</tbody>
</table><h3>方法</h3>

<h4>isTld($input)</h4>

<p>检查数据是否为存在的顶级域名</p>
  </section>

<!-- api/isUrl
  ================================================== -->
  <section id="isUrl">
  <div class="page-header"><h1>isUrl</h1></div>

<p>检查数据是否为有效的URL地址,可选的检查选项有"path"和"query"</p>

<h2>案例</h2>

<h3>检查<code>http://www.example.com</code>是否为有效的URL地址</h3>

<div class="highlight"><pre><code class="php"><span class="k">if</span> <span class="p">(</span><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">isUrl</span><span class="p">(</span><span class="s1">'http://www.example.com'</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'Yes'</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'No'</span><span class="p">;</span>
<span class="p">}</span>
<span class="c1">// 输出了Yes</span>
</code></pre></div>

<h3>检查<code>http://www.example.com</code>是否为有效的URL地址,要求带有查询参数</h3>

<div class="highlight"><pre><code class="php"><span class="k">if</span> <span class="p">(</span><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">isUrl</span><span class="p">(</span><span class="s1">'http://www.example.com'</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">'query'</span> <span class="o">=&gt;</span> <span class="k">true</span><span class="p">)))</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'Yes'</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'No'</span><span class="p">;</span>
<span class="p">}</span>
<span class="c1">// 输出了No</span>
</code></pre></div>

<h2>调用方式</h2>

<h3>选项</h3>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>path</td>
<td>bool</td>
<td>false</td>
<td>是否要求URL带有路径,如<a href="http://www.example.com/path/part" target="_blank">http://www.example.com/path/part</a>
</td>
</tr>
<tr>
<td>query</td>
<td>bool</td>
<td>false</td>
<td>是否要求URL带有查询参数,如<a href="http://www.example/?query=string" target="_blank">http://www.example/?query=string</a>
</td>
</tr>
<tr>
<td>notStringMessage</td>
<td>string</td>
<td>%name%必须是字符串</td>
<td>-</td>
</tr>
<tr>
<td>invalidMessage</td>
<td>string</td>
<td>%name%必须是有效的URL地址</td>
<td>-</td>
</tr>
<tr>
<td>negativeMessage</td>
<td>string</td>
<td>%name%不能是URL地址</td>
<td>-</td>
</tr>
</tbody>
</table><h3>方法</h3>

<h4>isUrl($input, $options = array())</h4>

<p>检查数据是否为有效的URL地址</p>
  </section>

<!-- api/isUuid
  ================================================== -->
  <section id="isUuid">
  <div class="page-header"><h1>isUuid</h1></div>

<p>检查数据是否为有效的UUID</p>

<h2>案例</h2>

<h3>检查"00010203-0405-0607-0809-0A0B0C0D0E0F"是否为有效的UUID</h3>

<div class="highlight"><pre><code class="php"><span class="k">if</span> <span class="p">(</span><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">isUuid</span><span class="p">(</span><span class="s1">'00010203-0405-0607-0809-0A0B0C0D0E0F'</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'Yes'</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'No'</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<h4>运行结果</h4>

<div class="highlight"><pre><code class="php"><span class="s1">'Yes'</span>
</code></pre></div>

<h2>调用方式</h2>

<h3>选项</h3>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>notStringMessage</td>
<td>string</td>
<td>%name%必须是字符串</td>
<td>-</td>
</tr>
<tr>
<td>patternMessage</td>
<td>string</td>
<td>%name%必须是有效的UUID</td>
<td>-</td>
</tr>
<tr>
<td>negativeMessage</td>
<td>string</td>
<td>%name%不能是有效的UUID</td>
<td>-</td>
</tr>
</tbody>
</table><h3>方法</h3>

<h4>isUuid($input)</h4>

<p>检查数据是否为有效的UUID</p>
  </section>

<!-- api/isCreditCard
  ================================================== -->
  <section id="isCreditCard">
  <div class="page-header"><h1>isCreditCard</h1></div>

<p>检查数据是否为合法的信用卡号码</p>

<h2>案例</h2>

<h3>检查数据是否为Visa或银联卡,第二个参数即可以是字符串,也可以是数组</h3>

<div class="highlight"><pre><code class="php"><span class="nv">$input</span> <span class="o">=</span> <span class="s1">'4111111111111111'</span><span class="p">;</span> <span class="c1">// Visa</span>

<span class="k">if</span> <span class="p">(</span><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">isCreditCard</span><span class="p">(</span><span class="nv">$input</span><span class="p">,</span> <span class="s1">'UnionPay,Visa'</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'Yes'</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'No'</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">if</span> <span class="p">(</span><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">isCreditCard</span><span class="p">(</span><span class="nv">$input</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">'UnionPay'</span><span class="p">,</span> <span class="s1">'Visa'</span><span class="p">)))</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'Yes'</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'No'</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<h4>运行结果</h4>

<div class="highlight"><pre><code class="php"><span class="s1">'Yes'</span>
<span class="s1">'Yes'</span>
</code></pre></div>

<h2>调用方式</h2>

<h3>选项</h3>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>type</td>
<td>string,array</td>
<td>无</td>
<td>指定信用卡类型,多个使用<code>,</code>隔开,或是使用数组,留空表示允许任意信用卡号</td>
</tr>
<tr>
<td>notStringMessage</td>
<td>string</td>
<td>%name%必须是字符串</td>
<td>-</td>
</tr>
<tr>
<td>invalidMessage</td>
<td>string</td>
<td>%name%必须是有效的信用卡号</td>
<td>-</td>
</tr>
<tr>
<td>negativeMessage</td>
<td>string</td>
<td>%name%不能是有效的信用卡号</td>
<td>-</td>
</tr>
</tbody>
</table><p>允许指定的信用卡类型有: American Express, Diners Club, Discover, JCB, MasterCard, China UnionPay 和 Visa</p>

<p>下表为目前允许的信用卡类型</p>

<table class="table table-bordered table-striped">
<thead><tr>
<th><strong>发卡机构</strong></th>
<th><strong>中文名称</strong></th>
<th><strong>值</strong></th>
</tr></thead>
<tbody>
<tr>
<td>American Express</td>
<td>美国运通</td>
<td><code>Amex</code></td>
</tr>
<tr>
<td>Diners Club</td>
<td>大来卡</td>
<td><code>DinersClub</code></td>
</tr>
<tr>
<td>Discover Card</td>
<td>发现卡</td>
<td><code>Discover</code></td>
</tr>
<tr>
<td>JCB</td>
<td>-</td>
<td><code>JCB</code></td>
</tr>
<tr>
<td>MasterCard</td>
<td>万事达卡</td>
<td><code>MasterCard</code></td>
</tr>
<tr>
<td>China UnionPay</td>
<td>中国银联</td>
<td><code>UnionPay</code></td>
</tr>
<tr>
<td>Visa</td>
<td>-</td>
<td><code>Visa</code></td>
</tr>
</tbody>
</table><h3>方法</h3>

<h4>isCreditCard($input, $type)</h4>
  </section>

<!-- api/isChinese
  ================================================== -->
  <section id="isChinese">
  <div class="page-header"><h1>isChinese</h1></div>

<p>检查数据是否只由汉字组成</p>

<h2>案例</h2>

<h3>检查数据是否只由汉字组成</h3>

<div class="highlight"><pre><code class="php"><span class="k">if</span> <span class="p">(</span><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">isChinese</span><span class="p">(</span><span class="s1">'中文'</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'Yes'</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'No'</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<h4>运行结果</h4>

<div class="highlight"><pre><code class="php"><span class="s1">'Yes'</span>
</code></pre></div>

<h2>调用方式</h2>

<h3>选项</h3>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>notStringMessage</td>
<td>string</td>
<td>%name%必须是字符串</td>
<td>-</td>
</tr>
<tr>
<td>patternMessage</td>
<td>string</td>
<td>%name%只能由中文组成</td>
<td>-</td>
</tr>
<tr>
<td>negativeMessage</td>
<td>string</td>
<td>%name%不能只由中文组成</td>
<td>-</td>
</tr>
</tbody>
</table><h3>方法</h3>

<h4>isChinese($input)</h4>

<p>检查数据是否只由汉字组成</p>
  </section>

<!-- api/isIdCardCn
  ================================================== -->
  <section id="isIdCardCn">
  <div class="page-header"><h1>isIdCardCn</h1></div>

<p>检查数据是否为有效的中国身份证</p>

<h2>案例</h2>

<h3>检查15位数字"342622840209049"是否为有效的中国身份证</h3>

<div class="highlight"><pre><code class="php"><span class="k">if</span> <span class="p">(</span><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">isIdCardCn</span><span class="p">(</span><span class="s1">'342622840209049'</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'Yes'</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'No'</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<h4>运行结果</h4>

<div class="highlight"><pre><code class="php"><span class="s1">'Yes'</span>
</code></pre></div>

<h2>调用方式</h2>

<h3>选项</h3>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>notStringMessage</td>
<td>string</td>
<td>%name%必须是字符串</td>
<td>-</td>
</tr>
<tr>
<td>invalidMessage</td>
<td>string</td>
<td>%name%必须是有效的中国身份证</td>
<td>-</td>
</tr>
<tr>
<td>negativeMessage</td>
<td>string</td>
<td>%name%不能是有效的中国身份证</td>
<td>-</td>
</tr>
</tbody>
</table><h3>方法</h3>

<h4>isIdCardCn($input)</h4>

<p>检查数据是否为有效的中国身份证</p>
  </section>

<!-- api/isIdCardHk
  ================================================== -->
  <section id="isIdCardHk">
  <div class="page-header"><h1>isIdCardHk</h1></div>

<p>检查数据是否为有效的香港身份证</p>

<h2>案例</h2>

<h3>检查"Z437626A"是否为有效的香港身份证</h3>

<div class="highlight"><pre><code class="php"><span class="k">if</span> <span class="p">(</span><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">isIdCardHk</span><span class="p">(</span><span class="s1">'Z437626A'</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'Yes'</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'No'</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<h4>运行结果</h4>

<div class="highlight"><pre><code class="php"><span class="s1">'Yes'</span>
</code></pre></div>

<h2>调用方式</h2>

<h3>选项</h3>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>notStringMessage</td>
<td>string</td>
<td>%name%必须是字符串</td>
<td>-</td>
</tr>
<tr>
<td>invalidMessage</td>
<td>string</td>
<td>%name%必须是有效的香港身份证</td>
<td>-</td>
</tr>
<tr>
<td>negativeMessage</td>
<td>string</td>
<td>%name%不能是有效的香港身份证</td>
<td>-</td>
</tr>
</tbody>
</table><h3>方法</h3>

<h4>isIdCardHk($input)</h4>

<p>检查数据是否为有效的香港身份证</p>
  </section>

<!-- api/isIdCardMo
  ================================================== -->
  <section id="isIdCardMo">
  <div class="page-header"><h1>isIdCardMo</h1></div>

<p>检查数据是否为有效的澳门身份证</p>

<h2>案例</h2>

<h3>检查"11111111"是否为有效的澳门身份证</h3>

<div class="highlight"><pre><code class="php"><span class="k">if</span> <span class="p">(</span><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">isIdCardMo</span><span class="p">(</span><span class="s1">'11111111'</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'Yes'</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'No'</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<h4>运行结果</h4>

<div class="highlight"><pre><code class="php"><span class="s1">'Yes'</span>
</code></pre></div>

<h2>调用方式</h2>

<h3>选项</h3>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>notStringMessage</td>
<td>string</td>
<td>%name%必须是字符串</td>
<td>-</td>
</tr>
<tr>
<td>patternMessage</td>
<td>string</td>
<td>%name%必须是有效的澳门身份证</td>
<td>-</td>
</tr>
<tr>
<td>negativeMessage</td>
<td>string</td>
<td>%name%不能是有效的澳门身份证</td>
<td>-</td>
</tr>
</tbody>
</table><h3>方法</h3>

<h4>isIdCardMo($input)</h4>

<p>检查数据是否为有效的澳门身份证</p>
  </section>

<!-- api/isIdCardTw
  ================================================== -->
  <section id="isIdCardTw">
  <div class="page-header"><h1>isIdCardTw</h1></div>

<p>检查数据是否为有效的台湾身份证</p>

<h2>案例</h2>

<h3>检查"A122501945"是否为有效的台湾身份证</h3>

<div class="highlight"><pre><code class="php"><span class="k">if</span> <span class="p">(</span><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">isIdCardTw</span><span class="p">(</span><span class="s1">'A122501945'</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'Yes'</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'No'</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<h4>运行结果</h4>

<div class="highlight"><pre><code class="php"><span class="s1">'Yes'</span>
</code></pre></div>

<h2>调用方式</h2>

<h3>选项</h3>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>notStringMessage</td>
<td>string</td>
<td>%name%必须是字符串</td>
<td>-</td>
</tr>
<tr>
<td>invalidMessage</td>
<td>string</td>
<td>%name%必须是有效的台湾身份证</td>
<td>-</td>
</tr>
<tr>
<td>negativeMessage</td>
<td>string</td>
<td>%name%不能是有效的台湾身份证</td>
<td>-</td>
</tr>
</tbody>
</table><h3>方法</h3>

<h4>isIdCardTw($input)</h4>

<p>检查数据是否为有效的台湾身份证</p>
  </section>

<!-- api/isPhoneCn
  ================================================== -->
  <section id="isPhoneCn">
  <div class="page-header"><h1>isPhoneCn</h1></div>

<p>检查数据是否为有效的电话号码</p>

<h2>案例</h2>

<h3>检查"020-1234567"是否为电话号码</h3>

<div class="highlight"><pre><code class="php"><span class="k">if</span> <span class="p">(</span><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">isPhoneCn</span><span class="p">(</span><span class="s1">'020-1234567'</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'Yes'</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'No'</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<h4>运行结果</h4>

<div class="highlight"><pre><code class="php"><span class="s1">'Yes'</span>
</code></pre></div>

<h2>调用方式</h2>

<h3>选项</h3>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>notStringMessage</td>
<td>string</td>
<td>%name%必须是字符串</td>
<td>-</td>
</tr>
<tr>
<td>patternMessage</td>
<td>string</td>
<td>%name%必须是有效的电话号码</td>
<td>-</td>
</tr>
<tr>
<td>negativeMessage</td>
<td>string</td>
<td>%name%不能是电话号码</td>
<td>-</td>
</tr>
</tbody>
</table><h3>方法</h3>

<h4>isPhoneCn($input)</h4>

<p>检查数据是否为有效的电话号码</p>
  </section>

<!-- api/isPostcodeCn
  ================================================== -->
  <section id="isPostcodeCn">
  <div class="page-header"><h1>isPostcodeCn</h1></div>

<p>检查数据是否为有效的中国邮政编码</p>

<h2>案例</h2>

<h3>检查"123456"是否为有效的中国邮政编码</h3>

<div class="highlight"><pre><code class="php"><span class="k">if</span> <span class="p">(</span><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">isPostcodeCn</span><span class="p">(</span><span class="s1">'123456'</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'Yes'</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'No'</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<h4>运行结果</h4>

<div class="highlight"><pre><code class="php"><span class="s1">'Yes'</span>
</code></pre></div>

<h2>调用方式</h2>

<h3>选项</h3>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>notStringMessage</td>
<td>string</td>
<td>%name%必须是字符串</td>
<td>-</td>
</tr>
<tr>
<td>patternMessage</td>
<td>string</td>
<td>%name%必须是6位长度的数字</td>
<td>-</td>
</tr>
<tr>
<td>negativeMessage</td>
<td>string</td>
<td>%name%不能是邮政编码</td>
<td>-</td>
</tr>
</tbody>
</table><h3>方法</h3>

<h4>isPostcodeCn($input)</h4>

<p>检查数据是否为有效的中国邮政编码</p>
  </section>

<!-- api/isQQ
  ================================================== -->
  <section id="isQQ">
  <div class="page-header"><h1>isQQ</h1></div>

<p>检查数据是否为有效的QQ号码</p>

<h2>案例</h2>

<h3>检查"123456"是否为有效的QQ号码</h3>

<div class="highlight"><pre><code class="php"><span class="k">if</span> <span class="p">(</span><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">isQQ</span><span class="p">(</span><span class="s1">'123456'</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'Yes'</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'No'</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<h4>运行结果</h4>

<div class="highlight"><pre><code class="php"><span class="s1">'Yes'</span>
</code></pre></div>

<h2>调用方式</h2>

<h3>选项</h3>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>notStringMessage</td>
<td>string</td>
<td>%name%必须是字符串</td>
<td>-</td>
</tr>
<tr>
<td>patternMessage</td>
<td>string</td>
<td>%name%必须是有效的QQ号码</td>
<td>-</td>
</tr>
<tr>
<td>negativeMessage</td>
<td>string</td>
<td>%name%不能是QQ号码</td>
<td>-</td>
</tr>
</tbody>
</table><h3>方法</h3>

<h4>isQQ($input)</h4>

<p>检查数据是否为有效的QQ号码</p>
  </section>

<!-- api/isMobileCn
  ================================================== -->
  <section id="isMobileCn">
  <div class="page-header"><h1>isMobileCn</h1></div>

<p>检查数据是否为有效的中国手机号码</p>

<h2>案例</h2>

<h3>检查"13800138000"是否为有效的手机号码</h3>

<div class="highlight"><pre><code class="php"><span class="k">if</span> <span class="p">(</span><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">isMobileCn</span><span class="p">(</span><span class="s1">'13800138000'</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'Yes'</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'No'</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<h4>运行结果</h4>

<div class="highlight"><pre><code class="php"><span class="s1">'Yes'</span>
</code></pre></div>

<h2>调用方式</h2>

<h3>选项</h3>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>notStringMessage</td>
<td>string</td>
<td>%name%必须是字符串</td>
<td>-</td>
</tr>
<tr>
<td>patternMessage</td>
<td>string</td>
<td>%name%必须是11位长度的数字,以13,14,15或18开头</td>
<td>-</td>
</tr>
</tbody>
</table><h3>方法</h3>

<h4>isMobileCn($input)</h4>

<p>检查数据是否为有效的中国手机号码</p>
  </section>

<!-- api/isAllof
  ================================================== -->
  <section id="isAllof">
  <div class="page-header"><h1>isAllOf</h1></div>

<p>检查数据是否通过所有的规则校验</p>

<h2>案例</h2>

<h3>检查数据是否为5-10位的数字</h3>

<div class="highlight"><pre><code class="php"><span class="nv">$input</span> <span class="o">=</span> <span class="s1">'123456'</span><span class="p">;</span>
<span class="k">if</span> <span class="p">(</span><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">isAllOf</span><span class="p">(</span><span class="nv">$input</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">'length'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
    <span class="s1">'digit'</span> <span class="o">=&gt;</span> <span class="k">true</span>
<span class="p">)))</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'Yes'</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'No'</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<h4>运行结果</h4>

<div class="highlight"><pre><code class="php"><span class="s1">'Yes'</span>
</code></pre></div>

<h2>调用方式</h2>

<h3>选项</h3>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>rules</td>
<td>array</td>
<td>-</td>
<td>验证规则数组,数组的键名是规则名称,数组的值是验证规则的配置选项</td>
</tr>
<tr>
<td>atLeastMessage</td>
<td>string</td>
<td>%name%必须满足以下所有规则</td>
<td>-</td>
</tr>
</tbody>
</table><h3>方法</h3>

<h4>isAllOf($input, $rules)</h4>

<p>检查数据是否通过所有的规则校验</p>
  </section>

<!-- api/isNoneof
  ================================================== -->
  <section id="isNoneof">
  <div class="page-header"><h1>isNoneOf</h1></div>

<p>检查数据是否不符合所有指定的规则校验</p>

<h2>案例</h2>

<h3>检查数据不为数字,且长度不大于3</h3>

<div class="highlight"><pre><code class="php"><span class="nv">$rules</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">'alpha'</span> <span class="o">=&gt;</span> <span class="k">true</span><span class="p">,</span>
    <span class="s1">'maxLength'</span> <span class="o">=&gt;</span> <span class="mi">3</span>
<span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">isNoneOf</span><span class="p">(</span><span class="s1">'abc'</span><span class="p">,</span> <span class="nv">$rules</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'Yes'</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'No'</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<h4>运行结果</h4>

<div class="highlight"><pre><code class="php"><span class="s1">'No'</span>
</code></pre></div>

<h2>调用方式</h2>

<h3>选项</h3>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>rules</td>
<td>array</td>
<td>-</td>
<td>验证规则数组,数组的键名是规则名称,数组的值是验证规则的配置选项</td>
</tr>
<tr>
<td>invalidMessage</td>
<td>string</td>
<td>%name%必须满足以下所有规则</td>
<td>-</td>
</tr>
</tbody>
</table><h3>方法</h3>

<h4>isNoneOf($input, $rules)</h4>

<p>检查数据是否不符合所有指定的规则校验</p>
  </section>

<!-- api/isOneof
  ================================================== -->
  <section id="isOneof">
  <div class="page-header"><h1>isOneOf</h1></div>

<p>检查数据是否满足指定规则中的任何一条</p>

<h2>案例</h2>

<h3>检查"abc"是否为数字且最大长度不超过2</h3>

<div class="highlight"><pre><code class="php"><span class="nv">$rules</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">'digit'</span> <span class="o">=&gt;</span> <span class="k">true</span><span class="p">,</span>
    <span class="s1">'maxLength'</span> <span class="o">=&gt;</span> <span class="mi">2</span>
<span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">isOneOf</span><span class="p">(</span><span class="s1">'abc'</span><span class="p">,</span> <span class="nv">$rules</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'Yes'</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'No'</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<h4>运行结果</h4>

<div class="highlight"><pre><code class="php"><span class="s1">'No'</span>
</code></pre></div>

<h2>调用方式</h2>

<h3>选项</h3>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>rules</td>
<td>array</td>
<td>-</td>
<td>验证规则数组,数组的键名是规则名称,数组的值是验证规则的配置选项</td>
</tr>
<tr>
<td>atLeastMessage</td>
<td>string</td>
<td>%name%至少需要满足以下任何一条规则</td>
<td>-</td>
</tr>
</tbody>
</table><h3>方法</h3>

<h4>isOneOf($input, $rules)</h4>

<p>检查数据是否满足指定规则中的任何一条</p>
  </section>

<!-- api/isSomeof
  ================================================== -->
  <section id="isSomeof">
  <div class="page-header"><h1>isSomeOf</h1></div>

<p>检查数据是否通过指定数量规则的验证</p>

<h2>案例</h2>

<h3>检查数据符合"数字,长度小于5,邮箱"这三条中至少两条</h3>

<div class="highlight"><pre><code class="php"><span class="nv">$rules</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">'digit'</span> <span class="o">=&gt;</span> <span class="k">true</span><span class="p">,</span>
    <span class="s1">'maxLength'</span> <span class="o">=&gt;</span> <span class="mi">5</span><span class="p">,</span>
    <span class="s1">'email'</span> <span class="o">=&gt;</span> <span class="k">true</span>
<span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">isSomeOf</span><span class="p">(</span><span class="s1">'abc'</span><span class="p">,</span> <span class="nv">$rules</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'Yes'</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'No'</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<h4>运行结果</h4>

<div class="highlight"><pre><code class="php"><span class="s1">'Yes'</span>
</code></pre></div>

<h2>调用方式</h2>

<h3>选项</h3>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>rules</td>
<td>array</td>
<td>-</td>
<td>验证规则数组,数组的键名是规则名称,数组的值是验证规则的配置选项</td>
</tr>
<tr>
<td>atLeast</td>
<td>int</td>
<td>无</td>
<td>至少需要满足以下少要有多少条规则通过才算验证通过</td>
</tr>
<tr>
<td>atLeastMessage</td>
<td>string</td>
<td>%name%至少需要满足以下%count%条规则中的%left%条</td>
<td>-</td>
</tr>
</tbody>
</table><h3>方法</h3>

<h4>isSomeOf($input, $rules, $atLeast)</h4>

<p>检查数据是否通过指定数量规则的验证</p>
  </section>

<!-- api/isRecordExists
  ================================================== -->
  <section id="isRecordExists">
  <div class="page-header"><h1>isRecordExists</h1></div>

<p>检查数据表是否存在指定的记录</p>

<h2>案例</h2>

<h4>检查主键为1的用户是否存在,和检查name为test的用户是否存在</h4>

<div class="highlight"><pre><code class="php"><span class="c1">// Set configuraion for db widget</span>
<span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">config</span><span class="p">(</span><span class="s1">'db'</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">'dsn'</span> <span class="o">=&gt;</span> <span class="s1">'sqlite::memory:'</span><span class="p">,</span>
<span class="p">));</span>

<span class="nv">$db</span> <span class="o">=</span> <span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">db</span><span class="p">;</span>

<span class="nv">$db</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="s2">"CREATE TABLE users (id INTEGER NOT NULL, name VARCHAR(50) NOT NULL, address VARCHAR(256) NOT NULL, PRIMARY KEY(id))"</span><span class="p">);</span>

<span class="nv">$db</span><span class="o">-&gt;</span><span class="na">insert</span><span class="p">(</span><span class="s1">'users'</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">'name'</span> <span class="o">=&gt;</span> <span class="s1">'twin'</span><span class="p">,</span>
    <span class="s1">'address'</span> <span class="o">=&gt;</span> <span class="s1">'test'</span>
<span class="p">));</span>

<span class="nv">$db</span><span class="o">-&gt;</span><span class="na">insert</span><span class="p">(</span><span class="s1">'users'</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">'name'</span> <span class="o">=&gt;</span> <span class="s1">'test'</span><span class="p">,</span>
    <span class="s1">'address'</span> <span class="o">=&gt;</span> <span class="s1">'test'</span>
<span class="p">));</span>


<span class="c1">// Check if the id=1 user exists</span>
<span class="k">if</span> <span class="p">(</span><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">isRecordExists</span><span class="p">(</span><span class="s1">'1'</span><span class="p">,</span> <span class="s1">'users'</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'Yes'</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'No'</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// Check if the name=test user exists</span>
<span class="k">if</span> <span class="p">(</span><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">isRecordExists</span><span class="p">(</span><span class="s1">'test'</span><span class="p">,</span> <span class="s1">'users'</span><span class="p">,</span> <span class="s1">'name'</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'Yes'</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'No'</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<h4>运行结果</h4>

<div class="highlight"><pre><code class="php"><span class="s1">'Yes'</span>
<span class="s1">'Yes'</span>
</code></pre></div>

<h2>调用方式</h2>

<h3>选项</h3>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>table</td>
<td>string</td>
<td>无</td>
<td>记录所在的数据表</td>
</tr>
<tr>
<td>field</td>
<td>string</td>
<td>id</td>
<td>要查找的字段名称</td>
</tr>
<tr>
<td>notFoundMessage</td>
<td>string</td>
<td>%name%不存在</td>
<td>-</td>
</tr>
<tr>
<td>negativeMessage</td>
<td>string</td>
<td>%name%已存在</td>
<td>-</td>
</tr>
</tbody>
</table><h3>方法</h3>

<h4>isRecordExists($input, $table, $field = 'id')</h4>

<p>检查数据表是否存在指定的记录</p>
  </section>

<!-- api/isAll
  ================================================== -->
  <section id="isAll">
  <div class="page-header"><h1>isAll</h1></div>

<p>检查数组里的每一项是否符合指定的规则</p>

<h2>案例</h2>

<h3>检查数组里的每一项是否都为数字</h3>

<div class="highlight"><pre><code class="php"><span class="nv">$input</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">isAll</span><span class="p">(</span><span class="nv">$input</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">'digit'</span> <span class="o">=&gt;</span> <span class="k">true</span>
<span class="p">)))</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'Yes'</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'No'</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<h4>运行结果</h4>

<div class="highlight"><pre><code class="php"><span class="s1">'Yes'</span>
</code></pre></div>

<h2>调用方式</h2>

<h3>选项</h3>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>rules</td>
<td>array</td>
<td>验证规则数组,数组的键名是规则名称,数组的值是验证规则的配置选项</td>
<td>-</td>
</tr>
<tr>
<td>notArrayMessage</td>
<td>string</td>
<td>%name%必须是数组</td>
<td>-</td>
</tr>
</tbody>
</table><h3>方法</h3>

<h4>isAll($input, $rules)</h4>

<p>检查数组里的每一项是否符合指定的规则</p>
  </section>

<!-- api/isCallback
  ================================================== -->
  <section id="isCallback">
  <div class="page-header"><h1>isCallback</h1></div>

<p>检查数据是否通过指定回调方法验证</p>

<h2>案例</h2>

<h3>通过回调方法检查数据是否能被3整除</h3>

<div class="highlight"><pre><code class="php"><span class="k">if</span> <span class="p">(</span><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">isCallback</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="k">function</span><span class="p">(</span><span class="nv">$input</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="mi">0</span> <span class="o">===</span> <span class="mi">10</span> <span class="o">%</span> <span class="nv">$input</span><span class="p">;</span>
<span class="p">}))</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'Yes'</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'No'</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<h4>运行结果</h4>

<div class="highlight"><pre><code class="php"><span class="s1">'No'</span>
</code></pre></div>

<h2>调用方式</h2>

<h3>选项</h3>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody><tr>
<td>invalidMessage</td>
<td>string</td>
<td>%name%不合法</td>
<td>-</td>
</tr></tbody>
</table><h3>方法</h3>

<h4>isCallback($input, $fn, $message = null)</h4>

<p>检查数据是否通过指定回调方法验证</p>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>$input</td>
<td>mixed</td>
<td>无</td>
<td>待验证的数据</td>
</tr>
<tr>
<td>$fn</td>
<td>callback</td>
<td>无</td>
<td>指定验证的回调结构</td>
</tr>
<tr>
<td>$message</td>
<td>string</td>
<td>无</td>
<td>自定义验证不通过的提示信息</td>
</tr>
</tbody>
</table>
  </section>

<!-- api/isColor
  ================================================== -->
  <section id="isColor">
  <div class="page-header"><h1>isColor</h1></div>

<p>检查数据是否为有效的十六进制颜色</p>

<h2>案例</h2>

<h3>检查"#FF0000"是否为有效的十六进制颜色</h3>

<div class="highlight"><pre><code class="php"><span class="k">if</span> <span class="p">(</span><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">isColor</span><span class="p">(</span><span class="s1">'#FF0000'</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'Yes'</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'No'</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<h4>运行结果</h4>

<div class="highlight"><pre><code class="php"><span class="s1">'Yes'</span>
</code></pre></div>

<h2>调用方式</h2>

<h3>选项</h3>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>notStringMessage</td>
<td>string</td>
<td>%name%必须是字符串</td>
<td>-</td>
</tr>
<tr>
<td>patternMessage</td>
<td>string</td>
<td>%name%必须是有效的十六进制颜色,例如#FF0000</td>
<td>-</td>
</tr>
<tr>
<td>negativeMessage</td>
<td>string</td>
<td>%name%不能是有效的十六进制颜色</td>
<td>-</td>
</tr>
</tbody>
</table><h3>方法</h3>

<h4>isColor($input)</h4>

<p>检查数据是否为有效的十六进制颜色</p>
  </section>

<!-- api/isPassword
  ================================================== -->
  <section id="isPassword">
  <div class="page-header"><h1>isPassword</h1></div>

<p>检查组成密码的字符是否符合要求格式</p>

<h2>案例</h2>

<h3>检查密码是否最少包含6个字符,由数字和字母组成</h3>

<div class="highlight"><pre><code class="php"><span class="nv">$passwords</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">'abc'</span><span class="p">,</span>
    <span class="s1">'abcdef'</span><span class="p">,</span>
    <span class="s1">'123456'</span><span class="p">,</span>
    <span class="s1">'abc123'</span>
<span class="p">);</span>

<span class="k">foreach</span> <span class="p">(</span><span class="nv">$passwords</span> <span class="k">as</span> <span class="nv">$password</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$result</span> <span class="o">=</span> <span class="nx">wei</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">isPassword</span><span class="p">(</span><span class="nv">$password</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">'minLength'</span> <span class="o">=&gt;</span> <span class="mi">6</span><span class="p">,</span>
        <span class="s1">'needDigit'</span> <span class="o">=&gt;</span> <span class="k">true</span><span class="p">,</span>
        <span class="s1">'needLetter'</span> <span class="o">=&gt;</span> <span class="k">true</span><span class="p">,</span>
    <span class="p">));</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$result</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">echo</span> <span class="s1">'Yes'</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nb">print_r</span><span class="p">(</span><span class="nx">wei</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">isPassword</span><span class="o">-&gt;</span><span class="na">getMessages</span><span class="p">());</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h4>输出结果</h4>

<div class="highlight"><pre><code class="php"><span class="c1">// abc</span>
<span class="k">array</span><span class="p">(</span>
    <span class="s1">'lengthTooShort'</span> <span class="o">=&gt;</span> <span class="s1">'密码的长度必须大于等于6'</span>
<span class="p">);</span>

<span class="c1">// abcdef</span>
<span class="k">array</span><span class="p">(</span>
    <span class="s1">'missingCharType'</span> <span class="o">=&gt;</span> <span class="s1">'密码必须包含数字(0-9)'</span>
<span class="p">);</span>

<span class="c1">// 123456</span>
<span class="k">array</span><span class="p">(</span>
    <span class="s1">'missingCharType'</span> <span class="o">=&gt;</span> <span class="s1">'密码必须包含字母(a-z)'</span>
<span class="p">);</span>

<span class="c1">// abc123</span>
<span class="s1">'Yes'</span><span class="p">;</span>
</code></pre></div>

<h4>推荐的选项组合</h4>

<ul>
<li>
<p>密码最少由6个字符组成,必须包含数字和字母</p>

<div class="highlight"><pre><code class="php"><span class="nx">wei</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">isPassword</span><span class="p">(</span><span class="nv">$input</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">'minLength'</span> <span class="o">=&gt;</span> <span class="mi">6</span><span class="p">,</span>
    <span class="s1">'needDigit'</span> <span class="o">=&gt;</span> <span class="k">true</span><span class="p">,</span>
    <span class="s1">'needLetter'</span> <span class="o">=&gt;</span> <span class="k">true</span><span class="p">,</span>
<span class="p">));</span>
</code></pre></div>
</li>
<li>
<p>密码最少由6个字符组成,必须包含<code>数字</code>,<code>小写字母</code>,<code>大写字母</code>和<code>非数字字母的其他字符</code>中的3种</p>

<div class="highlight"><pre><code class="php"><span class="nx">wei</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">isPassword</span><span class="p">(</span><span class="nv">$input</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">'minLength'</span> <span class="o">=&gt;</span> <span class="mi">6</span><span class="p">,</span>
    <span class="s1">'atLeastPresent'</span> <span class="o">=&gt;</span> <span class="mi">3</span><span class="p">,</span>
<span class="p">));</span>
</code></pre></div>
</li>
</ul><h2>调用方式</h2>

<h3>选项</h3>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>minLength</td>
<td>int</td>
<td>无</td>
<td>密码的最小长度,常用<code>6</code>和<code>8</code>
</td>
</tr>
<tr>
<td>maxLength</td>
<td>int</td>
<td>无</td>
<td>密码的最大长度</td>
</tr>
<tr>
<td>needDigit</td>
<td>bool</td>
<td>false</td>
<td>密码是否必须包含数字</td>
</tr>
<tr>
<td>needLetter</td>
<td>bool</td>
<td>false</td>
<td>密码是否必须包含字母</td>
</tr>
<tr>
<td>needNonAlnum</td>
<td>bool</td>
<td>false</td>
<td>密码是否必须包含非数字字母的其他字符,如!@#</td>
</tr>
<tr>
<td>atLeastPresent</td>
<td>int</td>
<td>0</td>
<td>密码必须包含<code>数字</code>,<code>小写字母</code>,<code>大写字母</code>和<code>非数字字母的其他字符</code>中的几种</td>
</tr>
</tbody>
</table><h3>错误信息</h3>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>信息</th>
</tr></thead>
<tbody>
<tr>
<td>lengthTooShortMessage</td>
<td>%name%的长度必须大于等于%minLength%</td>
</tr>
<tr>
<td>lengthTooLongMessage</td>
<td>%name%的长度必须小于等于%maxLength%</td>
</tr>
<tr>
<td>missingCharTypeMessage</td>
<td>%name%必须包含%missingType%</td>
</tr>
<tr>
<td>missingChar</td>
<td>%name%必须包含%missingType%中的%missingCount%种</td>
</tr>
</tbody>
</table><h3>方法</h3>

<h4>isPassword($input)</h4>

<p>检查组成密码的字符是否符合要求格式</p>
  </section>

<!-- api/request
  ================================================== -->
  <section id="request">
  <div class="page-header"><h1>Request</h1></div>

<p>管理HTTP请求数据($_REQUEST)</p>

<h2>案例</h2>

<h3>获取HTTP请求参数的值</h3>

<div class="highlight"><pre><code class="php"><span class="c1">// 假设 $_REQUEST['id'] = 5;</span>

<span class="c1">// 返回5</span>
<span class="nv">$id</span> <span class="o">=</span> <span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">request</span><span class="p">(</span><span class="s1">'id'</span><span class="p">);</span>
</code></pre></div>

<h3>获取当前请求的URL地址</h3>

<div class="highlight"><pre><code class="php"><span class="nv">$url</span> <span class="o">=</span> <span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">request</span><span class="o">-&gt;</span><span class="na">getUrl</span><span class="p">();</span>
</code></pre></div>

<h3>检查当前请求是否由Ajax发起</h3>

<div class="highlight"><pre><code class="php"><span class="k">if</span> <span class="p">(</span><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">request</span><span class="o">-&gt;</span><span class="na">inAjax</span><span class="p">())</span> <span class="p">{</span>
    <span class="c1">// do something</span>
<span class="p">}</span>
</code></pre></div>

<h3>获取服务器IP地址</h3>

<div class="highlight"><pre><code class="php"><span class="c1">// 假设 $_SERVER['SERVER_ADDR'] = '127.0.0.1';</span>

<span class="c1">// 返回127.0.0.1</span>
<span class="nv">$ip</span> <span class="o">=</span> <span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">request</span><span class="o">-&gt;</span><span class="na">getServer</span><span class="p">(</span><span class="s1">'SERVER_ADDR'</span><span class="p">);</span>
</code></pre></div>

<h2>调用方式</h2>

<h3>选项</h3>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>fromGlobal</td>
<td>bool</td>
<td>true</td>
<td>是否将PHP全局变量作为请求参数,设置为<code>false</code>的话,可以自行构造请求数据</td>
</tr>
<tr>
<td>gets</td>
<td>array</td>
<td>array()</td>
<td>当<code>fromGlobal</code>为true时,相当于<code>$_GET</code>,否则为空</td>
</tr>
<tr>
<td>posts</td>
<td>array</td>
<td>array()</td>
<td>当<code>fromGlobal</code>为true时,相当于<code>$_POST</code>,否则为空</td>
</tr>
<tr>
<td>cookies</td>
<td>array</td>
<td>array()</td>
<td>当<code>fromGlobal</code>为true时,相当于<code>$_COOKIE</code>,否则为空</td>
</tr>
<tr>
<td>servers</td>
<td>array</td>
<td>array()</td>
<td>当<code>fromGlobal</code>为true时,相当于<code>$_SERVER</code>,否则为空</td>
</tr>
<tr>
<td>files</td>
<td>array</td>
<td>array()</td>
<td>当<code>fromGlobal</code>为true时,相当于<code>$_FILES</code>,否则为空</td>
</tr>
<tr>
<td>data</td>
<td>array</td>
<td>array()</td>
<td>当<code>fromGlobal</code>为true时,相当于<code>$_REQUEST</code>,否则为空</td>
</tr>
<tr>
<td>method</td>
<td>string</td>
<td>null</td>
<td>HTTP请求方式</td>
</tr>
</tbody>
</table><h3>方法</h3>

<h4>request($name, $default = null)</h4>

<p>获取HTTP请求参数的字符串值</p>

<h4>request-&gt;getRaw($name, $default = null)</h4>

<p>获取HTTP请求参数的原始值</p>

<h4>request-&gt;getScheme()</h4>

<p>获取URL scheme的值,返回结果为<code>http</code>或<code>https</code></p>

<h4>request-&gt;getHost()</h4>

<p>获取主机的名称,通过域名访问则返回域名地址,通过IP地址访问则返回IP地址</p>

<h4>request-&gt;getRequestUri()</h4>

<p>获取请求的URI地址</p>

<h4>request-&gt;getBaseUrl()</h4>

<p>获取基本URL地址</p>

<h4>request-&gt;getPathInfo()</h4>

<p>获取请求的路径信息,一般用于路由器解析</p>

<h4>request-&gt;getUrl()</h4>

<p>获取用户访问的完整URL地址</p>

<h4>request-&gt;getIp()</h4>

<p>获取访问用户的IP地址</p>

<h4>request-&gt;getMethod()</h4>

<p>获取HTTP请求方式,默认为<code>GET</code></p>

<h4>request-&gt;setMethod($method)</h4>

<p>设置HTTP请求方式,可以通过该接口设置请求为<code>PUT</code>,<code>DELETE</code>等等</p>

<h4>request-&gt;isMethod($method)</h4>

<p>检查HTTP请求方式是否为$method</p>

<h4>request-&gt;isGet()</h4>

<p>检查HTTP请求方式是否为<code>GET</code></p>

<h4>request-&gt;isPost()</h4>

<p>检查HTTP请求方式是否为<code>POST</code></p>

<h4>request-&gt;isAjax()</h4>

<p>检查当前是否为ajax(XMLHttpRequest)请求</p>
  </section>

<!-- api/cookie
  ================================================== -->
  <section id="cookie">
  <div class="page-header"><h1>Cookie</h1></div>

<p>写入,读取和删除cookie($_COOKIE)</p>

<h2>案例</h2>

<h3>写入和读取cookie的值</h3>

<div class="highlight"><pre><code class="php"><span class="c1">// 写入cookie,返回true</span>
<span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">cookie</span><span class="p">(</span><span class="s1">'key'</span><span class="p">,</span> <span class="s1">'value'</span><span class="p">);</span>

<span class="c1">// 读取cookie返回value</span>
<span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">cookie</span><span class="p">(</span><span class="s1">'key'</span><span class="p">);</span>
</code></pre></div>

<h3>写入7天后过期的cookie</h3>

<div class="highlight"><pre><code class="php"><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">cookie</span><span class="p">(</span><span class="s1">'key'</span><span class="p">,</span> <span class="s1">'value'</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">'expires'</span> <span class="o">=&gt;</span> <span class="mi">7</span> <span class="o">*</span> <span class="mi">86400</span><span class="p">));</span>
</code></pre></div>

<h3>删除名称为'logined'的cookie</h3>

<div class="highlight"><pre><code class="php"><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">cookie</span><span class="o">-&gt;</span><span class="na">remove</span><span class="p">(</span><span class="s1">'logined'</span><span class="p">);</span>
</code></pre></div>

<h2>调用方式</h2>

<h3>选项</h3>

<p><em>无</em></p>

<h3>方法</h3>

<h4>cookie($key)</h4>

<p>读取cookie</p>

<h4>cookie($key, $value, $options = array())</h4>

<p>写入cookie</p>

<h4>cookie-&gt;get($key)</h4>

<p>读取cookie,同<code>cookie($key)</code></p>

<h4>cookie-&gt;set($key, $value, $options = array())</h4>

<p>写入cookie,同<code>cookie($key, $value, $options = array())</code></p>

<h4>cookie-&gt;remove($key)</h4>

<p>删除cookie</p>
  </section>

<!-- api/session
  ================================================== -->
  <section id="session">
  <div class="page-header"><h1>Session</h1></div>

<p>管理用户会话信息</p>

<h2>案例</h2>

<h3>使用Session存储验证码,并校验请求的验证码是否正确</h3>

<p>验证码页面</p>

<div class="highlight"><pre><code class="php"><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">session</span><span class="p">(</span><span class="s1">'verfiyCode'</span><span class="p">,</span> <span class="s1">'WIDG'</span><span class="p">);</span>
</code></pre></div>

<p>校验页面</p>

<div class="highlight"><pre><code class="php"><span class="k">if</span> <span class="p">(</span><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">session</span><span class="p">(</span><span class="s1">'verfiyCode'</span><span class="p">)</span> <span class="o">==</span> <span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">request</span><span class="p">(</span><span class="s1">'verfiyCode'</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'验证码正确'</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'验证码错误'</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<h2>调用方式</h2>

<h3>选项</h3>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>namespace</td>
<td>string,false</td>
<td>false</td>
<td>存储会话信息的命名空间,默认不启用</td>
</tr>
<tr>
<td>inis</td>
<td>array</td>
<td>array()</td>
<td>PHP会话配置选项, <a href="http://php.net/manual/en/session.configuration.php" target="_blank">http://php.net/manual/en/session.configuration.php</a>
</td>
</tr>
</tbody>
</table><h3>方法</h3>

<h4>session($key)</h4>

<p>获取会话信息的值</p>

<h4>session($key, $value)</h4>

<p>设置会话信息的值</p>

<h4>session-&gt;get($key)</h4>

<p>获取会话信息的值,同<code>session($key)</code></p>

<h4>session-&gt;set($key, $value)</h4>

<p>设置会话信息的值,同<code>session($key, $value)</code></p>

<h4>session-&gt;remove($key)</h4>

<p>删除指定会话名称</p>

<h4>session-&gt;exists($key)</h4>

<p>检查指定会话名称是否存在</p>

<h4>session-&gt;clear()</h4>

<p>删除当前命名空间的会话信息</p>

<h4>session-&gt;destory()</h4>

<p>删除所有的会话信息</p>

<h4>session-&gt;toArray();</h4>

<p>获取当前命名空间下所有会话信息</p>
  </section>

<!-- api/ua
  ================================================== -->
  <section id="ua">
  <div class="page-header"><h1>Ua</h1></div>

<p>检测客户端浏览器,操作系统和设备是否为指定的名称和版本</p>

<h2>案例</h2>

<h3>根据用户设备跳转到相应的页面</h3>

<div class="highlight"><pre><code class="php"><span class="k">if</span> <span class="p">(</span><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">ua</span><span class="o">-&gt;</span><span class="na">isIphone</span><span class="p">())</span> <span class="p">{</span>
    <span class="c1">// 跳转到iPhone定制页面</span>
<span class="p">}</span> <span class="k">elseif</span> <span class="p">(</span><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">ua</span><span class="o">-&gt;</span><span class="na">isIpad</span><span class="p">())</span> <span class="p">{</span>
    <span class="c1">// 跳转到iPad定制页面</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="c1">// 展示默认页面</span>
<span class="p">}</span>
</code></pre></div>

<h3>获取Windows Phone手机用户的版本</h3>

<div class="highlight"><pre><code class="php"><span class="k">echo</span> <span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">ua</span><span class="o">-&gt;</span><span class="na">getVersion</span><span class="p">(</span><span class="s1">'WindowsPhone'</span><span class="p">);</span>
</code></pre></div>

<h3>如果用户为IE浏览器,输出用浏览器版本</h3>

<div class="highlight"><pre><code class="php"><span class="k">if</span> <span class="p">(</span><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">ua</span><span class="o">-&gt;</span><span class="na">isIe</span><span class="p">())</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">ua</span><span class="o">-&gt;</span><span class="na">getVersion</span><span class="p">(</span><span class="s1">'ie'</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<h3>运行结果</h3>

<div class="highlight"><pre><code class="php"><span class="s1">'10.0'</span>
</code></pre></div>

<h2>调用方式</h2>

<h3>选项</h3>

<p><em>无</em></p>

<h3>方法</h3>

<h4>ua($name)</h4>

<p>检测客户端是否为指定的浏览器,操作系统和手持设备</p>

<h4>ua-&gt;is($name)</h4>

<p>同<code>ua($name)</code></p>

<h4>ua-&gt;getVersion($name)</h4>

<p>获取客户端浏览器,操作系统或手持设备的版本</p>

<h4>ua-&gt;isMobile()</h4>

<p>检查用户是否通过移动设备访问</p>

<h4>ua-&gt;isIe()</h4>

<p>检查用户是否通过IE浏览器访问</p>

<h4>ua-&gt;isChrome()</h4>

<p>检查用户是否通过Chrome浏览器访问</p>

<h4>ua-&gt;isFirefox()</h4>

<p>检查用户是否通过Firefox浏览器访问</p>

<h4>ua-&gt;isIos()</h4>

<p>检查用户是否使用苹果iOS系统</p>

<h4>ua-&gt;isAndroid()</h4>

<p>检查用户是否使用谷歌安卓系统</p>

<h4>ua-&gt;isWindowsPhone()</h4>

<p>检查用户是否使用微软Windows Phone系统</p>

<h4>ua-&gt;isIphone()</h4>

<p>检查用户是否使用iPhone/iPod访问网站</p>

<h4>ua-&gt;isIpad()</h4>

<p>检查用户是否使用iPad访问网站</p>
  </section>

<!-- api/upload
  ================================================== -->
  <section id="upload">
  <div class="page-header"><h1>Upload</h1></div>

<p>保存客户端上传的文件到指定目录</p>

<h2>案例</h2>

<h3>上传单个文件</h3>

<div class="highlight"><pre><code class="php"><span class="nv">$result</span> <span class="o">=</span> <span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">upload</span><span class="p">();</span>
<span class="k">if</span> <span class="p">(</span><span class="nv">$result</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'Yes'</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nb">print_r</span><span class="p">(</span><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">upload</span><span class="o">-&gt;</span><span class="na">getMessages</span><span class="p">());</span>
<span class="p">}</span>
</code></pre></div>

<h3>上传图片文件,限定宽度和高度小于2000px</h3>

<div class="highlight"><pre><code class="php"><span class="nv">$result</span> <span class="o">=</span> <span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">upload</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
    <span class="s1">'maxHeight'</span> <span class="o">=&gt;</span> <span class="mi">2000</span><span class="p">,</span>
    <span class="s1">'maxWidth'</span> <span class="o">=&gt;</span> <span class="mi">2000</span>
<span class="p">));</span>

<span class="k">if</span> <span class="p">(</span><span class="nv">$result</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'Yes'</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nb">print_r</span><span class="p">(</span><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">upload</span><span class="o">-&gt;</span><span class="na">getMessages</span><span class="p">());</span>
<span class="p">}</span>
</code></pre></div>

<h3>在一个请求中批量上传文件</h3>

<div class="highlight"><pre><code class="php"><span class="k">for</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$i</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">;</span> <span class="nv">$i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$result</span> <span class="o">=</span> <span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">upload</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
        <span class="s1">'field'</span> <span class="o">=&gt;</span> <span class="s1">'upload_'</span> <span class="o">.</span> <span class="nv">$i</span>
    <span class="p">));</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$result</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">echo</span> <span class="s1">'文件'</span> <span class="o">.</span> <span class="nv">$i</span> <span class="o">.</span> <span class="s1">'上传成功'</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nb">print_r</span><span class="p">(</span><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">upload</span><span class="o">-&gt;</span><span class="na">getMessages</span><span class="p">());</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h2>调用方式</h2>

<h3>选项</h3>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>field</td>
<td>string</td>
<td>null</td>
<td>上传表单中,文件上传控件name的值,留空将自动获取第一个name的值</td>
</tr>
<tr>
<td>dir</td>
<td>string</td>
<td>uploads</td>
<td>文件保存的目录,默认是<code>uploads</code>
</td>
</tr>
<tr>
<td>fileName</td>
<td>string</td>
<td>nulll</td>
<td>文件保存时的名称(不包括扩展),留空表示使用原来的名称保存</td>
</tr>
<tr>
<td>isImage</td>
<td>bool</td>
<td>false</td>
<td>是否检查上传的文件为图片,默认为否</td>
</tr>
<tr>
<td>maxSize</td>
<td>int</td>
<td>0</td>
<td>允许的文件最大字节数,允许使用类似<code>10.5MB</code>, <code>500KB</code>的文件大小值</td>
</tr>
<tr>
<td>minSize</td>
<td>int</td>
<td>0</td>
<td>允许的文件最小字节数,允许使用类似<code>10.5MB</code>, <code>500KB</code>的文件大小值</td>
</tr>
<tr>
<td>exts</td>
<td>array</td>
<td>array()</td>
<td>允许的文件扩展名</td>
</tr>
<tr>
<td>excludeExts</td>
<td>array</td>
<td>array()</td>
<td>不允许的文件扩展名</td>
</tr>
<tr>
<td>mimeTypes</td>
<td>array</td>
<td>array()</td>
<td>允许的文件媒体类型</td>
</tr>
<tr>
<td>excludeMimeTypes</td>
<td>array</td>
<td>array()</td>
<td>不允许的文件媒体类型</td>
</tr>
<tr>
<td>maxWidth</td>
<td>int</td>
<td>0</td>
<td>允许的图片最大宽度</td>
</tr>
<tr>
<td>maxHeight</td>
<td>int</td>
<td>0</td>
<td>允许的图片最大高度</td>
</tr>
<tr>
<td>minWidth</td>
<td>int</td>
<td>0</td>
<td>允许的图片最小宽度</td>
</tr>
<tr>
<td>minHeight</td>
<td>int</td>
<td>0</td>
<td>允许的图片最小高度</td>
</tr>
<tr>
<td>postSizeMessage</td>
<td>string</td>
<td>没有文件被上传,或您上传的总文件大小超过%postMaxSize%</td>
<td>-</td>
</tr>
<tr>
<td>noFileMessage</td>
<td>string</td>
<td>没有文件被上传</td>
<td>-</td>
</tr>
<tr>
<td>formLimitMessage</td>
<td>string</td>
<td>%name%的大小超过HTML表单设置</td>
<td>-</td>
</tr>
<tr>
<td>partialMessage</td>
<td>string</td>
<td>%name%未完全上传,请再试一遍</td>
<td>-</td>
</tr>
<tr>
<td>noTmpDirMessage</td>
<td>string</td>
<td>未找到上传文件的临时目录</td>
<td>-</td>
</tr>
<tr>
<td>cantWriteMessage</td>
<td>string</td>
<td>无法保存%name%</td>
<td>-</td>
</tr>
<tr>
<td>extensionMessage</td>
<td>string</td>
<td>文件上传被扩展中止</td>
<td>-</td>
</tr>
<tr>
<td>notUploadedFileMessage</td>
<td>string</td>
<td>没有文件被上传,请选择一个文件上传</td>
<td>-</td>
</tr>
<tr>
<td>cantMoveMessage</td>
<td>string</td>
<td>无法移动上传的文件</td>
<td>-</td>
</tr>
<tr>
<td>notDetectedMessage</td>
<td>string</td>
<td>%name%不是有效的图片,或是无法检测到图片的尺寸</td>
<td>-</td>
</tr>
<tr>
<td>widthTooBigMessage</td>
<td>string</td>
<td>%name%的宽度太大(%width%px), 允许的最大宽度为%maxWidth%px</td>
<td>-</td>
</tr>
<tr>
<td>widthTooSmallMessage</td>
<td>string</td>
<td>%name%的宽度太小(%width%px),允许的最小宽度应为%minWidth%px</td>
<td>-</td>
</tr>
<tr>
<td>heightTooBigMessage</td>
<td>string</td>
<td>%name%的高度太大(%height%px), 允许的最大高度为%maxHeight%px</td>
<td>-</td>
</tr>
<tr>
<td>heightTooSmallMessage</td>
<td>string</td>
<td>%name%的高度太小(%height%px), 允许的最小高度为%minHeight%px</td>
<td>-</td>
</tr>
<tr>
<td>notFoundMessage</td>
<td>string</td>
<td>%name%不存在或不可读</td>
<td>-</td>
</tr>
<tr>
<td>maxSizeMessage</td>
<td>string</td>
<td>%name%太大了(%sizeString%),允许的最大文件大小为%maxSizeString%</td>
<td>-</td>
</tr>
<tr>
<td>minSizeMessage</td>
<td>string</td>
<td>%name%太小了(%sizeString%),允许的最小文件大小为%minSizeString%</td>
<td>-</td>
</tr>
<tr>
<td>extsMessage</td>
<td>string</td>
<td>%name%的扩展名(%ext%)不合法,只允许扩展名为:%exts%</td>
<td>-</td>
</tr>
<tr>
<td>excludeExtsMessage</td>
<td>string</td>
<td>%name%的扩展名(%ext%)不合法,不允许扩展名为:%excludeExts%</td>
<td>-</td>
</tr>
<tr>
<td>mimeTypeNotDetectedMessage</td>
<td>string</td>
<td>无法检测%name%的媒体类型</td>
<td>-</td>
</tr>
<tr>
<td>mimeTypesMessage</td>
<td>string</td>
<td>%name%的媒体类型不合法</td>
<td>-</td>
</tr>
<tr>
<td>excludeMimeTypesMessage</td>
<td>string</td>
<td>%name%的媒体类型不合法</td>
<td>-</td>
</tr>
<tr>
<td>negativeMessage</td>
<td>string</td>
<td>%name%必须是不存在的文件</td>
<td>-</td>
</tr>
<tr>
<td>notStringMessage</td>
<td>string</td>
<td>%name%必须是字符串</td>
<td>-</td>
</tr>
</tbody>
</table><h3>方法</h3>

<h4>upload($options)</h4>

<p>上传一个文件</p>

<h4>upload-&gt;getMessages()</h4>

<p>获取错误信息</p>
  </section>

<!-- api/response
  ================================================== -->
  <section id="response">
  <div class="page-header"><h1>Response</h1></div>

<p>发送HTTP响应头和响应内容</p>

<h2>案例</h2>

<h3>发送内容为"Hello World"的HTTP响应</h3>

<div class="highlight"><pre><code class="php"><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">response</span><span class="p">(</span><span class="s1">'Hello World'</span><span class="p">);</span>
</code></pre></div>

<h4>运行结果</h4>

<div class="highlight"><pre><code class="php"><span class="s1">'Hello World'</span>
</code></pre></div>

<h3>获取上面案例中HTTP响应的完整内容</h3>

<div class="highlight"><pre><code class="php"><span class="k">echo</span> <span class="p">(</span><span class="nx">string</span><span class="p">)</span><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">response</span><span class="p">;</span>
</code></pre></div>

<h4>运行结果</h4>

<div class="highlight"><pre><code class="php"><span class="s1">'HTTP/1.1 200 OK</span>

<span class="s1">Hello World'</span>
</code></pre></div>

<h3>让浏览器弹出下载对话框,下载指定的文件</h3>

<div class="highlight"><pre><code class="php"><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">response</span><span class="o">-&gt;</span><span class="na">download</span><span class="p">(</span><span class="k">__FILE__</span><span class="p">);</span>
</code></pre></div>

<h4>运行结果</h4>

<p><img src="resources/download.png" alt="弹出下载对话框"></p>

<h3>逐个打印1-10的数字到浏览器窗口,每隔一秒输出一个</h3>

<div class="highlight"><pre><code class="php"><span class="c1">// 关闭缓冲区,发送HTTP响应等</span>
<span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">response</span><span class="o">-&gt;</span><span class="na">flush</span><span class="p">();</span>

<span class="k">for</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="nv">$i</span> <span class="o">&lt;=</span> <span class="mi">10</span><span class="p">;</span> <span class="nv">$i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="nv">$i</span><span class="p">;</span>
    <span class="nb">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<h2>调用方式</h2>

<h3>选项</h3>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>version</td>
<td>string</td>
<td>1.1</td>
<td>HTTP版本</td>
</tr>
<tr>
<td>statusCode</td>
<td>int</td>
<td>200</td>
<td>HTTP状态码</td>
</tr>
<tr>
<td>statusText</td>
<td>string</td>
<td>OK</td>
<td>HTTP状态消息</td>
</tr>
<tr>
<td>content</td>
<td>string</td>
<td>无</td>
<td>HTTP响应内容</td>
</tr>
<tr>
<td>isSent</td>
<td>bool</td>
<td>false</td>
<td>HTTP响应内容是否已发送</td>
</tr>
<tr>
<td>cookieOption</td>
<td>array</td>
<td>见下表</td>
<td>设置cookie的相关选项</td>
</tr>
<tr>
<td>downloadOption</td>
<td>array</td>
<td>见下表</td>
<td>调用<code>download</code>方法的相关选项</td>
</tr>
<tr>
<td>beforeSend</td>
<td>callable</td>
<td>无</td>
<td>在发送响应前调用的回调</td>
</tr>
<tr>
<td>afterSend</td>
<td>callable</td>
<td>无</td>
<td>在发送响应后调用的回调</td>
</tr>
</tbody>
</table><h4>选项: cookieOption</h4>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>expires</td>
<td>int</td>
<td>86400</td>
<td>cookie相对于现在的过期秒数</td>
</tr>
<tr>
<td>path</td>
<td>string</td>
<td>/</td>
<td>cookie活动的路径</td>
</tr>
<tr>
<td>domain</td>
<td>string</td>
<td>null</td>
<td>保存该cookie的域名</td>
</tr>
<tr>
<td>secure</td>
<td>bool</td>
<td>false</td>
<td>是否只通过HTTPS安全连接来发送,只有在HTTPS连接下才有效</td>
</tr>
<tr>
<td>httpOnly</td>
<td>bool</td>
<td>false</td>
<td>是否只通过HTTP协议发送cookie,如果是,客户端javascript将无法读取到该cookie</td>
</tr>
<tr>
<td>raw</td>
<td>bool</td>
<td>false</td>
<td>是否发送为不经过URL解码的cookie</td>
</tr>
</tbody>
</table><h4>选项: downloadOption</h4>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>filename</td>
<td>string</td>
<td>null</td>
<td>弹出下载对话框时显示的文件名称</td>
</tr>
<tr>
<td>type</td>
<td>string</td>
<td>application/x-download</td>
<td>指定HTTP内容类型（Content-Type）</td>
</tr>
<tr>
<td>disposition</td>
<td>string</td>
<td>attachment</td>
<td>下载的方式,可选项为<code>inline</code>或<code>attachment</code>,如果是<code>inline</code>,浏览器会先尝试直接在浏览器中打开,如果是<code>attachment</code>,浏览器将直接弹出下载对话框</td>
</tr>
</tbody>
</table><h4>回调: beforeSend($response, $content)</h4>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>$response</td>
<td>Widget\Response</td>
<td>当前HTTP响应对象</td>
</tr>
<tr>
<td>$content</td>
<td>string</td>
<td>发送响应的内容</td>
</tr>
</tbody>
</table><h4>回调: afterSend($response)</h4>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr></thead>
<tbody><tr>
<td>$response</td>
<td>Widget\Response</td>
<td>当前HTTP响应对象</td>
</tr></tbody>
</table><h3>方法</h3>

<h4>response($content, $status = null)</h4>

<p>发送HTTP响应头和响应内容</p>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>$content</td>
<td>string</td>
<td>无</td>
<td>HTTP响应的内容</td>
</tr>
<tr>
<td>$stateCode</td>
<td>int</td>
<td>200</td>
<td>HTTP响应的状态码</td>
</tr>
</tbody>
</table><h4>response-&gt;setContent($content)</h4>

<p>设置HTTP响应的内容</p>

<h4>response-&gt;getContent()</h4>

<p>获取HTTP响应的内容</p>

<h4>response-&gt;setStatusCode($code, $text = null)</h4>

<p>设置HTTP响应的状态码</p>

<h4>response-&gt;setStatusCode()</h4>

<p>获取HTTP响应的状态码</p>

<h4>response-&gt;isSent()</h4>

<p>检查内容是否已发送</p>

<h4>response-&gt;setSentStatus($bool)</h4>

<p>设置内容是否已发送</p>

<h4>response-&gt;download($file, $downloadOptions = array())</h4>

<p>下载指定的文件</p>

<h4>response-&gt;flush($content = null, $status = null)</h4>

<p>关闭缓冲区,让后台脚本实时输出内容到浏览器</p>
  </section>

<!-- api/json
  ================================================== -->
  <section id="json">
  <div class="page-header"><h1>Json</h1></div>

<p>输出JSON或JSONP格式的数据到浏览器</p>

<h2>代码范例</h2>

<h3>输出JSON格式的数据</h3>

<div class="highlight"><pre><code class="php"><span class="c1">// 输出 {"code":1,"message":"success"}</span>
<span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">json</span><span class="p">(</span><span class="s1">'success'</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
</code></pre></div>

<h3>输出JSONP格式的数据</h3>

<div class="highlight"><pre><code class="php"><span class="c1">// 假设URL请求地址为 index.php?callback=callback</span>
<span class="c1">// 下面的调用将输出 callback({"code":1,"message":"success"})</span>
<span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">json</span><span class="p">(</span><span class="s1">'success'</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="k">array</span><span class="p">(),</span> <span class="k">true</span><span class="p">);</span>
</code></pre></div>

<h2>调用方式</h2>

<h3>选项</h3>

<p><em>无</em></p>

<h3>方法</h3>

<h4>json($message, $code = 1, $append = array(), $jsonp = false)</h4>

<p>参数</p>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>$message</td>
<td>string</td>
<td>无</td>
<td>返回message的值</td>
</tr>
<tr>
<td>$code</td>
<td>int</td>
<td>1</td>
<td>返回code的值</td>
</tr>
<tr>
<td>$append</td>
<td>array</td>
<td>array()</td>
<td>附加的数据</td>
</tr>
<tr>
<td>$jsonp</td>
<td>bool</td>
<td>false</td>
<td>是否允许返回JSONP格式的数据</td>
</tr>
</tbody>
</table>
  </section>

<!-- api/redirect
  ================================================== -->
  <section id="redirect">
  <div class="page-header"><h1>Redirect</h1></div>

<p>跳转到指定地址</p>

<h2>案例</h2>

<h3>等待3秒后跳转到谷歌首页</h3>

<div class="highlight"><pre><code class="php"><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">redirect</span><span class="p">(</span><span class="s1">'http://www.google.com'</span><span class="p">,</span> <span class="mi">302</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">'wait'</span> <span class="o">=&gt;</span> <span class="mi">3</span>
<span class="p">));</span>
</code></pre></div>

<h3>直接跳转到谷歌首页</h3>

<div class="highlight"><pre><code class="php"><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">redirect</span><span class="p">(</span><span class="s1">'http://www.google.com'</span><span class="p">);</span>
</code></pre></div>

<h3>自定义跳转视图</h3>

<p>设置全局跳转视图文件</p>

<div class="highlight"><pre><code class="php"><span class="nx">widget</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
    <span class="s1">'redirect'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">'view'</span> <span class="o">=&gt;</span> <span class="s1">'path/to/redirect.php'</span>
    <span class="p">)</span>
<span class="p">));</span>
</code></pre></div>

<p>文件<code>path/to/redirect.php</code></p>

<div class="highlight"><pre><code class="php"><span class="o">&lt;!</span><span class="nx">DOCTYPE</span> <span class="nx">html</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="nx">html</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="nx">head</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="nx">meta</span> <span class="nx">charset</span><span class="o">=</span><span class="s2">"utf-8"</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="nx">meta</span> <span class="nx">http</span><span class="o">-</span><span class="nx">equiv</span><span class="o">=</span><span class="s2">"refresh"</span> <span class="nx">content</span><span class="o">=</span><span class="s2">"&lt;?= </span><span class="si">$wait</span><span class="s2"> ?&gt;;url=&lt;?= </span><span class="si">$escapedUrl</span><span class="s2"> ?&gt;"</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="nx">title</span><span class="o">&gt;</span><span class="err">正在跳转到</span> <span class="o">&lt;?=</span> <span class="nv">$escapedUrl</span> <span class="cp">?&gt;</span><span class="x">&lt;/title&gt;</span>
<span class="x">  &lt;/head&gt;</span>
<span class="x">  &lt;body&gt;</span>
<span class="x">    &lt;h1&gt;跳转到&lt;a href="</span><span class="cp">&lt;?</span><span class="o">=</span> <span class="nv">$escapedUrl</span> <span class="cp">?&gt;</span><span class="x">"&gt;</span><span class="cp">&lt;?</span><span class="o">=</span> <span class="nv">$escapedUrl</span> <span class="cp">?&gt;</span><span class="x">&lt;/a&gt;&lt;/h1&gt;</span>
<span class="x">  &lt;/body&gt;</span>
<span class="x">&lt;/html&gt;</span>
</code></pre></div>

<blockquote>
<h4>注意</h4>

<p>使用<code>view</code>选项自定义视图时,需要自行处理跳转逻辑</p>
</blockquote>

<h2>调用方式</h2>

<h3>选项</h3>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>wait</td>
<td>int</td>
<td>0</td>
<td>等待跳转的秒数,如果wait为0,使用的是HTTP header跳转,如果不为0,因为HTTP header不支持延迟跳转,所以使用的是HTML <a href="http://en.wikipedia.org/wiki/Meta_refresh" target="_blank">Meta refresh</a>跳转</td>
</tr>
<tr>
<td>statusCode</td>
<td>int</td>
<td>302</td>
<td>跳转的HTTP状态码</td>
</tr>
<tr>
<td>view</td>
<td>string</td>
<td>无</td>
<td>自定义跳转视图的文件,可以设置该选项以展示更加友好的跳转视图</td>
</tr>
</tbody>
</table><h3>方法</h3>

<h4>redirect($url, $status = 302, $options = array())</h4>

<p>跳转到指定地址</p>

<h4>redirect-&gt;setWait($wait)</h4>

<p>设置默认的等待时间</p>

<h4>redirect-&gt;setView($view)</h4>

<p>设置默认的跳转视图</p>
  </section>

<!-- api/escape
  ================================================== -->
  <section id="escape">
  <div class="page-header"><h1>Escape</h1></div>

<p>转义字符串中的特殊字符,以便安全的输出到网页中,支持HTML,JS,CSS,HTML属性和URL的转义</p>

<h2>案例</h2>

<h3>转义HTML字符串</h3>

<div class="highlight"><pre><code class="php"><span class="k">echo</span> <span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">escape</span><span class="p">(</span><span class="s1">'&lt;script&gt;alert("xss")&lt;/script&gt;'</span><span class="p">);</span>
</code></pre></div>

<h4>运行结果</h4>

<div class="highlight"><pre><code class="php"><span class="s1">'&amp;lt;script&amp;gt;alert(&amp;quot;xss&amp;quot;)&amp;lt;/script&amp;gt;'</span>
</code></pre></div>

<h3>转义Javascript字符串</h3>

<div class="highlight"><pre><code class="php"><span class="k">echo</span> <span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">escape</span><span class="o">-&gt;</span><span class="na">js</span><span class="p">(</span><span class="s1">'bar&amp;quot;; alert(&amp;quot;Meow!&amp;quot;); var xss=&amp;quot;true'</span><span class="p">);</span>
</code></pre></div>

<h4>运行结果</h4>

<div class="highlight"><pre><code class="php"><span class="s1">'bar\x26quot\x3B\x3B\x20alert\x28\x26quot\x3BMeow\x21\x26quot\x3B\x29\x3B\x20var\x20xss\x3D\x26quot\x3Btrue'</span>
</code></pre></div>

<h3>转义CSS字符串</h3>

<div class="highlight"><pre><code class="php"><span class="k">echo</span> <span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">escape</span><span class="o">-&gt;</span><span class="na">css</span><span class="p">(</span><span class="s2">"background-image: url('http://example.com/foo.jpg?&lt;/style&gt;&lt;script&gt;alert(1)&lt;/script&gt;');"</span><span class="p">);</span>
</code></pre></div>

<h4>运行结果</h4>

<div class="highlight"><pre><code class="php"><span class="s1">'background\2D image\3A \20 url\28 \27 http\3A \2F \2F example\2E com\2F foo\2E jpg\3F \3C \2F style\3E \3C script\3E alert\28 1\29 \3C \2F script\3E \27 \29 \3B '</span>
</code></pre></div>

<h3>转义HTML属性字符串</h3>

<div class="highlight"><pre><code class="php"><span class="k">echo</span> <span class="s1">'&lt;span title='</span><span class="p">;</span>
<span class="k">echo</span> <span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">escape</span><span class="o">-&gt;</span><span class="na">attr</span><span class="p">(</span><span class="s2">"faketitle onmouseover=alert(/xss/);"</span><span class="p">);</span>
<span class="k">echo</span> <span class="s1">'&gt;hi&lt;/span&gt;'</span><span class="p">;</span>
</code></pre></div>

<h4>运行结果</h4>

<div class="highlight"><pre><code class="php"><span class="s1">'&lt;span title=faketitle&amp;#x20;onmouseover&amp;#x3D;alert&amp;#x28;&amp;#x2F;xss&amp;#x2F;&amp;#x29;&amp;#x3B;&gt;hi&lt;/span&gt;'</span>
</code></pre></div>

<h3>转义URL字符串</h3>

<div class="highlight"><pre><code class="php"><span class="k">echo</span> <span class="s1">'&lt;a href="http://example.com/?name='</span><span class="p">;</span>
<span class="k">echo</span> <span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">escape</span><span class="o">-&gt;</span><span class="na">url</span><span class="p">(</span><span class="s2">"onmouseover= </span><span class="se">\"</span><span class="s2">alert('zf2')"</span><span class="p">);</span>
<span class="k">echo</span> <span class="s1">'"&gt;Click here!&lt;/a&gt;'</span><span class="p">;</span>
</code></pre></div>

<h4>运行结果</h4>

<div class="highlight"><pre><code class="php"><span class="s1">'&lt;a href="http://example.com/?name=onmouseover%3D%20%22alert%28%27zf2%27%29"&gt;Click here!&lt;/a&gt;'</span>
</code></pre></div>

<h2>说明</h2>

<p>Escape对象是基于<a href="https://github.com/zendframework/zf2/tree/master/library/Zend/Escaper" target="_blank">Zend\Escaper</a>组件的字符串安全转义器.
Escape对象的用法与Zend\Escaper基本一致.关于Zend\Escaper的文档可以查看这里
<a href="http://framework.zend.com/manual/2.1/en/modules/zend.escaper.introduction.html" target="_blank">http://framework.zend.com/manual/2.1/en/modules/zend.escaper.introduction.html</a></p>

<h2>调用方式</h2>

<h3>选项</h3>

<p><em>无</em></p>

<h3>方法</h3>

<h4>escape($input, $type = 'html')</h4>

<p>转义HTML字符串</p>

<h4>escape-&gt;html($input)</h4>

<p>转义HTML字符串</p>

<h4>escape-&gt;js($input)</h4>

<p>转义Javascript字符串</p>

<h4>escape-&gt;css($input)</h4>

<p>转义CSS字符串</p>

<h4>escape-&gt;attr($input)</h4>

<p>转义HTML属性字符串</p>

<h4>escape-&gt;url($input)</h4>

<p>转义URL字符串</p>
  </section>

<!-- api/view
  ================================================== -->
  <section id="view">
  <div class="page-header"><h1>View</h1></div>

<p>渲染指定名称的模板或获取视图对象</p>

<h2>案例</h2>

<h3>渲染带布局的模板<code>template.php</code>
</h3>

<div class="highlight"><pre><code class="php"><span class="c1">// 设置模板所在的目录</span>
<span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">view</span><span class="o">-&gt;</span><span class="na">setDirs</span><span class="p">(</span><span class="nx">__DIR__</span> <span class="o">.</span> <span class="s1">'/fixtures'</span><span class="p">);</span>

<span class="c1">// View对象将先渲染`template.php`文件,再把渲染结果存储到变量`$content`中,再渲染layout.php文件,并输出运行结果</span>
<span class="k">echo</span> <span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">view</span><span class="o">-&gt;</span><span class="na">render</span><span class="p">(</span><span class="s1">'template.php'</span><span class="p">);</span>
</code></pre></div>

<p>文件<code>template.php</code></p>

<div class="highlight"><pre><code class="php"><span class="o">&lt;?</span><span class="nx">php</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">layout</span><span class="p">(</span><span class="s1">'layout.php'</span><span class="p">)</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="x">Template Content</span>
</code></pre></div>

<p>文件<code>layout.php</code></p>

<div class="highlight"><pre><code class="php"><span class="nx">Layout</span> <span class="nx">Header</span>
<span class="o">&lt;?=</span> <span class="nv">$content</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="x">Layout Footer</span>
</code></pre></div>

<h4>运行结果</h4>

<div class="highlight"><pre><code class="php"><span class="s1">'Layout Header</span>
<span class="s1">Template Content</span>
<span class="s1">Layout Footer'</span>
</code></pre></div>

<h2>调用方式</h2>

<h3>选项</h3>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>vars</td>
<td>array</td>
<td>无</td>
<td>模板变量</td>
</tr>
<tr>
<td>dirs</td>
<td>array</td>
<td>无</td>
<td>模板所在的目录</td>
</tr>
<tr>
<td>extension</td>
<td>string</td>
<td>.php</td>
<td>默认的模板扩展名</td>
</tr>
</tbody>
</table><h3>方法</h3>

<h4>view($name, $vars = array())</h4>

<p>渲染指定名称的模板</p>

<h4>view()</h4>

<p>获取视图对象</p>

<h4>view-&gt;render($name, $vars = array())</h4>

<p>渲染指定名称的模板,同<code>view($name, $vars = array())</code></p>

<h4>view-&gt;display($name, $vars = array())</h4>

<p>渲染并输出指定名称的模板</p>

<h4>view-&gt;assign($name, $value)</h4>

<p>设置视图变量</p>

<h4>view-&gt;get($name)</h4>

<p>获取视图变量</p>

<h4>view-&gt;getFile()</h4>

<p>获取模板文件</p>

<h4>view-&gt;layout($name, $variable = 'content')</h4>

<p>设置模板的父模板名称</p>

<h4>view-&gt;setDirs($dirs)</h4>

<p>设置模板所在的目录</p>
  </section>

<!-- api/arr
  ================================================== -->
  <section id="arr">
  <div class="page-header"><h1>Arr</h1></div>

<p>数组工具类,提供一些实用的数组操作方法</p>

<h2>案例</h2>

<h3>获取数组或对象中指定键名的值</h3>

<div class="highlight"><pre><code class="php"><span class="k">class</span> <span class="nc">Getter</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">getKey</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="s1">'Get from Getter'</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="nv">$data</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
    <span class="k">array</span><span class="p">(</span>
        <span class="s1">'key'</span> <span class="o">=&gt;</span> <span class="s1">'Get from array'</span><span class="p">,</span>
    <span class="p">),</span>
    <span class="k">new</span> <span class="nx">\ArrayObject</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
        <span class="s1">'key'</span> <span class="o">=&gt;</span> <span class="s1">'Get from ArrayObject'</span>
    <span class="p">)),</span>
    <span class="nb">call_user_func</span><span class="p">(</span><span class="k">function</span><span class="p">(){</span>
        <span class="nv">$object</span> <span class="o">=</span> <span class="k">new</span> <span class="k">stdClass</span><span class="p">();</span>
        <span class="nv">$object</span><span class="o">-&gt;</span><span class="na">key</span> <span class="o">=</span> <span class="s1">'Get from stdClass'</span><span class="p">;</span>
        <span class="k">return</span> <span class="nv">$object</span><span class="p">;</span>
    <span class="p">}),</span>
    <span class="k">new</span> <span class="nx">Getter</span><span class="p">()</span>
<span class="p">);</span>

<span class="k">foreach</span> <span class="p">(</span><span class="nv">$data</span> <span class="k">as</span> <span class="nv">$row</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">arr</span><span class="o">-&gt;</span><span class="na">attr</span><span class="p">(</span><span class="nv">$row</span><span class="p">,</span> <span class="s1">'key'</span><span class="p">)</span> <span class="o">.</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<h3>运行结果</h3>

<div class="highlight"><pre><code class="php"><span class="s1">'Get from array'</span>

<span class="s1">'Get from ArrayObject'</span>

<span class="s1">'Get from stdClass'</span>

<span class="s1">'Get from Getter'</span>
</code></pre></div>

<h3>对二维数组进行按order键名,从大到小排序</h3>

<div class="highlight"><pre><code class="php"><span class="nv">$data</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
    <span class="k">array</span><span class="p">(</span><span class="s1">'id'</span> <span class="o">=&gt;</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">'order'</span> <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">),</span>
    <span class="k">array</span><span class="p">(</span><span class="s1">'id'</span> <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">'order'</span> <span class="o">=&gt;</span> <span class="mi">2</span><span class="p">)</span>
<span class="p">);</span>

<span class="nb">print_r</span><span class="p">(</span><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">arr</span><span class="o">-&gt;</span><span class="na">sort</span><span class="p">(</span><span class="nv">$data</span><span class="p">,</span> <span class="s1">'order'</span><span class="p">,</span> <span class="nx">SORT_DESC</span><span class="p">));</span>
</code></pre></div>

<h3>运行结果</h3>

<div class="highlight"><pre><code class="php"><span class="k">Array</span>
<span class="p">(</span>
    <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="k">Array</span>
        <span class="p">(</span>
            <span class="p">[</span><span class="nx">id</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="mi">1</span>
            <span class="p">[</span><span class="nx">order</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="mi">2</span>
        <span class="p">)</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="k">Array</span>
        <span class="p">(</span>
            <span class="p">[</span><span class="nx">id</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="mi">2</span>
            <span class="p">[</span><span class="nx">order</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="mi">1</span>
        <span class="p">)</span>
<span class="p">)</span>
</code></pre></div>

<h2>调用方法</h2>

<h3>选项</h3>

<p><em>无</em></p>

<h3>方法</h3>

<h4>arr-&gt;attr($data, $key)</h4>

<p>获取数组或对象中指定键名的值</p>

<p>取值的顺序如下</p>

<ol>
<li>如果<code>$data</code>是数组或<code>\ArrayAccess</code>的实例化对象,检查并返回<code>$data[$key]</code>的值</li>
<li>如果<code>$data</code>是对象,检查属性<code>$key</code>是否存在,存在则返回<code>$data-&gt;$key</code>的值</li>
<li>如果<code>$data</code>是对象且方法<code>get. $key</code>存在,返回<code>$data-&gt;{'get' . $key}</code>
</li>
<li>如果以上均不存在,返回null</li>
</ol><p>使用<code>attr()</code>方法的好处在于你不用关心要取值的变量类型,不管它是数组,对象数组(\ArrayAccess),还是
其他对象</p>

<h4>arr-&gt;sort($array, $key = 'order', $type = SORT_ASC)</h4>

<p>对一个二维数组进行排序,类似SQL的ORDER BY语句</p>
  </section>

<!-- api/config
  ================================================== -->
  <section id="config">
  <div class="page-header"><h1>Config</h1></div>

<p>配置数据管理</p>

<h2>案例</h2>

<h3>设置和获取配置</h3>

<div class="highlight"><pre><code class="php"><span class="c1">// 设置配置项'title'的值为'Widget Documentation'</span>
<span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">setConfig</span><span class="p">(</span><span class="s1">'title'</span><span class="p">,</span> <span class="s1">'Widget Documentation'</span><span class="p">);</span>

<span class="c1">// 输出配置项'title'的值</span>
<span class="k">echo</span> <span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">getConfig</span><span class="p">(</span><span class="s1">'title'</span><span class="p">);</span>
</code></pre></div>

<h3>批量设置配置数据</h3>

<div class="highlight"><pre><code class="php"><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">setConfig</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
    <span class="s1">'yesOrNo'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">'y'</span> <span class="o">=&gt;</span> <span class="s1">'是'</span><span class="p">,</span>
        <span class="s1">'n'</span> <span class="o">=&gt;</span> <span class="s1">'否'</span>
    <span class="p">),</span>
    <span class="s1">'gender'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">'m'</span> <span class="o">=&gt;</span> <span class="s1">'男'</span><span class="p">,</span>
        <span class="s1">'f'</span> <span class="o">=&gt;</span> <span class="s1">'女'</span>
    <span class="p">),</span>
    <span class="s1">'priorities'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="o">-</span><span class="mi">10</span> <span class="o">=&gt;</span> <span class="s1">'低'</span><span class="p">,</span>
        <span class="mi">0</span>   <span class="o">=&gt;</span> <span class="s1">'中'</span><span class="p">,</span>
        <span class="mi">10</span>  <span class="o">=&gt;</span> <span class="s1">'高'</span>
    <span class="p">),</span>
    <span class="s1">'statuses'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">'draft'</span>     <span class="o">=&gt;</span> <span class="s1">'草稿箱'</span><span class="p">,</span>
        <span class="s1">'inProcess'</span> <span class="o">=&gt;</span> <span class="s1">'进行中'</span><span class="p">,</span>
        <span class="s1">'done'</span>      <span class="o">=&gt;</span> <span class="s1">'完成'</span><span class="p">,</span>
    <span class="p">)</span>
<span class="p">));</span>
</code></pre></div>

<h3>输出HTML option标签</h3>

<div class="highlight"><pre><code class="php"><span class="k">echo</span> <span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">config</span><span class="o">-&gt;</span><span class="na">toOptions</span><span class="p">(</span><span class="s1">'yesOrNo'</span><span class="p">);</span>

<span class="c1">// 输出</span>
<span class="s1">'&lt;option value="y"&gt;是&lt;/option&gt;&lt;option value="n"&gt;否&lt;/option&gt;'</span><span class="p">;</span>
</code></pre></div>

<h3>输出JSON数据</h3>

<div class="highlight"><pre><code class="php"><span class="k">echo</span> <span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">config</span><span class="o">-&gt;</span><span class="na">toJson</span><span class="p">(</span><span class="s1">'yesOrNo'</span><span class="p">);</span>

<span class="c1">// 输出</span>
<span class="s1">'{"y":"\u662f","n":"\u5426"}'</span><span class="p">;</span>
</code></pre></div>

<h2>调用方式</h2>

<h3>选项</h3>

<p><em>无</em></p>

<h3>方法</h3>

<h4>widget-&gt;setConfig($name, $default = null)</h4>

<p>设置配置</p>

<h4>widget-&gt;getConfig($name, $value)</h4>

<p>获取配置</p>

<h4>config-&gt;toJson($name)</h4>

<p>转换配置为JSON字符串</p>

<h4>config-&gt;toOptions($name)</h4>

<p>转换配置为HTML下拉菜单选项</p>
  </section>

<!-- api/env
  ================================================== -->
  <section id="env">
  <div class="page-header"><h1>Env</h1></div>

<p>环境检测及根据不同环境加载不同的配置文件</p>

<h2>案例</h2>

<h3>在Widget初始化时根据环境加载配置</h3>

<div class="highlight"><pre><code class="php"><span class="nx">widget</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
    <span class="s1">'widget'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">'preload'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
            <span class="s1">'env'</span> <span class="c1">// 在预加载选项增加env对象</span>
        <span class="p">)</span>
    <span class="p">),</span>
    <span class="c1">// 配置env对象的选项</span>
    <span class="s1">'env'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="c1">// 配置环境的目录,%env%会替换成当前的环境名称</span>
        <span class="s1">'configDir'</span> <span class="o">=&gt;</span> <span class="s1">'config/config_%env%.php'</span>
    <span class="p">)</span>
<span class="p">));</span>
</code></pre></div>

<h3>判断当前是否在开发环境</h3>

<div class="highlight"><pre><code class="php"><span class="k">if</span> <span class="p">(</span><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">env</span><span class="o">-&gt;</span><span class="na">isDev</span><span class="p">())</span> <span class="p">{</span>
    <span class="c1">// do something</span>
<span class="p">}</span>
</code></pre></div>

<h2>调用方式</h2>

<h3>选项</h3>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>env</td>
<td>string</td>
<td>无</td>
<td>当前环境名称</td>
</tr>
<tr>
<td>detector</td>
<td>callable</td>
<td>无</td>
<td>检测环境名称的回调结构</td>
</tr>
<tr>
<td>envMap</td>
<td>array</td>
<td>array('127.0.0.1' =&gt; 'dev')</td>
<td>服务器IP地址与环境名称的对应列表,键名为服务器IP地址,值为环境名称</td>
</tr>
<tr>
<td>configDir</td>
<td>string</td>
<td>config/config_%env%.php</td>
<td>配置环境的目录,<code>%env%</code>会替换成当前的环境名称</td>
</tr>
</tbody>
</table><h4>环境名称的检测顺序</h4>

<ol>
<li>如果用户设置了<code>env</code>选项,使用<code>env</code>作为环境名称</li>
<li>如果用户设置了回调结构<code>detector</code>选项,调用<code>detector</code>获取返回值作为环境名称</li>
<li>如果当前的服务器IP地址在<code>envMap</code>的键名之中,使用对应的值作为环境名称</li>
<li>使用<code>prod</code>作为环境名称</li>
</ol><h3>方法</h3>

<h4>env()</h4>

<p>获取环境名称</p>

<h4>env-&gt;getEnv()</h4>

<p>获取环境名称</p>

<h4>env-&gt;isDev()</h4>

<p>检查是否为开发环境</p>

<h4>env-&gt;isTest()</h4>

<p>检查是否为测试(Beta,演示)环境</p>

<h4>env-&gt;isProd()</h4>

<p>检查是否为生产(线上)环境</p>
  </section>

<!-- api/error
  ================================================== -->
  <section id="error">
  <div class="page-header"><h1>Error</h1></div>

<p>错误处理器,可自定义异常,404和fatal错误的处理</p>

<h2>案例</h2>

<h3>自定义404错误页面</h3>

<div class="highlight"><pre><code class="php"><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">error</span><span class="o">-&gt;</span><span class="na">notFound</span><span class="p">(</span><span class="k">function</span><span class="p">(</span><span class="nv">$exception</span><span class="p">){</span>
    <span class="c1">// 输出错误提醒,这里可以改成加载错误视图,记录错误日志等</span>
    <span class="k">echo</span> <span class="s1">'Page not found'</span><span class="p">;</span>

    <span class="c1">// 返回true表示错误已处理,不再输出默认的错误也页面</span>
    <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
<span class="p">});</span>

<span class="c1">// 抛出404错误</span>
<span class="k">throw</span> <span class="k">new</span> <span class="nx">\Exception</span><span class="p">(</span><span class="s1">'Page not found'</span><span class="p">,</span> <span class="mi">404</span><span class="p">);</span>
</code></pre></div>

<h3>选项</h3>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>message</td>
<td>string</td>
<td>Error</td>
<td>错误标题</td>
</tr>
<tr>
<td>detail</td>
<td>string</td>
<td>Unfortunately, an error occurred. Please try again later.</td>
<td>未开启调试模式时的错误信息</td>
</tr>
<tr>
<td>notFoundDetail</td>
<td>string</td>
<td>Sorry, the page you requested was not found. Please check the URL and try again.</td>
<td>未开启调试模式时的404错误信息</td>
</tr>
<tr>
<td>ignorePrevHandler</td>
<td>bool</td>
<td>false</td>
<td>是否忽略已有的异常处理器</td>
</tr>
</tbody>
</table><h3>方法</h3>

<h4>error($fn)</h4>

<p>设置自定义的错误处理器</p>

<p>处理器的参数如下表.</p>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>$exception</td>
<td>Exception</td>
<td>异常对象</td>
</tr>
<tr>
<td>$widget</td>
<td>Widget\Widget</td>
<td>对象管理器</td>
</tr>
</tbody>
</table><h3>error-&gt;notFound($fn)</h3>

<p>设置404的错误处理器</p>

<h3>error-&gt;fatal($fn)</h3>

<p>设置Fatal错误的处理器</p>
  </section>

<!-- api/gravatar
  ================================================== -->
  <section id="gravatar">
  <div class="page-header"><h1>Gravatar</h1></div>

<p>根据邮箱地址生成自定义大小的Gravatar头像</p>

<h2>案例</h2>

<h3>生成默认大小(80px)的Gravatar头像</h3>

<div class="highlight"><pre><code class="php"><span class="k">echo</span> <span class="s1">'&lt;img src="'</span> <span class="o">.</span> <span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">gravatar</span><span class="p">(</span><span class="s1">'twinhuang@qq.com'</span><span class="p">)</span> <span class="o">.</span> <span class="s1">'" /&gt;'</span><span class="p">;</span>
</code></pre></div>

<h4>页面显示效果</h4>


<h3>生成预设定大小的Gravatar头像</h3>

<div class="highlight"><pre><code class="php"><span class="c1">// 输出较小尺寸(48px)的Gravatar头像</span>
<span class="k">echo</span> <span class="s1">'&lt;img src="'</span> <span class="o">.</span> <span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">gravatar</span><span class="o">-&gt;</span><span class="na">small</span><span class="p">(</span><span class="s1">'twinhuang@qq.com'</span><span class="p">)</span> <span class="o">.</span> <span class="s1">'" /&gt;'</span><span class="p">;</span>

<span class="c1">// 输出较大尺寸(200px)的Gravatar头像</span>
<span class="k">echo</span> <span class="s1">'&lt;img src="'</span> <span class="o">.</span> <span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">gravatar</span><span class="o">-&gt;</span><span class="na">large</span><span class="p">(</span><span class="s1">'twinhuang@qq.com'</span><span class="p">)</span> <span class="o">.</span> <span class="s1">'" /&gt;'</span><span class="p">;</span>
</code></pre></div>

<h4>页面显示效果</h4>



<h3>自定义默认图片</h3>

<div class="highlight"><pre><code class="php"><span class="nx">widget</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
    <span class="s1">'gravatar'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">'default'</span> <span class="o">=&gt;</span> <span class="s1">'http://i2.wp.com/a248.e.akamai.net/assets.github.com/images/gravatars/gravatar-user-420.png'</span>
    <span class="p">)</span>
<span class="p">));</span>

<span class="k">echo</span> <span class="s1">'&lt;img height="80" src="'</span> <span class="o">.</span> <span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">gravatar</span><span class="p">(</span><span class="s1">'twinhuang@example.com'</span><span class="p">)</span> <span class="o">.</span> <span class="s1">'" /&gt;'</span><span class="p">;</span>
</code></pre></div>

<h4>页面显示效果</h4>


<h2>调用方式</h2>

<h3>选项</h3>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>default</td>
<td>string</td>
<td>mm</td>
<td>当邮箱没有对应的Gravatar头像时显示的图片,可以是预设的图片类型(包括<code>404</code>, <code>mm</code>, <code>identicon</code>, <code>monsterid</code>或<code>wavatar</code>),也可以自定义的图片地址</td>
</tr>
<tr>
<td>secure</td>
<td>bool</td>
<td>false</td>
<td>是否输出HTTPS协议的图片地址</td>
</tr>
<tr>
<td>size</td>
<td>int</td>
<td>80</td>
<td>默认的头像图片大小</td>
</tr>
<tr>
<td>smallSize</td>
<td>int</td>
<td>48</td>
<td>自定义的小头像图片大小</td>
</tr>
<tr>
<td>largeSize</td>
<td>int</td>
<td>200</td>
<td>自定义的大头像图片大小</td>
</tr>
</tbody>
</table><h3>方法</h3>

<h4>gravatar($email, $size = null, $default = null, $rating = null)</h4>

<p>根据邮箱地址生成自定义大小的Gravatar头像</p>

<h4>gravatar-&gt;small($email, $default = null, $rating = null)</h4>

<p>根据邮箱地址生成较小尺寸(48px)的Gravatar头像</p>

<h4>gravatar-&gt;large($email, $default = null, $rating = null)</h4>

<p>根据邮箱地址生成较大尺寸(200px)的Gravatar头像</p>
  </section>

<!-- api/logger
  ================================================== -->
  <section id="logger">
  <div class="page-header"><h1>Logger</h1></div>

<p>记录日志到文件中</p>

<h2>案例</h2>

<h3>记录一条DEBUG级别的日志</h3>

<div class="highlight"><pre><code class="php"><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">logger</span><span class="o">-&gt;</span><span class="na">debug</span><span class="p">(</span><span class="s1">'The logger is called'</span><span class="p">);</span>

<span class="c1">// 输出日志文件的路径</span>
<span class="k">echo</span> <span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">logger</span><span class="o">-&gt;</span><span class="na">getFile</span><span class="p">();</span>

<span class="c1">// 可以在日志文件看到类似格式的一条日志</span>
<span class="c1">// [XXXX-XX-XX XX:XX:XX] widget.DEBUG: The logger is called</span>
</code></pre></div>

<h2>调用方式</h2>

<h3>选项</h3>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody>
<tr>
<td>name</td>
<td>string</td>
<td>widget</td>
<td>日志的名称,可以每个模块设定一个名称进行区分</td>
</tr>
<tr>
<td>level</td>
<td>string</td>
<td>debug</td>
<td>默认的日志级别</td>
</tr>
<tr>
<td>handledLevel</td>
<td>string</td>
<td>debug</td>
<td>记录到文件的最低日志等级,低于该等级的日志将不记录到文件中</td>
</tr>
<tr>
<td>format</td>
<td>string</td>
<td>[%datetime%] %channel%.%level%: %message%\n</td>
<td>日志的格式</td>
</tr>
<tr>
<td>dateFormat</td>
<td>string</td>
<td>Y-m-d H:i:s</td>
<td>日志中日期的格式,使用<a href="http://php.net/manual/en/function.date.php" target="_blank">date</a>函数转换</td>
</tr>
<tr>
<td>file</td>
<td>string</td>
<td>无</td>
<td>日志文件的路径,留空是根据日志目录和文件名称生成</td>
</tr>
<tr>
<td>dir</td>
<td>string</td>
<td>log</td>
<td>日志文件的目录</td>
</tr>
<tr>
<td>fileFormat</td>
<td>string</td>
<td>Ymd.\l\o\g</td>
<td>日志文件名称的格式</td>
</tr>
<tr>
<td>fileSize</td>
<td>int</td>
<td>134217728</td>
<td>日志文件最大容量,单位是字节,默认是128mb,设为0表示不限制大小</td>
</tr>
</tbody>
</table><h4>日志等级及使用场景</h4>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>级别</th>
<th>使用场景</th>
</tr></thead>
<tbody>
<tr>
<td>debug</td>
<td>低</td>
<td>具体的调试信息,如某个函数被调用了,某个参数的值,主要用于调试</td>
</tr>
<tr>
<td>info</td>
<td>低</td>
<td>有用的信息,如某某用户登录了,SQL日志</td>
</tr>
<tr>
<td>warning</td>
<td>中</td>
<td>个别情况出现的信息,例如使用废弃的接口,接口使用场景错误,配置错误</td>
</tr>
<tr>
<td>error</td>
<td>中</td>
<td>运行中的错误,不需要马上处理,但应该被记录及监控,如邮件发送失败</td>
</tr>
<tr>
<td>critical</td>
<td>高</td>
<td>严重的情况,如某个组件不可用,未捕获的异常</td>
</tr>
<tr>
<td>alert</td>
<td>高</td>
<td>必须马上处理的情况,如网站打不开,数据库连不上,这种情况下应该发送短信通知你处理!</td>
</tr>
</tbody>
</table><p>日志等级及说明来自于<a href="https://github.com/Seldaek/monolog" target="_blank">Monolog</a> </p>

<p>除了上面之外,还有notice和emergency级别,因不推荐使用,且为避免混淆,不一一详细说明.</p>

<h3>方法</h3>

<h4>logger($level, $message)</h4>

<p>记录一条日志</p>

<h4>logger-&gt;debug($message)</h4>

<p>记录一条DEBUG等级的日志</p>

<h4>logger-&gt;info($message)</h4>

<p>记录一条info等级的日志</p>

<h4>logger-&gt;warning($message)</h4>

<p>记录一条warning等级的日志</p>

<h4>logger-&gt;error($message)</h4>

<p>记录一条error等级的日志</p>

<h4>logger-&gt;critical($message)</h4>

<p>记录一条critical等级的日志</p>

<h4>logger-&gt;alert($message)</h4>

<p>记录一条alert等级的日志</p>

<h4>logger-&gt;getFile()</h4>

<p>获取日志文件</p>

<h4>logger-&gt;setLevel()</h4>

<p>设置默认的日志级别</p>
  </section>

<!-- api/password
  ================================================== -->
  <section id="password">
  <div class="page-header"><h1>Password</h1></div>

<p>安全简单的密码加密,校验服务</p>

<p>基于<a href="https://github.com/ircmaxell/password_compat" target="_blank">ircmaxell/password_compat</a></p>

<h2>案例</h2>

<h3>保存注册用户的密码</h3>

<div class="highlight"><pre><code class="php"><span class="c1">// 获取表单提交的密码字符串</span>
<span class="nv">$password</span> <span class="o">=</span> <span class="nx">wei</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">request</span><span class="p">(</span><span class="s1">'password'</span><span class="p">);</span>

<span class="c1">// 生成在加密(散列)密码用的盐(干扰字符串)</span>
<span class="nv">$salt</span> <span class="o">=</span> <span class="nx">wei</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">password</span><span class="o">-&gt;</span><span class="na">generateSalt</span><span class="p">();</span>

<span class="c1">// 通过密码和盐加密密码</span>
<span class="nv">$password</span> <span class="o">=</span> <span class="nx">wei</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">password</span><span class="o">-&gt;</span><span class="na">hash</span><span class="p">(</span><span class="nv">$password</span><span class="p">,</span> <span class="nv">$salt</span><span class="p">);</span>

<span class="c1">// 构造用户信息数组,注意保存盐供后续使用</span>
<span class="nv">$user</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">'username'</span> <span class="o">=&gt;</span> <span class="s1">'xxx'</span><span class="p">,</span>
    <span class="s1">'salt'</span> <span class="o">=&gt;</span> <span class="nv">$salt</span><span class="p">,</span>
    <span class="s1">'password'</span> <span class="o">=&gt;</span> <span class="nv">$password</span><span class="p">,</span>
<span class="p">);</span>

<span class="c1">// 保存到数据库</span>
<span class="nx">wei</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">db</span><span class="o">-&gt;</span><span class="na">insert</span><span class="p">(</span><span class="s1">'user'</span><span class="p">,</span> <span class="nv">$user</span><span class="p">);</span>
</code></pre></div>

<h3>加密字符串</h3>

<p>如果盐为空将自动生成</p>

<div class="highlight"><pre><code class="php"><span class="nv">$password</span> <span class="o">=</span> <span class="nx">wei</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">password</span><span class="o">-&gt;</span><span class="na">hash</span><span class="p">(</span><span class="s1">'12@Wer@34'</span><span class="p">);</span>

<span class="c1">// 输出结果为60字节的字符串,类似如下</span>
<span class="s1">'$2y$10$fY5aEqo6uzXme2.6jIfFnei.J95RVOwZBKR3ueAkBIVCgpP2XbAga'</span>
</code></pre></div>

<h3>校验密码是否正确</h3>

<div class="highlight"><pre><code class="php"><span class="c1">// 密码,一般从前台表单中获取</span>
<span class="nv">$password</span> <span class="o">=</span> <span class="s1">'12@Wer@34'</span><span class="p">;</span>
<span class="c1">// 加密过的密码,一般从数据库中取出来</span>
<span class="nv">$hash</span> <span class="o">=</span> <span class="s1">'$2y$10$fY5aEqo6uzXme2.6jIfFnei.J95RVOwZBKR3ueAkBIVCgpP2XbAga'</span><span class="p">;</span>

<span class="k">if</span> <span class="p">(</span><span class="nx">wei</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">password</span><span class="o">-&gt;</span><span class="na">verify</span><span class="p">(</span><span class="nv">$password</span><span class="p">,</span> <span class="nv">$hash</span><span class="p">))</span> <span class="p">{</span>
    <span class="c1">// 通过session设置用户登录态</span>
    <span class="nx">wei</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">session</span><span class="p">[</span><span class="s1">'user'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'xxx'</span><span class="p">;</span>
    <span class="k">echo</span> <span class="s1">'密码正确'</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'密码错误'</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<h2>调用方式</h2>

<h3>选项</h3>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody><tr>
<td>cost</td>
<td>int</td>
<td>10</td>
<td>加密算法递归的层数,应该在4~32之间</td>
</tr></tbody>
</table><h3>方法</h3>

<h4>password-&gt;hash($password, $salt = null)</h4>

<p>加密密码</p>

<p>返回: <code>string</code> 60个字符长度的字符串</p>

<h4>password-&gt;verify($password, $hash)</h4>

<p>检查密码是否正确</p>

<p>返回: <code>boolean</code></p>

<h4>password-&gt;generateSalt()</h4>

<p>生成适合密码加密的盐(干扰字符串)</p>

<p>返回: <code>string</code> 22个字符长度的字符串</p>

<h4>password-&gt;getInfo($hash)</h4>

<p>获取加密密码的加密信息</p>

<p>返回: <code>array</code></p>

<h2>相关链接</h2>

<ul>
<li>PHP密码加密相关函数 <a href="http://php.net/password" target="_blank">http://php.net/password</a>
</li>
<li>兼容PHP5.5以下的密码加密函数 <a href="https://github.com/ircmaxell/password_compat" target="_blank">https://github.com/ircmaxell/password_compat</a>
</li>
</ul>
  </section>

<!-- api/pinyin
  ================================================== -->
  <section id="pinyin">
  <div class="page-header"><h1>Pinyin</h1></div>

<p>将中文转换为拼音字母</p>

<h2>案例</h2>

<h3>转换"微框架"为拼音字母</h3>

<div class="highlight"><pre><code class="php"><span class="c1">// 输出`PHPweikuangjia`</span>
<span class="k">echo</span> <span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">pinyin</span><span class="p">(</span><span class="s1">'PHP微框架'</span><span class="p">);</span>
</code></pre></div>

<h2>调用方式</h2>

<h3>选项</h3>

<p><em>无</em></p>

<h3>方法</h3>

<h4>pinyin($word)</h4>

<p>将中文转换为拼音字母</p>

<p><strong>返回:</strong> <code>string</code> 拼音字母</p>

<p><strong>参数</strong></p>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>说明</th>
</tr></thead>
<tbody><tr>
<td>$word</td>
<td>string</td>
<td>要转换的中文字符</td>
</tr></tbody>
</table>
  </section>

<!-- api/uuid
  ================================================== -->
  <section id="uuid">
  <div class="page-header"><h1>Uuid</h1></div>

<p>生成一个随机的UUID</p>

<h2>案例</h2>

<h3>随机生成一个UUID</h3>

<div class="highlight"><pre><code class="php"><span class="c1">// 输出格式类似"05b59eca-866d-410b-96d7-e4f2c286f5a8"</span>
<span class="k">echo</span> <span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">uuid</span><span class="p">();</span>
</code></pre></div>

<h2>调用方式</h2>

<h3>选项</h3>

<p><em>无</em></p>

<h3>方法</h3>

<h4>uuid()</h4>

<p>生成一个随机的UUID</p>

<p>生成的UUID可用于数据表主键,相比通过SQL语句<code>SELECT UUID</code>生成的UUID要快很多,而且调用更加方便.</p>
  </section>

<!-- api/monolog
  ================================================== -->
  <section id="monolog">
  <div class="page-header"><h1>Monolog</h1></div>

<p>获取Monolog对象或记录一条日志</p>

<h2>案例</h2>

<h3>记录一条DEBUG级别的日志</h3>

<div class="highlight"><pre><code class="php"><span class="nx">widget</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">monolog</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">debug</span><span class="p">(</span><span class="s1">'The logger is called'</span><span class="p">);</span>
</code></pre></div>

<h2>调用方式</h2>

<h3>选项</h3>

<table class="table table-bordered table-striped">
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead>
<tbody><tr>
<td>handlers</td>
<td>array</td>
<td>见下面</td>
<td>Monolog的日志处理器</td>
</tr></tbody>
</table><p>handlers的默认值是</p>

<div class="highlight"><pre><code class="php"><span class="nv">$handlers</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
    <span class="c1">// 键名表示处理器类的名称</span>
    <span class="c1">// 如`stream`表示`Monolog\Handler\StreamHandler`,`chromePHP`表示`Monolog\Handler\ChromePHPHandler`</span>
    <span class="s1">'stream'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="c1">// 数组的值表示处理器类的初始化参数</span>
        <span class="s1">'stream'</span> <span class="o">=&gt;</span> <span class="s1">'log/widget.log'</span><span class="p">,</span> <span class="c1">// 日志所在的文件</span>
        <span class="s1">'level'</span> <span class="o">=&gt;</span> <span class="nx">MonologLogger</span><span class="o">::</span><span class="na">DEBUG</span><span class="p">,</span> <span class="c1">// 最低记录的等级</span>
    <span class="p">)</span>
<span class="p">);</span>
</code></pre></div>

<p>您可以查看monolog的项目主页,了解更多处理器和配置</p>

<p><a href="https://github.com/Seldaek/monolog" target="_blank">https://github.com/Seldaek/monolog</a></p>

<h3>方法</h3>

<h4>monolog()</h4>

<p>获取Monolog对象</p>

<h4>monolog($level, $message)</h4>

<p>记录一条日志</p>
  </section>

<!-- api/phpError
  ================================================== -->
  <section id="phpError">
  <div class="page-header"><h1>PHP Error</h1></div>

<p><a href="http://phperror.net/" target="_blank">PHP Error</a>提供了更友好的错误提示信息,完整的语法和代码片段高亮,同时支持Ajax错误提示</p>

<h2>案例</h2>

<h3>在Widget初始化时加载PHP Error</h3>

<div class="highlight"><pre><code class="php"><span class="nx">widget</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
    <span class="s1">'widget'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">'preload'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
            <span class="s1">'phpError'</span> <span class="c1">// 在预加载选项增加phpError对象</span>
        <span class="p">)</span>
    <span class="p">),</span>
    <span class="c1">// 配置phpError对象的选项</span>
    <span class="s1">'phpError'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">'catch_ajax_errors'</span> <span class="o">=&gt;</span> <span class="k">true</span><span class="p">,</span>
        <span class="s1">'catch_class_not_found'</span> <span class="o">=&gt;</span> <span class="k">true</span><span class="p">,</span>
        <span class="c1">// more options</span>
    <span class="p">)</span>
<span class="p">));</span>
</code></pre></div>

<h2>调用方式</h2>

<h3>选项</h3>

<p>参见PHP Error官网文档<a href="https://github.com/JosephLenton/PHP-Error/wiki/Options" target="_blank">https://github.com/JosephLenton/PHP-Error/wiki/Options</a></p>

<h3>方法</h3>

<h4>phpError()</h4>

<p>获取\php_error\ErrorHandler对象</p>
  </section>

</div><!-- /.container -->

<a href="#welcome" class="bs-docs-top">
  Back to top
</a>


    <!-- Main docs footer (social buttons, copyright, etc). -->
    <!-- Footer
================================================== -->
<footer class="bs-docs-footer">
  <div class="bs-docs-container">

    <div class="bs-docs-social">
      <ul class="bs-docs-social-buttons">
        <li>
          <iframe src="http://ghbtns.com/github-btn.html?user=twinh&repo=widget&type=watch"
            allowtransparency="true" frameborder="0" scrolling="0" width="53" height="20"></iframe>
        <li>
          <iframe src="http://ghbtns.com/github-btn.html?user=twinh&type=follow"
            allowtransparency="true" frameborder="0" scrolling="0" width="132" height="20"></iframe>
        </li>
      </ul>
    </div>

    <p>页面主题来自<a href="https://github.com/twitter/bootstrap">Bootstrap 3.0</a>,感谢Bootstrap 3.0!</p>
    <p>Code licensed under <a href="http://opensource.org/licenses/mit-license.php" target="_blank">MIT License</a>, documentation under <a href="http://creativecommons.org/licenses/by/3.0/">CC BY 3.0</a>.</p>
    <ul class="footer-links">
      <li><a href="https://github.com/twinh/widget/issues?state=open">Issues</a></li>
      <li class="muted">&middot;</li>
      <li><a href="https://github.com/twinh/widget/">Github</a></li>
    </ul>
  </div>
</footer>

    <!-- JS and analytics only. -->
    <!-- Bootstrap core JavaScript
================================================== -->
<!-- Placed at the end of the document so the pages load faster -->
<script src="./assets/js/jquery.js"></script>
<script src="./assets/js/bootstrap-scrollspy.js"></script>
<script src="./assets/js/bootstrap-affix.js"></script>
<script src="./assets/js/application.js"></script>

<!-- Analytics
================================================== -->
<script type="text/javascript" src="http://tajs.qq.com/stats?sId=25746247" charset="UTF-8"></script>
  </body>
</html>